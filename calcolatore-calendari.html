<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generatore Calendari Corsi 2026 - SONODIGITALE</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f9fafb;
            color: #111827;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        .header {
            background: linear-gradient(to right, #111827, #1f2937);
            color: white;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 1.875rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.75rem;
        }

        .header-logo {
            height: 60px;
            width: auto;
            margin-left: 12px;
        }

        @media (max-width: 768px) {
            .header-logo {
                height: 45px;
            }
        }

        .header p {
            color: #d1d5db;
            margin-top: 0.5rem;
        }

        .section {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .grid {
            display: grid;
            gap: 1rem;
        }

        .grid-cols-3 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .grid-cols-4 {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }

        .template-card {
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .template-card:hover {
            border-color: #fdba74;
        }

        .template-card.active {
            border-color: #FC7E15;
            background-color: #fff7ed;
        }

        .template-card .title {
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .template-card .subtitle {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
            color: #374151;
        }

        .form-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }

        .form-input:focus {
            outline: none;
            border-color: #FC7E15;
            box-shadow: 0 0 0 3px rgba(252, 126, 21, 0.1);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: opacity 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-primary {
            background-color: #FC7E15;
            color: white;
        }

        .btn-success {
            background-color: #10b981;
            color: white;
            width: 100%;
        }

        .btn-add {
            background-color: #3b82f6;
            color: white;
        }

        .btn-remove {
            background-color: #dc2626;
            color: white;
            padding: 0.5rem;
        }

        .lezione-item {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            padding: 0.75rem;
            background-color: #f9fafb;
            border-radius: 0.375rem;
            margin-bottom: 0.5rem;
        }

        .lezione-giorno {
            width: 80px;
            font-size: 0.875rem;
            font-weight: 500;
            color: #6b7280;
            padding-top: 0.5rem;
            flex-shrink: 0;
        }

        .lezione-modulo {
            width: 160px;
            flex-shrink: 0;
        }

        .lezione-argomenti {
            flex: 1;
            min-width: 200px;
        }

        .programma-container {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .programma-container::-webkit-scrollbar {
            width: 8px;
        }

        .programma-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .programma-container::-webkit-scrollbar-thumb {
            background: #FC7E15;
            border-radius: 4px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            padding: 1rem;
            border-radius: 0.5rem;
        }

        .stat-card.gray {
            background-color: #f9fafb;
        }

        .stat-card.orange {
            background-color: #FC7E15;
            color: white;
        }

        .stat-label {
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }

        .stat-card.gray .stat-label {
            color: #6b7280;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .calendario-card {
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: border-color 0.2s;
        }

        .calendario-card:hover {
            border-color: #fdba74;
        }

        .calendario-title {
            font-size: 1.125rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .calendario-date {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.75rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        th {
            background-color: #f3f4f6;
            padding: 0.5rem;
            text-align: left;
            border: 1px solid #e5e7eb;
            font-weight: 600;
        }

        td {
            padding: 0.5rem;
            border: 1px solid #e5e7eb;
        }

        tr:hover {
            background-color: #f9fafb;
        }

        .table-container {
            overflow-x: auto;
        }

        .text-muted {
            color: #6b7280;
            text-align: center;
            padding: 1rem;
            background-color: #f9fafb;
        }

        .icon {
            width: 1.25rem;
            height: 1.25rem;
            color: #FC7E15;
        }

        .icon-lg {
            width: 2rem;
            height: 2rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .result-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #FC7E15;
            margin-bottom: 1rem;
        }

        .info-text {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .alert-info {
            background-color: #dbeafe;
            color: #1e40af;
            border-left: 4px solid #3b82f6;
        }

        .alert-warning {
            background-color: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
        }

        .alert-success {
            background-color: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }

        .esclusione-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background-color: #fef2f2;
            border-radius: 0.375rem;
            margin-bottom: 0.5rem;
            border-left: 3px solid #dc2626;
        }

        .esclusione-text {
            font-size: 0.875rem;
            color: #374151;
        }

        .esclusione-date {
            font-weight: 600;
            color: #111827;
        }

        .festivity-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background-color: #fef3c7;
            color: #92400e;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            margin-right: 0.5rem;
            margin-bottom: 0.25rem;
        }

        .festivity-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .btn-expand {
            background-color: #f3f4f6;
            color: #374151;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            margin-top: 1rem;
            width: 100%;
        }

        .btn-expand:hover {
            background-color: #e5e7eb;
        }

        .exclusion-form {
            display: grid;
            grid-template-columns: auto auto auto 1fr;
            gap: 0.5rem;
            align-items: end;
            margin-bottom: 1rem;
        }

        .radio-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .distribuzione-section {
            background-color: #fff7ed;
            border: 2px solid #FC7E15;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
        }

        .distribuzione-title {
            font-weight: bold;
            color: #FC7E15;
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }

        .opzione-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 0.375rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .opzione-card:hover {
            border-color: #FC7E15;
        }

        .opzione-card.selected {
            border-color: #FC7E15;
            background-color: #fff7ed;
        }

        .opzione-descrizione {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .opzione-dettaglio {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .personalizzata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.75rem;
        }

        .ore-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .ore-input-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: #6b7280;
        }

        .ore-input {
            text-align: center;
        }

        .ore-calcolo {
            font-size: 0.75rem;
            color: #6b7280;
            text-align: center;
        }

        .totale-ore {
            margin-top: 0.75rem;
            padding: 0.75rem;
            border-radius: 0.375rem;
            font-weight: 600;
            text-align: center;
        }

        .totale-ore.valido {
            background-color: #d1fae5;
            color: #065f46;
        }

        .totale-ore.non-valido {
            background-color: #fee2e2;
            color: #991b1b;
        }

        @media (max-width: 768px) {
            .lezione-item {
                flex-direction: column;
            }
            
            .lezione-giorno,
            .lezione-modulo,
            .lezione-argomenti {
                width: 100%;
            }

            .exclusion-form {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const CalendarioCorsiApp = () => {
            const [templateSelezionato, setTemplateSelezionato] = useState('');
            const [parametri, setParametri] = useState({
                nomeCorso: '',
                oreTotali: 100,
                oreGiorno: 5,
                orarioInizio: '09:00',
                orarioFine: '14:00',
                giorni: [1, 2, 3, 4, 5],
                numeroDocenti: 2,
                dataInizio: '',
                dataFine: '',
            });
            
            const [programma, setProgramma] = useState([]);
            const [risultati, setRisultati] = useState(null);
            const [calendari, setCalendari] = useState([]);
            const [esclusioni, setEsclusioni] = useState([]);
            const [calendariEspansi, setCalendariEspansi] = useState([]);
            const [nomiDocenti, setNomiDocenti] = useState([]);
            const [distribuzioneOre, setDistribuzioneOre] = useState({
                modalita: 'automatica', // 'automatica' o 'personalizzata'
                opzioneScelta: null, // indice opzione automatica scelta
                personalizzata: {
                    ore7: 0,
                    ore6: 0,
                    ore5: 0,
                    ore4: 0,
                    ore3: 0
                }
            });
            const [tipoEsclusione, setTipoEsclusione] = useState('singola'); // 'singola' o 'periodo'
            const [dataEsclusione, setDataEsclusione] = useState('');
            const [dataInizioPeriodo, setDataInizioPeriodo] = useState('');
            const [dataFinePeriodo, setDataFinePeriodo] = useState('');
            const [motivoEsclusione, setMotivoEsclusione] = useState('');

            // Festivit√† italiane 2026
            const festivitaItaliane2026 = [
                { data: '2026-01-01', nome: 'Capodanno' },
                { data: '2026-01-06', nome: 'Epifania' },
                { data: '2026-04-05', nome: 'Pasqua' },
                { data: '2026-04-06', nome: 'Luned√¨ dell\'Angelo' },
                { data: '2026-04-25', nome: 'Festa della Liberazione' },
                { data: '2026-05-01', nome: 'Festa dei Lavoratori' },
                { data: '2026-06-02', nome: 'Festa della Repubblica' },
                { data: '2026-08-15', nome: 'Ferragosto' },
                { data: '2026-11-01', nome: 'Ognissanti' },
                { data: '2026-12-08', nome: 'Immacolata Concezione' },
                { data: '2026-12-25', nome: 'Natale' },
                { data: '2026-12-26', nome: 'Santo Stefano' },
            ];

            const templates = {
                ai100: {
                    nome: 'AI Start - 100 ore',
                    oreTotali: 100,
                    oreGiorno: 5,
                    orarioInizio: '09:00',
                    orarioFine: '14:00',
                    programma: [
                        { giorno: 1, modulo: 'Modulo 1', argomenti: "Cos'√® l'IA (storia, definizioni, ambiti). Tipologie di AI (Narrow, General, Generative)." },
                        { giorno: 2, modulo: 'Modulo 1', argomenti: 'Prompt Engineering (principi base). Panoramica strumenti AI (ChatGPT, Gemini, Copilot).' },
                        { giorno: 3, modulo: 'Modulo 1', argomenti: 'Aggiornamenti Google (Gemini, NotebookLM). Dashboard e personalizzazione account.' },
                        { giorno: 4, modulo: 'Modulo 1', argomenti: 'Deep Research e nuovi motori (Perplexity). Esercitazioni pratiche di base.' },
                        { giorno: 5, modulo: 'Modulo 1', argomenti: 'AI per produttivit√† personale: gestione tempo, to-do list, organizzazione attivit√†.' },
                        { giorno: 6, modulo: 'Moduli 1 e 2', argomenti: 'AI per produttivit√† (continuazione). Creazione CV con AI. Lettere di presentazione.' },
                        { giorno: 7, modulo: 'Modulo 2', argomenti: 'Preparazione colloqui (simulazioni). Strumenti AI per grafica (Canva AI).' },
                        { giorno: 8, modulo: 'Modulo 2', argomenti: 'Contenuti per LinkedIn. Piano base di personal branding. AI nel marketing digitale.' },
                        { giorno: 9, modulo: 'Modulo 2', argomenti: 'Piano editoriale con AI. Generazione contenuti: post e reel per social media.' },
                        { giorno: 10, modulo: 'Modulo 2', argomenti: 'Generazione testi persuasivi. Copywriting con AI per marketing.' },
                        { giorno: 11, modulo: 'Modulo 3', argomenti: 'AI per immagini e video: modelli principali. Canva Magic Design.' },
                        { giorno: 12, modulo: 'Modulo 3', argomenti: 'Esercitazioni pratiche: piani editoriali per Instagram e LinkedIn.' },
                        { giorno: 13, modulo: 'Modulo 3', argomenti: 'Automazioni semplificate: concetti base, vantaggi ed esempi pratici.' },
                        { giorno: 14, modulo: 'Modulo 3', argomenti: 'CRM introduttivo con Excel e Google Sheets. Gestione contatti con AI.' },
                        { giorno: 15, modulo: 'Modulo 3', argomenti: 'Ricerca avanzata con AI su web e LinkedIn. Esercitazioni finali Modulo 3.' },
                        { giorno: 16, modulo: 'Modulo 4', argomenti: 'Avvio project work individuale o di gruppo. Pianificazione attivit√†.' },
                        { giorno: 17, modulo: 'Modulo 4', argomenti: 'Project work: sviluppo e supporto individuale.' },
                        { giorno: 18, modulo: 'Modulo 4', argomenti: 'Presentazione project work (parte 1). Feedback e correzioni.' },
                        { giorno: 19, modulo: 'Modulo 4', argomenti: 'Presentazione project work (parte 2). Personal Branding avanzato su LinkedIn.' },
                        { giorno: 20, modulo: 'Modulo 4', argomenti: 'Come presentare competenze in CV e colloqui. Q&A finale e completamento ore.' },
                    ]
                },
                social50: {
                    nome: 'Social Media Manager con AI - 50 ore',
                    oreTotali: 50,
                    oreGiorno: 4,
                    orarioInizio: '09:00',
                    orarioFine: '13:00',
                    programma: [
                        { giorno: 1, modulo: 'Settimana 1', argomenti: 'Introduzione Marketing e Logiche Digitali' },
                        { giorno: 2, modulo: 'Settimana 1', argomenti: 'Brand, Personal Brand e LinkedIn' },
                        { giorno: 3, modulo: 'Settimana 1', argomenti: 'AI Generativa per Social Media - Parte 1' },
                        { giorno: 4, modulo: 'Settimana 1', argomenti: 'AI per Immagini e Panoramica Ecosistema Social' },
                        { giorno: 5, modulo: 'Settimana 2', argomenti: 'Content Creation Visual con Canva' },
                        { giorno: 6, modulo: 'Settimana 2', argomenti: 'Video Editing Base e Reel con Canva' },
                        { giorno: 7, modulo: 'Settimana 2', argomenti: 'Copywriting e Caption con AI' },
                        { giorno: 8, modulo: 'Settimana 2', argomenti: 'Instagram Marketing Operativo' },
                        { giorno: 9, modulo: 'Settimana 2', argomenti: 'LinkedIn Marketing e B2B' },
                        { giorno: 10, modulo: 'Settimana 3', argomenti: 'Strategia Editoriale e Planning' },
                        { giorno: 11, modulo: 'Settimana 3', argomenti: 'Analytics e Ottimizzazione' },
                        { giorno: 12, modulo: 'Settimana 3', argomenti: 'Facebook, TikTok, YouTube (Panoramica)' },
                        { giorno: 13, modulo: 'Settimana 3', argomenti: 'Project Work Finale e Portfolio' },
                    ]
                }
            };

            const caricaTemplate = (key) => {
                const template = templates[key];
                setTemplateSelezionato(key);
                setParametri({
                    ...parametri,
                    nomeCorso: template.nome,
                    oreTotali: template.oreTotali,
                    oreGiorno: template.oreGiorno,
                    orarioInizio: template.orarioInizio,
                    orarioFine: template.orarioFine,
                });
                setProgramma([...template.programma]);
            };

            // üéØ NUOVA LOGICA: Genera automaticamente le lezioni quando la distribuzione √® definita
            useEffect(() => {
                // Solo per corso personalizzato
                if (templateSelezionato !== 'custom') return;
                
                // Solo se ci sono ore totali e ore giorno valide
                if (parametri.oreTotali === 0 || parametri.oreGiorno === 0) return;

                // ‚ö†Ô∏è VINCOLO: Ore giorno deve essere tra 3 e 7
                if (parametri.oreGiorno < 3 || parametri.oreGiorno > 7) {
                    setProgramma([]);
                    return;
                }

                const opzioni = calcolaOpzioniDistribuzione();
                
                // CASO 1: Distribuzione perfetta (nessun resto)
                if (opzioni.length === 0) {
                    const numGiorni = Math.floor(parametri.oreTotali / parametri.oreGiorno);
                    generaLezioniVuote(numGiorni);
                    return;
                }

                // CASO 2: C'√® resto, ma nessuna distribuzione scelta ancora
                if (distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta === null) {
                    // Non generare ancora le lezioni
                    setProgramma([]);
                    return;
                }

                // CASO 3: Distribuzione automatica scelta
                if (distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta !== null) {
                    const arrayOre = getArrayOreGiornate();
                    // Verifica che tutte le ore rispettino i vincoli
                    const oreNonValide = arrayOre.find(ore => ore < 3 || ore > 7);
                    if (oreNonValide) {
                        setProgramma([]);
                        return;
                    }
                    generaLezioniVuote(arrayOre.length);
                    return;
                }

                // CASO 4: Distribuzione personalizzata
                if (distribuzioneOre.modalita === 'personalizzata') {
                    const totalePersonalizzato = getOrePersonalizzateTotali();
                    // Genera lezioni solo se la distribuzione √® valida
                    if (totalePersonalizzato === parametri.oreTotali && isDistribuzionePersonalizzataValida()) {
                        const arrayOre = getArrayOreGiornate();
                        // Verifica che tutte le ore rispettino i vincoli
                        const oreNonValide = arrayOre.find(ore => ore < 3 || ore > 7);
                        if (oreNonValide) {
                            setProgramma([]);
                            return;
                        }
                        generaLezioniVuote(arrayOre.length);
                    } else {
                        // Distribuzione non valida, non generare lezioni
                        setProgramma([]);
                    }
                }
            }, [templateSelezionato, parametri.oreTotali, parametri.oreGiorno, distribuzioneOre]);

            const generaLezioniVuote = (numLezioni) => {
                // Non rigenerare se il numero √® lo stesso
                if (programma.length === numLezioni) return;
                
                const nuoveProgramma = [];
                for (let i = 0; i < numLezioni; i++) {
                    nuoveProgramma.push({
                        giorno: i + 1,
                        modulo: '',
                        argomenti: ''
                    });
                }
                setProgramma(nuoveProgramma);
            };

            const aggiungiLezione = () => {
                setProgramma([...programma, { giorno: programma.length + 1, modulo: '', argomenti: '' }]);
            };

            const rimuoviLezione = (index) => {
                const nuovoProgramma = programma.filter((_, i) => i !== index);
                nuovoProgramma.forEach((item, i) => item.giorno = i + 1);
                setProgramma(nuovoProgramma);
            };

            const aggiornaLezione = (index, campo, valore) => {
                const nuovoProgramma = [...programma];
                nuovoProgramma[index][campo] = valore;
                setProgramma(nuovoProgramma);
            };

            const aggiungiEsclusione = () => {
                if (tipoEsclusione === 'singola') {
                    if (!dataEsclusione) {
                        alert('Inserisci una data');
                        return;
                    }
                    setEsclusioni([...esclusioni, {
                        tipo: 'singola',
                        data: dataEsclusione,
                        motivo: motivoEsclusione || 'Chiusura',
                        id: Date.now()
                    }]);
                    setDataEsclusione('');
                } else {
                    if (!dataInizioPeriodo || !dataFinePeriodo) {
                        alert('Inserisci entrambe le date del periodo');
                        return;
                    }
                    if (new Date(dataInizioPeriodo) > new Date(dataFinePeriodo)) {
                        alert('La data di inizio deve essere precedente alla data di fine');
                        return;
                    }
                    setEsclusioni([...esclusioni, {
                        tipo: 'periodo',
                        dataInizio: dataInizioPeriodo,
                        dataFine: dataFinePeriodo,
                        motivo: motivoEsclusione || 'Chiusura',
                        id: Date.now()
                    }]);
                    setDataInizioPeriodo('');
                    setDataFinePeriodo('');
                }
                setMotivoEsclusione('');
            };

            const rimuoviEsclusione = (id) => {
                setEsclusioni(esclusioni.filter(e => e.id !== id));
            };

            const isDataEsclusa = (data) => {
                const dataStr = data.toISOString().split('T')[0];
                
                // Controlla festivit√†
                if (festivitaItaliane2026.some(f => f.data === dataStr)) {
                    return true;
                }
                
                // Controlla esclusioni personalizzate
                for (const escl of esclusioni) {
                    if (escl.tipo === 'singola' && escl.data === dataStr) {
                        return true;
                    }
                    if (escl.tipo === 'periodo') {
                        const dataCheck = new Date(dataStr);
                        const inizio = new Date(escl.dataInizio);
                        const fine = new Date(escl.dataFine);
                        if (dataCheck >= inizio && dataCheck <= fine) {
                            return true;
                        }
                    }
                }
                
                return false;
            };

            const calcolaGiorniLavorativi = (dataInizio, dataFine, giorni) => {
                let count = 0;
                let current = new Date(dataInizio);
                const fine = new Date(dataFine);
                
                while (current <= fine) {
                    const dayOfWeek = current.getDay();
                    const dayNum = dayOfWeek === 0 ? 7 : dayOfWeek;
                    
                    if (giorni.includes(dayNum) && !isDataEsclusa(current)) {
                        count++;
                    }
                    current.setDate(current.getDate() + 1);
                }
                return count;
            };

            const getFestivitaNelPeriodo = () => {
                if (!parametri.dataInizio || !parametri.dataFine) return [];
                
                const inizio = new Date(parametri.dataInizio);
                const fine = new Date(parametri.dataFine);
                
                return festivitaItaliane2026.filter(f => {
                    const dataFest = new Date(f.data);
                    return dataFest >= inizio && dataFest <= fine;
                });
            };

            const calcolaCorsi = () => {
                if (!parametri.dataInizio || !parametri.dataFine) {
                    alert('Inserisci le date di inizio e fine periodo');
                    return;
                }

                if (programma.length === 0) {
                    alert('Aggiungi almeno una lezione al programma');
                    return;
                }

                // Validazione ore giorno
                if (parametri.oreGiorno < 3 || parametri.oreGiorno > 7) {
                    alert('‚ö†Ô∏è VINCOLO: Le lezioni devono essere tra 3h e 7h. Correggi "Ore al Giorno".');
                    return;
                }

                // Validazione distribuzione ore personalizzata
                const opzioni = calcolaOpzioniDistribuzione();
                if (opzioni.length > 0 && distribuzioneOre.modalita === 'personalizzata') {
                    const totalePersonalizzato = getOrePersonalizzateTotali();
                    if (totalePersonalizzato !== parametri.oreTotali) {
                        alert(`Attenzione: la distribuzione personalizzata ha ${totalePersonalizzato} ore, ma il corso richiede ${parametri.oreTotali} ore. Correggi la distribuzione.`);
                        return;
                    }
                    
                    // Verifica che non ci siano giorni con ore fuori vincoli (gi√† garantito da interfaccia)
                    if (!isDistribuzionePersonalizzataValida()) {
                        alert('‚ö†Ô∏è VINCOLO: Tutte le lezioni devono essere tra 3h e 7h.');
                        return;
                    }
                }

                // Validazione che l'array ore rispetti i vincoli
                const arrayOre = getArrayOreGiornate();
                const oreNonValide = arrayOre.find(ore => ore < 3 || ore > 7);
                if (oreNonValide) {
                    alert(`‚ö†Ô∏è VINCOLO: Trovata lezione da ${oreNonValide}h. Tutte le lezioni devono essere tra 3h e 7h. Controlla la distribuzione.`);
                    return;
                }

                const giorniNecessari = arrayOre.length;
                const giorniDisponibili = calcolaGiorniLavorativi(parametri.dataInizio, parametri.dataFine, parametri.giorni);
                const corsiPerDocente = Math.floor(giorniDisponibili / giorniNecessari);
                const corsiTotali = corsiPerDocente * parametri.numeroDocenti;

                setRisultati({
                    giorniNecessari,
                    giorniDisponibili,
                    corsiPerDocente,
                    corsiTotali,
                    festivita: getFestivitaNelPeriodo().length,
                    esclusioni: esclusioni.length
                });

                generaCalendari(corsiTotali, giorniNecessari);
            };

            const generaCalendari = (numCorsi, giorniNecessari) => {
                const calendariGenerati = [];
                const arrayOreGiornate = getArrayOreGiornate();
                
                for (let docente = 1; docente <= parametri.numeroDocenti; docente++) {
                    let dataDocenteInizio = new Date(parametri.dataInizio);
                    
                    for (let corso = 1; corso <= Math.floor(numCorsi / parametri.numeroDocenti); corso++) {
                        const lezioni = [];
                        let dataLezione = new Date(dataDocenteInizio);
                        let giorniContati = 0;

                        while (giorniContati < giorniNecessari && giorniContati < programma.length) {
                            const dayOfWeek = dataLezione.getDay();
                            const dayNum = dayOfWeek === 0 ? 7 : dayOfWeek;
                            
                            if (parametri.giorni.includes(dayNum) && !isDataEsclusa(dataLezione)) {
                                const prog = programma[giorniContati];
                                const oreGiornata = arrayOreGiornate[giorniContati] || parametri.oreGiorno;
                                
                                // üïê GESTIONE ORARI con pausa pranzo per giornate da 7h
                                let orario;
                                if (oreGiornata === 7) {
                                    // 7h = 4h mattina + 1h pausa + 3h pomeriggio
                                    // 9:00-13:00 (4h) ‚Üí PAUSA ‚Üí 14:00-17:00 (3h)
                                    orario = "09:00-13:00 / 14:00-17:00";
                                } else {
                                    // Calcola orario fine basato su ore giornata (continuo, senza pausa)
                                    const [oreInizio, minutiInizio] = parametri.orarioInizio.split(':').map(Number);
                                    const minutiTotaliInizio = oreInizio * 60 + minutiInizio;
                                    const minutiTotaliFine = minutiTotaliInizio + (oreGiornata * 60);
                                    const oreFine = Math.floor(minutiTotaliFine / 60);
                                    const minutiFine = minutiTotaliFine % 60;
                                    const orarioFine = `${String(oreFine).padStart(2, '0')}:${String(minutiFine).padStart(2, '0')}`;
                                    orario = `${parametri.orarioInizio} - ${orarioFine}`;
                                }
                                
                                lezioni.push({
                                    data: new Date(dataLezione),
                                    giorno: ['Domenica', 'Luned√¨', 'Marted√¨', 'Mercoled√¨', 'Gioved√¨', 'Venerd√¨', 'Sabato'][dataLezione.getDay()],
                                    orario: orario,
                                    ore: oreGiornata,
                                    modulo: prog.modulo,
                                    argomenti: prog.argomenti,
                                });
                                giorniContati++;
                            }
                            dataLezione.setDate(dataLezione.getDate() + 1);
                        }

                        if (lezioni.length === giorniNecessari) {
                            calendariGenerati.push({
                                nome: `CORSO ${corso}${String.fromCharCode(64 + docente)} - ${getNomeDocente(docente)}`,
                                dataInizio: new Date(lezioni[0].data),
                                dataFine: new Date(lezioni[lezioni.length - 1].data),
                                lezioni,
                            });
                        }

                        dataDocenteInizio = new Date(dataLezione);
                    }
                }

                setCalendari(calendariGenerati);
            };

            const esportaExcel = async () => {
                const workbook = new ExcelJS.Workbook();
                
                calendari.forEach((calendario, idx) => {
                    const worksheet = workbook.addWorksheet(calendario.nome.substring(0, 31));
                    
                    // Titolo (riga 1)
                    worksheet.mergeCells('A1:F1');
                    const titleCell = worksheet.getCell('A1');
                    titleCell.value = calendario.nome;
                    titleCell.font = { bold: true, size: 14, color: { argb: 'FFFFFFFF' } };
                    titleCell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFFC7E15' }
                    };
                    titleCell.alignment = { vertical: 'middle', horizontal: 'left' };
                    worksheet.getRow(1).height = 25;
                    
                    // Sottotitolo (riga 2)
                    worksheet.mergeCells('A2:F2');
                    const subtitleCell = worksheet.getCell('A2');
                    subtitleCell.value = `Periodo: ${calendario.dataInizio.toLocaleDateString('it-IT')} - ${parametri.nomeCorso} (${parametri.oreTotali} Ore)`;
                    subtitleCell.font = { size: 11, color: { argb: 'FF374151' } };
                    subtitleCell.alignment = { vertical: 'middle', horizontal: 'left' };
                    worksheet.getRow(2).height = 20;
                    
                    // Riga vuota (riga 3)
                    worksheet.getRow(3).height = 10;
                    
                    // Header (riga 4)
                    const headerRow = worksheet.getRow(4);
                    const headers = ['Data', 'Giorno', 'Orario', 'Ore', 'Modulo', 'Argomenti'];
                    headers.forEach((header, colIdx) => {
                        const cell = headerRow.getCell(colIdx + 1);
                        cell.value = header;
                        cell.font = { bold: true, size: 11, color: { argb: 'FFFFFFFF' } };
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFFC7E15' }
                        };
                        cell.alignment = { vertical: 'middle', horizontal: 'center' };
                        cell.border = {
                            top: { style: 'thin', color: { argb: 'FF000000' } },
                            bottom: { style: 'thin', color: { argb: 'FF000000' } },
                            left: { style: 'thin', color: { argb: 'FF000000' } },
                            right: { style: 'thin', color: { argb: 'FF000000' } }
                        };
                    });
                    headerRow.height = 25;
                    
                    // Righe dati (a partire da riga 5)
                    calendario.lezioni.forEach((lezione, lezioneIdx) => {
                        const rowNum = lezioneIdx + 5;
                        const row = worksheet.getRow(rowNum);
                        const isEven = lezioneIdx % 2 === 0;
                        const bgColor = isEven ? 'FFFFFFFF' : 'FFF9FAFB';
                        
                        const rowData = [
                            lezione.data.toLocaleDateString('it-IT'),
                            lezione.giorno,
                            lezione.orario,
                            lezione.ore,
                            lezione.modulo,
                            lezione.argomenti
                        ];
                        
                        rowData.forEach((value, colIdx) => {
                            const cell = row.getCell(colIdx + 1);
                            cell.value = value;
                            cell.fill = {
                                type: 'pattern',
                                pattern: 'solid',
                                fgColor: { argb: bgColor }
                            };
                            cell.alignment = { 
                                vertical: 'top', 
                                horizontal: colIdx === 3 ? 'center' : 'left',
                                wrapText: colIdx === 5
                            };
                            cell.border = {
                                top: { style: 'thin', color: { argb: 'FFE5E7EB' } },
                                bottom: { style: 'thin', color: { argb: 'FFE5E7EB' } },
                                left: { style: 'thin', color: { argb: 'FFE5E7EB' } },
                                right: { style: 'thin', color: { argb: 'FFE5E7EB' } }
                            };
                        });
                        
                        row.height = 30;
                    });
                    
                    // Riga TOTALE (ultima riga)
                    const totaleRowNum = calendario.lezioni.length + 5;
                    const totaleRow = worksheet.getRow(totaleRowNum);
                    
                    ['', '', 'TOTALE ORE:', parametri.oreTotali, '', ''].forEach((value, colIdx) => {
                        const cell = totaleRow.getCell(colIdx + 1);
                        cell.value = value;
                        cell.font = { bold: true, size: 11 };
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFF3F4F6' }
                        };
                        cell.alignment = { vertical: 'middle', horizontal: colIdx === 2 ? 'right' : (colIdx === 3 ? 'center' : 'left') };
                        cell.border = {
                            top: { style: 'thin', color: { argb: 'FF000000' } },
                            bottom: { style: 'thin', color: { argb: 'FF000000' } },
                            left: { style: 'thin', color: { argb: 'FF000000' } },
                            right: { style: 'thin', color: { argb: 'FF000000' } }
                        };
                    });
                    totaleRow.height = 25;
                    
                    // Dimensioni colonne
                    worksheet.getColumn(1).width = 12;
                    worksheet.getColumn(2).width = 12;
                    worksheet.getColumn(3).width = 15;
                    worksheet.getColumn(4).width = 8;
                    worksheet.getColumn(5).width = 20;
                    worksheet.getColumn(6).width = 60;
                });
                
                const buffer = await workbook.xlsx.writeBuffer();
                const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                const filename = `Calendari_${parametri.nomeCorso.replace(/\s+/g, '_')}_2026.xlsx`;
                saveAs(blob, filename);
            };

            const toggleEspansioneCalendario = (indice) => {
                if (calendariEspansi.includes(indice)) {
                    setCalendariEspansi(calendariEspansi.filter(i => i !== indice));
                } else {
                    setCalendariEspansi([...calendariEspansi, indice]);
                }
            };

            const aggiornaNumeroDocenti = (numero) => {
                setParametri({ ...parametri, numeroDocenti: numero });
                const nuoviNomi = [...nomiDocenti];
                while (nuoviNomi.length < numero) {
                    nuoviNomi.push('');
                }
                setNomiDocenti(nuoviNomi.slice(0, numero));
            };

            const aggiornaNomeDocente = (index, nome) => {
                const nuoviNomi = [...nomiDocenti];
                nuoviNomi[index] = nome;
                setNomiDocenti(nuoviNomi);
            };

            const getNomeDocente = (index) => {
                return nomiDocenti[index - 1] || `Docente ${index}`;
            };

            // Calcola opzioni automatiche per distribuzione ore
            // VINCOLI: MIN 3h, MAX 7h per ogni lezione
            const calcolaOpzioniDistribuzione = () => {
                const totale = parametri.oreTotali;
                const giornata = parametri.oreGiorno;
                
                if (totale === 0 || giornata === 0) return [];
                
                // Verifica che ore giorno rispetti i vincoli
                if (giornata < 3 || giornata > 7) {
                    return []; // Ore giorno non valide
                }
                
                const giorniCompleti = Math.floor(totale / giornata);
                const resto = totale % giornata;
                
                if (resto === 0) {
                    return []; // Distribuzione perfetta, nessuna opzione da mostrare
                }
                
                // ‚ö†Ô∏è VINCOLO: resto < 3h NON √® valido, devo redistribuire
                const opzioni = [];
                
                // Strategia 1: Se resto < 3h, riduco i giorni completi e redistribuisco
                if (resto < 3) {
                    // Es: 50h √∑ 7h = 7 giorni + 1h ‚Üí riduco a 6 giorni da 7h + (1h+7h=8h) da redistribuire
                    const oreRimanenti = resto + giornata;
                    const giorniCompletiFix = giorniCompleti - 1;
                    
                    // Opzione A: 2 giorni da 4h (se possibile)
                    if (oreRimanenti === 8) {
                        opzioni.push({
                            descrizione: `${giorniCompletiFix} giorni da ${giornata}h + 2 giorni da 4h`,
                            dettaglio: `${giorniCompletiFix}√ó${giornata}h + 2√ó4h = ${totale}h`,
                            distribuzione: {
                                [giornata]: giorniCompletiFix,
                                4: 2
                            }
                        });
                    }
                    
                    // Opzione B: Combinazioni con 3h, 4h, 5h, 6h
                    for (let ore1 = 7; ore1 >= 3; ore1--) {
                        for (let ore2 = 7; ore2 >= 3; ore2--) {
                            if (ore1 + ore2 === oreRimanenti && ore1 >= ore2) {
                                const desc = ore1 === ore2 
                                    ? `${giorniCompletiFix} giorni da ${giornata}h + 2 giorni da ${ore1}h`
                                    : `${giorniCompletiFix} giorni da ${giornata}h + 1 giorno da ${ore1}h + 1 giorno da ${ore2}h`;
                                const det = ore1 === ore2
                                    ? `${giorniCompletiFix}√ó${giornata}h + 2√ó${ore1}h = ${totale}h`
                                    : `${giorniCompletiFix}√ó${giornata}h + 1√ó${ore1}h + 1√ó${ore2}h = ${totale}h`;
                                
                                const distribuzione = { [giornata]: giorniCompletiFix };
                                if (ore1 === ore2) {
                                    distribuzione[ore1] = 2;
                                } else {
                                    distribuzione[ore1] = 1;
                                    distribuzione[ore2] = 1;
                                }
                                
                                // Evita duplicati
                                if (!opzioni.some(o => o.descrizione === desc)) {
                                    opzioni.push({ descrizione: desc, dettaglio: det, distribuzione });
                                }
                                
                                if (opzioni.length >= 3) break;
                            }
                        }
                        if (opzioni.length >= 3) break;
                    }
                    
                    // Opzione C: Distribuire su pi√π giorni da 3h
                    const giorniDa3 = Math.ceil(oreRimanenti / 3);
                    if (giorniDa3 >= 2 && giorniDa3 * 3 <= oreRimanenti + 2) {
                        const oreUltimo = oreRimanenti - ((giorniDa3 - 1) * 3);
                        if (oreUltimo >= 3 && oreUltimo <= 7) {
                            opzioni.push({
                                descrizione: `${giorniCompletiFix} giorni da ${giornata}h + ${giorniDa3} giorni da 3h`,
                                dettaglio: `${giorniCompletiFix}√ó${giornata}h + ${giorniDa3}√ó3h = ${totale}h`,
                                distribuzione: {
                                    [giornata]: giorniCompletiFix,
                                    3: giorniDa3
                                }
                            });
                        }
                    }
                    
                } else {
                    // Resto >= 3h, possiamo lavorare con questo
                    
                    // Opzione 1: Distribuire resto su giornate da 4h (se resto >= 4)
                    if (resto >= 4) {
                        const giorniResto4 = Math.floor(resto / 4);
                        const restoFinale = resto % 4;
                        
                        if (restoFinale === 0) {
                            // Perfetto, solo giorni da 4h
                            opzioni.push({
                                descrizione: `${giorniCompleti} giorni da ${giornata}h + ${giorniResto4} giorni da 4h`,
                                dettaglio: `${giorniCompleti}√ó${giornata}h + ${giorniResto4}√ó4h = ${totale}h`,
                                distribuzione: {
                                    [giornata]: giorniCompleti,
                                    4: giorniResto4
                                }
                            });
                        } else if (restoFinale >= 3) {
                            // giorniResto4 giorni da 4h + 1 giorno da restoFinale
                            opzioni.push({
                                descrizione: `${giorniCompleti} giorni da ${giornata}h + ${giorniResto4} giorni da 4h + 1 giorno da ${restoFinale}h`,
                                dettaglio: `${giorniCompleti}√ó${giornata}h + ${giorniResto4}√ó4h + 1√ó${restoFinale}h = ${totale}h`,
                                distribuzione: {
                                    [giornata]: giorniCompleti,
                                    4: giorniResto4,
                                    [restoFinale]: 1
                                }
                            });
                        }
                    }
                    
                    // Opzione 2: Distribuire resto su giornate da 3h
                    const giorniResto3 = Math.ceil(resto / 3);
                    opzioni.push({
                        descrizione: `${giorniCompleti} giorni da ${giornata}h + ${giorniResto3} giorni da 3h`,
                        dettaglio: `${giorniCompleti}√ó${giornata}h + ${giorniResto3}√ó3h = ${totale}h`,
                        distribuzione: {
                            [giornata]: giorniCompleti,
                            3: giorniResto3
                        }
                    });
                    
                    // Opzione 3: Redistribuire riducendo ore giornata
                    if (giornata >= 5) {
                        const giorniMeno = Math.floor(resto / 2);
                        const nuoviCompleti = giorniCompleti - giorniMeno;
                        const nuoveOre = giornata - 2;
                        if (nuoviCompleti > 0 && nuoveOre >= 3) {
                            const giorniNuoveOre = giorniMeno * 2;
                            if (nuoviCompleti * giornata + giorniNuoveOre * nuoveOre === totale) {
                                opzioni.push({
                                    descrizione: `${nuoviCompleti} giorni da ${giornata}h + ${giorniNuoveOre} giorni da ${nuoveOre}h`,
                                    dettaglio: `${nuoviCompleti}√ó${giornata}h + ${giorniNuoveOre}√ó${nuoveOre}h = ${totale}h`,
                                    distribuzione: {
                                        [giornata]: nuoviCompleti,
                                        [nuoveOre]: giorniNuoveOre
                                    }
                                });
                            }
                        }
                    }
                }
                
                return opzioni.slice(0, 3); // Max 3 opzioni
            };

            const getOrePersonalizzateTotali = () => {
                const p = distribuzioneOre.personalizzata;
                return (p.ore7 * 7) + (p.ore6 * 6) + (p.ore5 * 5) + (p.ore4 * 4) + (p.ore3 * 3);
            };

            const aggiornaDistribuzionePersonalizzata = (ore, valore) => {
                setDistribuzioneOre({
                    ...distribuzioneOre,
                    personalizzata: {
                        ...distribuzioneOre.personalizzata,
                        [ore]: parseInt(valore) || 0
                    }
                });
            };

            // Valida che la distribuzione personalizzata rispetti i vincoli 3-7h
            const isDistribuzionePersonalizzataValida = () => {
                const p = distribuzioneOre.personalizzata;
                const totalePersonalizzato = getOrePersonalizzateTotali();
                
                // Deve essere uguale al totale corso
                if (totalePersonalizzato !== parametri.oreTotali) {
                    return false;
                }
                
                // Tutti i valori devono essere >= 0
                if (p.ore7 < 0 || p.ore6 < 0 || p.ore5 < 0 || p.ore4 < 0 || p.ore3 < 0) {
                    return false;
                }
                
                return true;
            };

            // Ottiene array di ore per ogni giornata basato sulla distribuzione scelta
            const getArrayOreGiornate = () => {
                const opzioni = calcolaOpzioniDistribuzione();
                
                // Se distribuzione perfetta, usa ore standard
                if (opzioni.length === 0) {
                    const numGiorni = Math.floor(parametri.oreTotali / parametri.oreGiorno);
                    return Array(numGiorni).fill(parametri.oreGiorno);
                }
                
                let distribuzione = {};
                
                if (distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta !== null) {
                    // Usa opzione automatica scelta
                    distribuzione = opzioni[distribuzioneOre.opzioneScelta].distribuzione;
                } else if (distribuzioneOre.modalita === 'personalizzata') {
                    // Usa distribuzione personalizzata
                    const p = distribuzioneOre.personalizzata;
                    if (p.ore7 > 0) distribuzione[7] = p.ore7;
                    if (p.ore6 > 0) distribuzione[6] = p.ore6;
                    if (p.ore5 > 0) distribuzione[5] = p.ore5;
                    if (p.ore4 > 0) distribuzione[4] = p.ore4;
                    if (p.ore3 > 0) distribuzione[3] = p.ore3;
                } else {
                    // Nessuna opzione selezionata, usa prima opzione automatica
                    distribuzione = opzioni[0].distribuzione;
                }
                
                // Crea array con ordine: prima 7h, poi 6h, 5h, 4h, 3h
                const arrayOre = [];
                [7, 6, 5, 4, 3].forEach(ore => {
                    if (distribuzione[ore]) {
                        for (let i = 0; i < distribuzione[ore]; i++) {
                            arrayOre.push(ore);
                        }
                    }
                });
                
                return arrayOre;
            };

            return (
                <div>
                    <div className="header">
                        <div className="container">
                            <h1>
                                <span>Generatore Calendari Corsi 2026</span>
                                <img
                                    className="header-logo"
                                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA+gAAAPoCAYAAABNo9TkAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAEtWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA4LTE4PC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmMyNDU4ZTRmLWQ4ZTctNDFjYS1iZTliLTMyMzQwNjRmMDc3MDwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5TT04gRElHSVRBTEUgLSA0PC9yZGY6bGk+CiAgIDwvcmRmOkFsdD4KICA8L2RjOnRpdGxlPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpwZGY9J2h0dHA6Ly9ucy5hZG9iZS5jb20vcGRmLzEuMy8nPgogIDxwZGY6QXV0aG9yPnNjaGlyYWwxOTwvcGRmOkF1dGhvcj4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6eG1wPSdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvJz4KICA8eG1wOkNyZWF0b3JUb29sPkNhbnZhIChSZW5kZXJlcikgZG9jPURBR3Y5bzhtSFRBIHVzZXI9VUFCVFprLURSTG8gYnJhbmQ9QkFCVFprbl9lZkkgdGVtcGxhdGU9PC94bXA6Q3JlYXRvclRvb2w+CiA8L3JkZjpEZXNjcmlwdGlvbj4KPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0ncic/PnzI/hwAAFOLSURBVHic7NcxAQAACIAw7V/aGHJsCXjZAQAAAN7tdwAAAABg0AEAACDBoAMAAECAQQcAAIAAgw4AAAABBh0AAAACDDoAAAAEGHQAAAAIMOgAAAAQYNABAAAgwKADAABAgEEHAACAAIMOAAAAAQYdAAAAAgw6AAAABBh0AAAACDDoAAAAEGDQAQAAIMCgAwAAQIBBBwAAgACDDgAAAAEGHQAAAAIMOgAAAAQYdAAAAAgw6AAAABBg0AEAACDAoAMAAECAQQcAAIAAgw4AAAABBh0AAAACDDoAAAAEGHQAAAAIMOgAAAAQYNABAAAgwKADAABAgEEHAACAAIMOAAAAAQYdAAAAAgw6AAAABBh0AAAACDDoAAAAEGDQAQAAIMCgAwAAQIBBBwAAgACDDgAAAAEGHQAAAAIMOgAAAAQYdAAAAAgw6AAAABBg0AEAACDAoAMAAECAQQcAAIAAgw4AAAABBh0AAAACDDoAAAAEGHQAAAAIMOgAAAAQYNABAAAgwKADAABAgEEHAACAAIMOAAAAAQYdAAAAAgw6AAAABBh0AAAACDDoAAAAEHAAAAD//+zXsQAAAADAIH/raewoiwQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgIAAP//7NexAAAAAMAgf+tp7CiLBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGAgAA///s17EAAAAAwCB/62nsKIsEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYCAAD//+zXsQAAAADAIH/raewoiwQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgIAAP//7NexAAAAAMAgf+tp7CiLBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0A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AAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGAgAA///s17EAAAAAwCB/62nsKIsEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYCAAD//+zXsQAAAADAIH/raewoiwQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgQdAAAABgIAAP//7NexAAAAAMAgf+tp7CiLBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGBB0AAAAGAgAA///t17EAAAAAwCB/62nsKIsEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYEHQAAAAYC/Sii8KtlEb8AAAAASUVORK5CYII="
                                    alt="SONODIGITALE logo"
                                />
                            </h1>
                            <p>SONODIGITALE - Tool per Arianna @ Atoma srl</p>
                        </div>
                    </div>

                    <div className="container">
                        {/* Template */}
                        <div className="section">
                            <div className="section-title">
                                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                                1. Scegli Template Corso
                            </div>
                            <div className="grid grid-cols-3">
                                <button
                                    onClick={() => caricaTemplate('ai100')}
                                    className={`template-card ${templateSelezionato === 'ai100' ? 'active' : ''}`}
                                >
                                    <div className="title">AI Start - 100 ore</div>
                                    <div className="subtitle">4 settimane, 5h/giorno, 20 lezioni</div>
                                </button>
                                <button
                                    onClick={() => caricaTemplate('social50')}
                                    className={`template-card ${templateSelezionato === 'social50' ? 'active' : ''}`}
                                >
                                    <div className="title">Social Media Manager - 50 ore</div>
                                    <div className="subtitle">3 settimane, 4h/giorno, 13 lezioni</div>
                                </button>
                                <button
                                    onClick={() => {
                                        setTemplateSelezionato('custom');
                                        setProgramma([]); // üéØ NON creare lezioni subito
                                        setParametri({
                                            ...parametri,
                                            nomeCorso: '',
                                            oreTotali: 0,
                                            oreGiorno: 0
                                        });
                                        // Reset distribuzione
                                        setDistribuzioneOre({
                                            modalita: 'automatica',
                                            opzioneScelta: null,
                                            personalizzata: {
                                                ore7: 0,
                                                ore6: 0,
                                                ore5: 0,
                                                ore4: 0,
                                                ore3: 0
                                            }
                                        });
                                    }}
                                    className={`template-card ${templateSelezionato === 'custom' ? 'active' : ''}`}
                                >
                                    <div className="title">Corso Personalizzato</div>
                                    <div className="subtitle">Crea da zero</div>
                                </button>
                            </div>
                        </div>

                        {/* Parametri */}
                        <div className="section">
                            <div className="section-title">
                                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                2. Parametri Corso
                            </div>
                            <div className="grid grid-cols-4">
                                <div className="form-group">
                                    <label className="form-label">Nome Corso</label>
                                    <input
                                        type="text"
                                        value={parametri.nomeCorso}
                                        onChange={(e) => setParametri({ ...parametri, nomeCorso: e.target.value })}
                                        className="form-input"
                                        placeholder="Es: AI Start"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Ore Totali</label>
                                    <input
                                        type="number"
                                        value={parametri.oreTotali}
                                        onChange={(e) => setParametri({ ...parametri, oreTotali: parseInt(e.target.value) || 0 })}
                                        className="form-input"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Ore al Giorno</label>
                                    <input
                                        type="number"
                                        value={parametri.oreGiorno}
                                        onChange={(e) => setParametri({ ...parametri, oreGiorno: parseInt(e.target.value) || 0 })}
                                        className="form-input"
                                        min="3"
                                        max="7"
                                    />
                                    {(parametri.oreGiorno < 3 || parametri.oreGiorno > 7) && parametri.oreGiorno !== 0 && (
                                        <div style={{fontSize: '0.75rem', color: '#dc2626', marginTop: '0.25rem'}}>
                                            ‚ö†Ô∏è Le lezioni devono essere tra 3h e 7h
                                        </div>
                                    )}
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Numero Docenti</label>
                                    <input
                                        type="number"
                                        value={parametri.numeroDocenti}
                                        onChange={(e) => aggiornaNumeroDocenti(parseInt(e.target.value) || 1)}
                                        className="form-input"
                                        min="1"
                                        max="10"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Orario Inizio</label>
                                    <input
                                        type="time"
                                        value={parametri.orarioInizio}
                                        onChange={(e) => setParametri({ ...parametri, orarioInizio: e.target.value })}
                                        className="form-input"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Orario Fine</label>
                                    <input
                                        type="time"
                                        value={parametri.orarioFine}
                                        onChange={(e) => setParametri({ ...parametri, orarioFine: e.target.value })}
                                        className="form-input"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Data Inizio Periodo</label>
                                    <input
                                        type="date"
                                        value={parametri.dataInizio}
                                        onChange={(e) => setParametri({ ...parametri, dataInizio: e.target.value })}
                                        className="form-input"
                                        min="2026-01-01"
                                        max="2026-12-31"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Data Fine Periodo</label>
                                    <input
                                        type="date"
                                        value={parametri.dataFine}
                                        onChange={(e) => setParametri({ ...parametri, dataFine: e.target.value })}
                                        className="form-input"
                                        min="2026-01-01"
                                        max="2026-12-31"
                                    />
                                </div>
                            </div>

                            {/* Box Festivit√† nel Periodo */}
                            {parametri.dataInizio && parametri.dataFine && (() => {
                                const festivitaNelPeriodo = getFestivitaNelPeriodo();
                                if (festivitaNelPeriodo.length > 0) {
                                    return (
                                        <div style={{marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '1px solid #e5e7eb'}}>
                                            <div style={{
                                                backgroundColor: '#dbeafe',
                                                border: '2px solid #3b82f6',
                                                borderRadius: '0.5rem',
                                                padding: '1rem'
                                            }}>
                                                <div style={{
                                                    fontWeight: 'bold',
                                                    color: '#1e40af',
                                                    marginBottom: '0.5rem',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    gap: '0.5rem'
                                                }}>
                                                    üéâ Festivit√† nel periodo selezionato ({festivitaNelPeriodo.length}):
                                                </div>
                                                <div style={{
                                                    display: 'flex',
                                                    flexWrap: 'wrap',
                                                    gap: '0.5rem',
                                                    marginTop: '0.5rem'
                                                }}>
                                                    {festivitaNelPeriodo.map((festa, idx) => (
                                                        <div key={idx} style={{
                                                            backgroundColor: '#fef3c7',
                                                            color: '#92400e',
                                                            padding: '0.25rem 0.75rem',
                                                            borderRadius: '0.25rem',
                                                            fontSize: '0.875rem',
                                                            fontWeight: '500'
                                                        }}>
                                                            {new Date(festa.data).toLocaleDateString('it-IT')} - {festa.nome}
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    );
                                }
                                return null;
                            })()}

                            {/* Nomi Docenti */}
                            {parametri.numeroDocenti > 0 && (
                                <div style={{marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '1px solid #e5e7eb'}}>
                                    <label className="form-label" style={{marginBottom: '0.75rem', display: 'block', fontSize: '1rem', fontWeight: '600'}}>
                                        üìù Nomi Docenti (opzionale)
                                    </label>
                                    <div style={{fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.75rem'}}>
                                        Lascia vuoto per usare "Docente 1", "Docente 2", ecc. Puoi inserire solo alcuni nomi.
                                    </div>
                                    <div className="grid grid-cols-4">
                                        {Array.from({ length: parametri.numeroDocenti }, (_, i) => (
                                            <div key={i} className="form-group">
                                                <label className="form-label">Docente {i + 1}</label>
                                                <input
                                                    type="text"
                                                    value={nomiDocenti[i] || ''}
                                                    onChange={(e) => aggiornaNomeDocente(i, e.target.value)}
                                                    className="form-input"
                                                    placeholder={`Docente ${i + 1}`}
                                                />
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* Giorni della settimana */}
                            <div style={{marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '1px solid #e5e7eb'}}>
                                <label className="form-label" style={{marginBottom: '0.75rem', display: 'block', fontSize: '1rem', fontWeight: '600'}}>
                                    üìÖ Giorni Lavorativi
                                </label>
                                <div style={{display: 'flex', gap: '0.75rem', flexWrap: 'wrap'}}>
                                    {[
                                        { num: 1, nome: 'Luned√¨' },
                                        { num: 2, nome: 'Marted√¨' },
                                        { num: 3, nome: 'Mercoled√¨' },
                                        { num: 4, nome: 'Gioved√¨' },
                                        { num: 5, nome: 'Venerd√¨' },
                                        { num: 6, nome: 'Sabato' },
                                        { num: 7, nome: 'Domenica' },
                                    ].map(giorno => (
                                        <label key={giorno.num} className="radio-label" style={{
                                            padding: '0.5rem 1rem',
                                            borderRadius: '0.375rem',
                                            border: '2px solid',
                                            borderColor: parametri.giorni.includes(giorno.num) ? '#FC7E15' : '#e5e7eb',
                                            backgroundColor: parametri.giorni.includes(giorno.num) ? '#fff7ed' : 'white',
                                            cursor: 'pointer',
                                            transition: 'all 0.2s'
                                        }}>
                                            <input
                                                type="checkbox"
                                                checked={parametri.giorni.includes(giorno.num)}
                                                onChange={(e) => {
                                                    if (e.target.checked) {
                                                        setParametri({ ...parametri, giorni: [...parametri.giorni, giorno.num].sort() });
                                                    } else {
                                                        setParametri({ ...parametri, giorni: parametri.giorni.filter(d => d !== giorno.num) });
                                                    }
                                                }}
                                            />
                                            {giorno.nome}
                                        </label>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* Distribuzione Ore (solo se necessario) */}
                        {(() => {
                            const opzioni = calcolaOpzioniDistribuzione();
                            const totalePersonalizzato = getOrePersonalizzateTotali();
                            const isValido = totalePersonalizzato === parametri.oreTotali;
                            
                            if (opzioni.length > 0 && templateSelezionato === 'custom') {
                                return (
                                    <div className="section">
                                        <div className="section-title">
                                            <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                            3. Distribuzione Ore
                                        </div>

                                        <div className="alert alert-warning">
                                            <strong>‚ö†Ô∏è Attenzione:</strong> {parametri.oreTotali}h √∑ {parametri.oreGiorno}h al giorno = {Math.floor(parametri.oreTotali / parametri.oreGiorno)} giorni completi + {parametri.oreTotali % parametri.oreGiorno}h di resto.<br />
                                            <strong>Scegli come distribuire il resto:</strong><br />
                                            <small>‚ö†Ô∏è <strong>VINCOLI:</strong> Ogni lezione deve essere minimo 3h e massimo 7h. Lezioni da 7h = 9:00-13:00 / 14:00-17:00 (con pausa pranzo).</small>
                                        </div>

                                        <div className="distribuzione-section">
                                            <div className="distribuzione-title">üìä Opzioni Distribuzione</div>
                                            
                                            {/* Opzioni Automatiche */}
                                            {opzioni.map((opzione, idx) => (
                                                <div
                                                    key={idx}
                                                    className={`opzione-card ${distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta === idx ? 'selected' : ''}`}
                                                    onClick={() => setDistribuzioneOre({ modalita: 'automatica', opzioneScelta: idx, personalizzata: distribuzioneOre.personalizzata })}
                                                >
                                                    <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                        <input
                                                            type="radio"
                                                            checked={distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta === idx}
                                                            onChange={() => {}}
                                                        />
                                                        <div style={{flex: 1}}>
                                                            <div className="opzione-descrizione">Opzione {String.fromCharCode(65 + idx)}: {opzione.descrizione}</div>
                                                            <div className="opzione-dettaglio">{opzione.dettaglio}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}

                                            {/* Opzione Personalizzata */}
                                            <div
                                                className={`opzione-card ${distribuzioneOre.modalita === 'personalizzata' ? 'selected' : ''}`}
                                                onClick={() => setDistribuzioneOre({ ...distribuzioneOre, modalita: 'personalizzata' })}
                                            >
                                                <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.5rem'}}>
                                                    <input
                                                        type="radio"
                                                        checked={distribuzioneOre.modalita === 'personalizzata'}
                                                        onChange={() => {}}
                                                    />
                                                    <div className="opzione-descrizione">Personalizzata (tu decidi)</div>
                                                </div>

                                                {distribuzioneOre.modalita === 'personalizzata' && (
                                                    <div style={{marginTop: '0.75rem', paddingLeft: '1.5rem'}}>
                                                        <div style={{fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem'}}>
                                                            ‚ÑπÔ∏è Inserisci il numero di giorni per ogni fascia oraria (solo 3h-7h permessi).
                                                        </div>
                                                        <div className="personalizzata-grid">
                                                            {[7, 6, 5, 4, 3].map(ore => (
                                                                <div key={ore} className="ore-input-group">
                                                                    <label className="ore-input-label">Giorni da {ore}h</label>
                                                                    <input
                                                                        type="number"
                                                                        min="0"
                                                                        value={distribuzioneOre.personalizzata[`ore${ore}`]}
                                                                        onChange={(e) => aggiornaDistribuzionePersonalizzata(`ore${ore}`, e.target.value)}
                                                                        className="form-input ore-input"
                                                                        onClick={(e) => e.stopPropagation()}
                                                                    />
                                                                    <div className="ore-calcolo">
                                                                        = {distribuzioneOre.personalizzata[`ore${ore}`] * ore}h
                                                                    </div>
                                                                </div>
                                                            ))}
                                                        </div>

                                                        <div className={`totale-ore ${isValido ? 'valido' : 'non-valido'}`}>
                                                            Totale: {totalePersonalizzato}h / {parametri.oreTotali}h {isValido ? '‚úÖ Perfetto!' : `‚ùå ${totalePersonalizzato > parametri.oreTotali ? 'Troppe' : 'Mancano'} ${Math.abs(totalePersonalizzato - parametri.oreTotali)} ore`}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                );
                            }
                            return null;
                        })()}

                        {/* Esclusioni Personalizzate */}
                        <div className="section">
                            <div className="section-title">
                                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                                </svg>
                                {calcolaOpzioniDistribuzione().length > 0 && templateSelezionato === 'custom' ? '4' : '3'}. Esclusioni Personalizzate (Chiusure Atoma)
                            </div>

                            <div className="alert alert-warning">
                                <strong>‚ÑπÔ∏è Le festivit√† nazionali italiane sono gi√† escluse automaticamente.</strong><br />
                                Usa questa sezione per aggiungere chiusure aziendali extra (es: settimana di Pasqua estesa, chiusura estiva, ecc.)
                            </div>

                            <div className="radio-group">
                                <label className="radio-label">
                                    <input
                                        type="radio"
                                        checked={tipoEsclusione === 'singola'}
                                        onChange={() => setTipoEsclusione('singola')}
                                    />
                                    Giorno Singolo
                                </label>
                                <label className="radio-label">
                                    <input
                                        type="radio"
                                        checked={tipoEsclusione === 'periodo'}
                                        onChange={() => setTipoEsclusione('periodo')}
                                    />
                                    Periodo (Range)
                                </label>
                            </div>

                            <div className="exclusion-form">
                                {tipoEsclusione === 'singola' ? (
                                    <div className="form-group">
                                        <label className="form-label">Data</label>
                                        <input
                                            type="date"
                                            value={dataEsclusione}
                                            onChange={(e) => setDataEsclusione(e.target.value)}
                                            className="form-input"
                                            min="2026-01-01"
                                            max="2026-12-31"
                                        />
                                    </div>
                                ) : (
                                    <>
                                        <div className="form-group">
                                            <label className="form-label">Da</label>
                                            <input
                                                type="date"
                                                value={dataInizioPeriodo}
                                                onChange={(e) => setDataInizioPeriodo(e.target.value)}
                                                className="form-input"
                                                min="2026-01-01"
                                                max="2026-12-31"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">A</label>
                                            <input
                                                type="date"
                                                value={dataFinePeriodo}
                                                onChange={(e) => setDataFinePeriodo(e.target.value)}
                                                className="form-input"
                                                min="2026-01-01"
                                                max="2026-12-31"
                                            />
                                        </div>
                                    </>
                                )}
                                
                                <div className="form-group">
                                    <label className="form-label">Motivo (opzionale)</label>
                                    <input
                                        type="text"
                                        value={motivoEsclusione}
                                        onChange={(e) => setMotivoEsclusione(e.target.value)}
                                        className="form-input"
                                        placeholder="Es: Chiusura Pasqua"
                                    />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">&nbsp;</label>
                                    <button onClick={aggiungiEsclusione} className="btn btn-add">
                                        <svg style={{width: '16px', height: '16px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                                        </svg>
                                        Aggiungi
                                    </button>
                                </div>
                            </div>

                            {esclusioni.length > 0 && (
                                <div style={{marginTop: '1rem'}}>
                                    <strong>Esclusioni aggiunte ({esclusioni.length}):</strong>
                                    <div style={{marginTop: '0.5rem'}}>
                                        {esclusioni.map(escl => (
                                            <div key={escl.id} className="esclusione-item">
                                                <div>
                                                    {escl.tipo === 'singola' ? (
                                                        <div className="esclusione-text">
                                                            <span className="esclusione-date">{new Date(escl.data).toLocaleDateString('it-IT')}</span>
                                                            {escl.motivo && ` - ${escl.motivo}`}
                                                        </div>
                                                    ) : (
                                                        <div className="esclusione-text">
                                                            <span className="esclusione-date">
                                                                {new Date(escl.dataInizio).toLocaleDateString('it-IT')} ‚Üí {new Date(escl.dataFine).toLocaleDateString('it-IT')}
                                                            </span>
                                                            {escl.motivo && ` - ${escl.motivo}`}
                                                        </div>
                                                    )}
                                                </div>
                                                <button onClick={() => rimuoviEsclusione(escl.id)} className="btn btn-remove">
                                                    <svg style={{width: '16px', height: '16px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                                    </svg>
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Programma - üéØ MOSTRATO SOLO SE CI SONO LEZIONI */}
                        {programma.length > 0 && (
                            <div className="section">
                                <div className="section-header">
                                    <div className="section-title">
                                        <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                        </svg>
                                        {calcolaOpzioniDistribuzione().length > 0 && templateSelezionato === 'custom' ? '5' : '4'}. Programma Didattico ({programma.length} lezioni)
                                    </div>
                                    <button onClick={aggiungiLezione} className="btn btn-add">
                                        <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                                        </svg>
                                        Aggiungi Lezione
                                    </button>
                                </div>

                                {templateSelezionato === 'custom' && (
                                    <div className="alert alert-success" style={{marginBottom: '1rem'}}>
                                        <strong>‚úÖ Lezioni generate automaticamente!</strong><br />
                                        Il programma √® stato creato con {programma.length} lezioni in base alla distribuzione ore scelta. Compila i moduli e gli argomenti per ogni lezione.
                                    </div>
                                )}

                                <div className="programma-container">
                                    {programma.map((lezione, index) => (
                                        <div key={index} className="lezione-item">
                                            <div className="lezione-giorno">Giorno {lezione.giorno}</div>
                                            <input
                                                type="text"
                                                value={lezione.modulo}
                                                onChange={(e) => aggiornaLezione(index, 'modulo', e.target.value)}
                                                className="form-input lezione-modulo"
                                                placeholder="Modulo"
                                            />
                                            <input
                                                type="text"
                                                value={lezione.argomenti}
                                                onChange={(e) => aggiornaLezione(index, 'argomenti', e.target.value)}
                                                className="form-input lezione-argomenti"
                                                placeholder="Argomenti della lezione"
                                            />
                                            <button onClick={() => rimuoviLezione(index)} className="btn btn-remove">
                                                <svg style={{width: '16px', height: '16px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                                </svg>
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Calcola */}
                        <div className="section">
                            <button onClick={calcolaCorsi} className="btn btn-primary">
                                <svg style={{width: '24px', height: '24px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                                Calcola Corsi e Genera Calendari
                            </button>
                        </div>

                        {/* Risultati */}
                        {risultati && (
                            <div className="section">
                                <div className="result-title">üìä Risultati Calcolo</div>
                                
                                <div className="alert alert-info" style={{marginBottom: '1rem'}}>
                                    <strong>üìÖ Giorni esclusi dal calcolo:</strong><br />
                                    ‚Ä¢ Festivit√† nazionali: {risultati.festivita}<br />
                                    ‚Ä¢ Esclusioni personalizzate: {risultati.esclusioni}<br />
                                    ‚Ä¢ Weekend e giorni non lavorativi
                                </div>

                                <div className="stats-grid">
                                    <div className="stat-card gray">
                                        <div className="stat-label">Giorni Necessari</div>
                                        <div className="stat-value">{risultati.giorniNecessari}</div>
                                    </div>
                                    <div className="stat-card gray">
                                        <div className="stat-label">Giorni Disponibili</div>
                                        <div className="stat-value">{risultati.giorniDisponibili}</div>
                                    </div>
                                    <div className="stat-card gray">
                                        <div className="stat-label">Corsi per Docente</div>
                                        <div className="stat-value">{risultati.corsiPerDocente}</div>
                                    </div>
                                    <div className="stat-card orange">
                                        <div className="stat-label">Corsi Totali</div>
                                        <div className="stat-value">{risultati.corsiTotali}</div>
                                    </div>
                                </div>

                                {calendari.length > 0 && (
                                    <>
                                        <button onClick={esportaExcel} className="btn btn-success">
                                            <svg style={{width: '20px', height: '20px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                            </svg>
                                            Scarica Tutti i Calendari Excel
                                        </button>

                                        <div className="info-text">
                                            Generati {calendari.length} calendari completi
                                        </div>

                                        <div>
                                            {calendari.map((calendario, idx) => {
                                                const isEspanso = calendariEspansi.includes(idx);
                                                const lezioniDaMostrare = isEspanso ? calendario.lezioni : calendario.lezioni.slice(0, 5);
                                                
                                                return (
                                                    <div key={idx} className="calendario-card">
                                                        <div className="calendario-title">{calendario.nome}</div>
                                                        <div className="calendario-date">
                                                            üìÖ {calendario.dataInizio.toLocaleDateString('it-IT')} ‚Üí {calendario.dataFine.toLocaleDateString('it-IT')} ({calendario.lezioni.length} lezioni)
                                                        </div>
                                                        <div className="table-container">
                                                            <table>
                                                                <thead>
                                                                    <tr>
                                                                        <th>Data</th>
                                                                        <th>Giorno</th>
                                                                        <th>Orario</th>
                                                                        <th>Ore</th>
                                                                        <th>Modulo</th>
                                                                        <th>Argomenti</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    {lezioniDaMostrare.map((lezione, lidx) => (
                                                                        <tr key={lidx}>
                                                                            <td>{lezione.data.toLocaleDateString('it-IT')}</td>
                                                                            <td>{lezione.giorno}</td>
                                                                            <td>{lezione.orario}</td>
                                                                            <td style={{textAlign: 'center'}}>{lezione.ore}h</td>
                                                                            <td>{lezione.modulo}</td>
                                                                            <td style={{fontSize: '0.75rem'}}>
                                                                                {isEspanso ? lezione.argomenti : (
                                                                                    <>
                                                                                        {lezione.argomenti.substring(0, 80)}{lezione.argomenti.length > 80 ? '...' : ''}
                                                                                    </>
                                                                                )}
                                                                            </td>
                                                                        </tr>
                                                                    ))}
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        {calendario.lezioni.length > 5 && (
                                                            <button 
                                                                onClick={() => toggleEspansioneCalendario(idx)} 
                                                                className="btn btn-expand"
                                                            >
                                                                {isEspanso ? (
                                                                    <>
                                                                        <svg style={{width: '16px', height: '16px', display: 'inline-block', marginRight: '0.5rem'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 15l7-7 7 7" />
                                                                        </svg>
                                                                        Mostra meno
                                                                    </>
                                                                ) : (
                                                                    <>
                                                                        <svg style={{width: '16px', height: '16px', display: 'inline-block', marginRight: '0.5rem'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                                                                        </svg>
                                                                        Mostra tutte le {calendario.lezioni.length} lezioni
                                                                    </>
                                                                )}
                                                            </button>
                                                        )}
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CalendarioCorsiApp />, document.getElementById('root'));
    </script>
</body>
</html>
