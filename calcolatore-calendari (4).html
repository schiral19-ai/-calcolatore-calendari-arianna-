<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generatore Calendari Corsi 2026 - SONODIGITALE</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f9fafb;
            color: #111827;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        .header {
            background: linear-gradient(to right, #196C28, #1a7a2e);
            color: white;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .header .container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 2rem;
        }

        .header-content {
            flex: 1;
        }

        .header h1 {
            font-size: 1.875rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header p {
            color: #d1d5db;
            margin-top: 0.5rem;
        }

        .header-logo {
            height: 150px;
            width: auto;
        }

        @media (max-width: 768px) {
            .header .container {
                flex-direction: column;
                align-items: flex-start;
            }

            .header-logo {
                height: 120px;
            }
        }

        .section {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .grid {
            display: grid;
            gap: 1rem;
        }

        .grid-cols-3 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .grid-cols-4 {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }

        .template-card {
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .template-card:hover {
            border-color: #fdba74;
        }

        .template-card.active {
            border-color: #FC7E15;
            background-color: #fff7ed;
        }

        .template-card .title {
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .template-card .subtitle {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
            color: #374151;
        }

        .form-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }

        .form-input:focus {
            outline: none;
            border-color: #FC7E15;
            box-shadow: 0 0 0 3px rgba(252, 126, 21, 0.1);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: opacity 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-primary {
            background-color: #FC7E15;
            color: white;
        }

        .btn-success {
            background-color: #10b981;
            color: white;
            width: 100%;
        }

        .btn-add {
            background-color: #3b82f6;
            color: white;
        }

        .btn-remove {
            background-color: #dc2626;
            color: white;
            padding: 0.5rem;
        }

        .lezione-item {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            padding: 0.75rem;
            background-color: #f9fafb;
            border-radius: 0.375rem;
            margin-bottom: 0.5rem;
        }

        .lezione-giorno {
            width: 80px;
            font-size: 0.875rem;
            font-weight: 500;
            color: #6b7280;
            padding-top: 0.5rem;
            flex-shrink: 0;
        }

        .lezione-modulo {
            width: 160px;
            flex-shrink: 0;
        }

        .lezione-argomenti {
            flex: 1;
            min-width: 200px;
        }

        .programma-container {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .programma-container::-webkit-scrollbar {
            width: 8px;
        }

        .programma-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .programma-container::-webkit-scrollbar-thumb {
            background: #FC7E15;
            border-radius: 4px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            padding: 1rem;
            border-radius: 0.5rem;
        }

        .stat-card.gray {
            background-color: #f9fafb;
        }

        .stat-card.orange {
            background-color: #FC7E15;
            color: white;
        }

        .stat-label {
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }

        .stat-card.gray .stat-label {
            color: #6b7280;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .calendario-card {
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: border-color 0.2s;
        }

        .calendario-card:hover {
            border-color: #fdba74;
        }

        .calendario-title {
            font-size: 1.125rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .calendario-date {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.75rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        th {
            background-color: #f3f4f6;
            padding: 0.5rem;
            text-align: left;
            border: 1px solid #e5e7eb;
            font-weight: 600;
        }

        td {
            padding: 0.5rem;
            border: 1px solid #e5e7eb;
        }

        tr:hover {
            background-color: #f9fafb;
        }

        .table-container {
            overflow-x: auto;
        }

        .text-muted {
            color: #6b7280;
            text-align: center;
            padding: 1rem;
            background-color: #f9fafb;
        }

        .icon {
            width: 1.25rem;
            height: 1.25rem;
            color: #FC7E15;
        }

        .icon-lg {
            width: 2rem;
            height: 2rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .result-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #FC7E15;
            margin-bottom: 1rem;
        }

        .info-text {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .alert-info {
            background-color: #dbeafe;
            color: #1e40af;
            border-left: 4px solid #3b82f6;
        }

        .alert-warning {
            background-color: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
        }

        .alert-success {
            background-color: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }

        .esclusione-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background-color: #fef2f2;
            border-radius: 0.375rem;
            margin-bottom: 0.5rem;
            border-left: 3px solid #dc2626;
        }

        .esclusione-text {
            font-size: 0.875rem;
            color: #374151;
        }

        .esclusione-date {
            font-weight: 600;
            color: #111827;
        }

        .festivity-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background-color: #fef3c7;
            color: #92400e;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            margin-right: 0.5rem;
            margin-bottom: 0.25rem;
        }

        .festivity-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .btn-expand {
            background-color: #f3f4f6;
            color: #374151;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            margin-top: 1rem;
            width: 100%;
        }

        .btn-expand:hover {
            background-color: #e5e7eb;
        }

        .exclusion-form {
            display: grid;
            grid-template-columns: auto auto auto 1fr;
            gap: 0.5rem;
            align-items: end;
            margin-bottom: 1rem;
        }

        .radio-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .distribuzione-section {
            background-color: #fff7ed;
            border: 2px solid #FC7E15;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
        }

        .distribuzione-title {
            font-weight: bold;
            color: #FC7E15;
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }

        .opzione-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 0.375rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .opzione-card:hover {
            border-color: #FC7E15;
        }

        .opzione-card.selected {
            border-color: #FC7E15;
            background-color: #fff7ed;
        }

        .opzione-descrizione {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .opzione-dettaglio {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .personalizzata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.75rem;
        }

        .ore-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .ore-input-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: #6b7280;
        }

        .ore-input {
            text-align: center;
        }

        .ore-calcolo {
            font-size: 0.75rem;
            color: #6b7280;
            text-align: center;
        }

        .totale-ore {
            margin-top: 0.75rem;
            padding: 0.75rem;
            border-radius: 0.375rem;
            font-weight: 600;
            text-align: center;
        }

        .totale-ore.valido {
            background-color: #d1fae5;
            color: #065f46;
        }

        .totale-ore.non-valido {
            background-color: #fee2e2;
            color: #991b1b;
        }

        @media (max-width: 768px) {
            .lezione-item {
                flex-direction: column;
            }

            .lezione-giorno,
            .lezione-modulo,
            .lezione-argomenti {
                width: 100%;
            }

            .exclusion-form {
                grid-template-columns: 1fr;
            }
        }

        .footer {
            background: linear-gradient(to right, #196C28, #1a7a2e);
            color: white;
            text-align: center;
            padding: 1.5rem;
            margin-top: 2rem;
            font-size: 0.875rem;
        }

        .footer-text {
            color: #d1d5db;
        }

        /* Pulsante Guida */
        .btn-guida {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: #196C28;
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-guida:hover {
            background-color: #1a7a2e;
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-content {
            background: white;
            border-radius: 1rem;
            max-width: 800px;
            max-height: 90vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 2px solid #e5e7eb;
            background: linear-gradient(to right, #196C28, #1a7a2e);
            border-radius: 1rem 1rem 0 0;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.5rem;
            color: white;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.25rem;
            transition: background-color 0.2s;
        }

        .modal-close:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 2rem;
            overflow-y: auto;
            flex: 1;
        }

        .guida-section {
            margin-bottom: 2rem;
        }

        .guida-section h3 {
            color: #196C28;
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .guida-section p {
            color: #4b5563;
            line-height: 1.6;
            margin-bottom: 0.75rem;
        }

        .guida-section ul {
            list-style-type: none;
            padding-left: 0;
        }

        .guida-section ul li {
            color: #4b5563;
            line-height: 1.8;
            padding-left: 1.5rem;
            position: relative;
            margin-bottom: 0.5rem;
        }

        .guida-section ul li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #196C28;
            font-weight: bold;
        }

        .guida-section em {
            background-color: #fef3c7;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-style: normal;
        }

        @media (max-width: 768px) {
            .modal-content {
                max-height: 95vh;
                margin: 0.5rem;
            }

            .modal-body {
                padding: 1rem;
            }

            .modal-header h2 {
                font-size: 1.1rem;
            }

            .guida-section h3 {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <div class="footer">
        <p class="footer-text">Sviluppato da Roberto Schiraldi</p>
    </div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const CalendarioCorsiApp = () => {
            const [templateSelezionato, setTemplateSelezionato] = useState('');
            const [parametri, setParametri] = useState({
                nomeCorso: '',
                oreTotali: 100,
                oreGiorno: 5,
                orarioInizio: '09:00',
                orarioFine: '14:00',
                giorni: [1, 2, 3, 4, 5],
                numeroDocenti: 2,
                dataInizio: '',
                dataFine: '',
                tipoDefault: 'presenza',
            });
            
            const [programma, setProgramma] = useState([]);
            const [risultati, setRisultati] = useState(null);
            const [calendari, setCalendari] = useState([]);
            const [esclusioni, setEsclusioni] = useState([]);
            const [calendariEspansi, setCalendariEspansi] = useState([]);
            const [nomiDocenti, setNomiDocenti] = useState([]);
            const [modificheOrari, setModificheOrari] = useState({});
            const [distribuzioneOre, setDistribuzioneOre] = useState({
                modalita: 'automatica', // 'automatica' o 'personalizzata'
                opzioneScelta: null, // indice opzione automatica scelta
                personalizzata: {
                    ore7: 0,
                    ore6: 0,
                    ore5: 0,
                    ore4: 0,
                    ore3: 0
                }
            });
            const [tipoEsclusione, setTipoEsclusione] = useState('singola'); // 'singola' o 'periodo'
            const [dataEsclusione, setDataEsclusione] = useState('');
            const [dataInizioPeriodo, setDataInizioPeriodo] = useState('');
            const [dataFinePeriodo, setDataFinePeriodo] = useState('');
            const [motivoEsclusione, setMotivoEsclusione] = useState('');
            const [mostraGuida, setMostraGuida] = useState(false);

            // Festivit√† italiane 2026
            const festivitaItaliane2026 = [
                { data: '2026-01-01', nome: 'Capodanno' },
                { data: '2026-01-06', nome: 'Epifania' },
                { data: '2026-04-05', nome: 'Pasqua' },
                { data: '2026-04-06', nome: 'Luned√¨ dell\'Angelo' },
                { data: '2026-04-25', nome: 'Festa della Liberazione' },
                { data: '2026-05-01', nome: 'Festa dei Lavoratori' },
                { data: '2026-06-02', nome: 'Festa della Repubblica' },
                { data: '2026-08-15', nome: 'Ferragosto' },
                { data: '2026-11-01', nome: 'Ognissanti' },
                { data: '2026-12-08', nome: 'Immacolata Concezione' },
                { data: '2026-12-25', nome: 'Natale' },
                { data: '2026-12-26', nome: 'Santo Stefano' },
            ];

            const templates = {
                ai100: {
                    nome: 'AI Start - 100 ore',
                    oreTotali: 100,
                    oreGiorno: 5,
                    orarioInizio: '09:00',
                    orarioFine: '14:00',
                    tipoDefault: 'online',
                    programma: [
                        { giorno: 1, modulo: 'Modulo 1', argomenti: "Cos'√® l'IA (storia, definizioni, ambiti). Tipologie di AI (Narrow, General, Generative)." },
                        { giorno: 2, modulo: 'Modulo 1', argomenti: 'Prompt Engineering (principi base). Panoramica strumenti AI (ChatGPT, Gemini, Copilot).' },
                        { giorno: 3, modulo: 'Modulo 1', argomenti: 'Aggiornamenti Google (Gemini, NotebookLM). Dashboard e personalizzazione account.' },
                        { giorno: 4, modulo: 'Modulo 1', argomenti: 'Deep Research e nuovi motori (Perplexity). Esercitazioni pratiche di base.' },
                        { giorno: 5, modulo: 'Modulo 1', argomenti: 'AI per produttivit√† personale: gestione tempo, to-do list, organizzazione attivit√†.' },
                        { giorno: 6, modulo: 'Moduli 1 e 2', argomenti: 'AI per produttivit√† (continuazione). Creazione CV con AI. Lettere di presentazione.' },
                        { giorno: 7, modulo: 'Modulo 2', argomenti: 'Preparazione colloqui (simulazioni). Strumenti AI per grafica (Canva AI).' },
                        { giorno: 8, modulo: 'Modulo 2', argomenti: 'Contenuti per LinkedIn. Piano base di personal branding. AI nel marketing digitale.' },
                        { giorno: 9, modulo: 'Modulo 2', argomenti: 'Piano editoriale con AI. Generazione contenuti: post e reel per social media.' },
                        { giorno: 10, modulo: 'Modulo 2', argomenti: 'Generazione testi persuasivi. Copywriting con AI per marketing.' },
                        { giorno: 11, modulo: 'Modulo 3', argomenti: 'AI per immagini e video: modelli principali. Canva Magic Design.' },
                        { giorno: 12, modulo: 'Modulo 3', argomenti: 'Esercitazioni pratiche: piani editoriali per Instagram e LinkedIn.' },
                        { giorno: 13, modulo: 'Modulo 3', argomenti: 'Automazioni semplificate: concetti base, vantaggi ed esempi pratici.' },
                        { giorno: 14, modulo: 'Modulo 3', argomenti: 'CRM introduttivo con Excel e Google Sheets. Gestione contatti con AI.' },
                        { giorno: 15, modulo: 'Modulo 3', argomenti: 'Ricerca avanzata con AI su web e LinkedIn. Esercitazioni finali Modulo 3.' },
                        { giorno: 16, modulo: 'Modulo 4', argomenti: 'Avvio project work individuale o di gruppo. Pianificazione attivit√†.' },
                        { giorno: 17, modulo: 'Modulo 4', argomenti: 'Project work: sviluppo e supporto individuale.' },
                        { giorno: 18, modulo: 'Modulo 4', argomenti: 'Presentazione project work (parte 1). Feedback e correzioni.' },
                        { giorno: 19, modulo: 'Modulo 4', argomenti: 'Presentazione project work (parte 2). Personal Branding avanzato su LinkedIn.' },
                        { giorno: 20, modulo: 'Modulo 4', argomenti: 'Come presentare competenze in CV e colloqui. Q&A finale e completamento ore.' },
                    ]
                },
                social50: {
                    nome: 'Social Media Manager con AI - 50 ore',
                    oreTotali: 50,
                    oreGiorno: 4,
                    orarioInizio: '09:00',
                    orarioFine: '13:00',
                    tipoDefault: 'online',
                    programma: [
                        { giorno: 1, modulo: 'Settimana 1', argomenti: 'Introduzione Marketing e Logiche Digitali' },
                        { giorno: 2, modulo: 'Settimana 1', argomenti: 'Brand, Personal Brand e LinkedIn' },
                        { giorno: 3, modulo: 'Settimana 1', argomenti: 'AI Generativa per Social Media - Parte 1' },
                        { giorno: 4, modulo: 'Settimana 1', argomenti: 'AI per Immagini e Panoramica Ecosistema Social' },
                        { giorno: 5, modulo: 'Settimana 2', argomenti: 'Content Creation Visual con Canva' },
                        { giorno: 6, modulo: 'Settimana 2', argomenti: 'Video Editing Base e Reel con Canva' },
                        { giorno: 7, modulo: 'Settimana 2', argomenti: 'Copywriting e Caption con AI' },
                        { giorno: 8, modulo: 'Settimana 2', argomenti: 'Instagram Marketing Operativo' },
                        { giorno: 9, modulo: 'Settimana 2', argomenti: 'LinkedIn Marketing e B2B' },
                        { giorno: 10, modulo: 'Settimana 3', argomenti: 'Strategia Editoriale e Planning' },
                        { giorno: 11, modulo: 'Settimana 3', argomenti: 'Analytics e Ottimizzazione' },
                        { giorno: 12, modulo: 'Settimana 3', argomenti: 'Facebook, TikTok, YouTube (Panoramica)' },
                        { giorno: 13, modulo: 'Settimana 3', argomenti: 'Project Work Finale e Portfolio' },
                    ]
                }
            };

            const caricaTemplate = (key) => {
                const template = templates[key];
                setTemplateSelezionato(key);
                setParametri({
                    ...parametri,
                    nomeCorso: template.nome,
                    oreTotali: template.oreTotali,
                    oreGiorno: template.oreGiorno,
                    orarioInizio: template.orarioInizio,
                    orarioFine: template.orarioFine,
                    tipoDefault: template.tipoDefault || 'presenza',
                });
                setProgramma([...template.programma]);
            };

            // üéØ NUOVA LOGICA: Genera automaticamente le lezioni quando la distribuzione √® definita
            useEffect(() => {
                // Solo per corso personalizzato
                if (templateSelezionato !== 'custom') return;
                
                // Solo se ci sono ore totali e ore giorno valide
                if (parametri.oreTotali === 0 || parametri.oreGiorno === 0) return;

                // ‚ö†Ô∏è VINCOLO: Ore giorno deve essere tra 3 e 7
                if (parametri.oreGiorno < 3 || parametri.oreGiorno > 7) {
                    setProgramma([]);
                    return;
                }

                const opzioni = calcolaOpzioniDistribuzione();
                
                // CASO 1: Distribuzione perfetta (nessun resto)
                if (opzioni.length === 0) {
                    const numGiorni = Math.floor(parametri.oreTotali / parametri.oreGiorno);
                    generaLezioniVuote(numGiorni);
                    return;
                }

                // CASO 2: C'√® resto, ma nessuna distribuzione scelta ancora
                if (distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta === null) {
                    // Non generare ancora le lezioni
                    setProgramma([]);
                    return;
                }

                // CASO 3: Distribuzione automatica scelta
                if (distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta !== null) {
                    const arrayOre = getArrayOreGiornate();
                    // Verifica che tutte le ore rispettino i vincoli
                    const oreNonValide = arrayOre.find(ore => ore < 3 || ore > 7);
                    if (oreNonValide) {
                        setProgramma([]);
                        return;
                    }
                    generaLezioniVuote(arrayOre.length);
                    return;
                }

                // CASO 4: Distribuzione personalizzata
                if (distribuzioneOre.modalita === 'personalizzata') {
                    const totalePersonalizzato = getOrePersonalizzateTotali();
                    // Genera lezioni solo se la distribuzione √® valida
                    if (totalePersonalizzato === parametri.oreTotali && isDistribuzionePersonalizzataValida()) {
                        const arrayOre = getArrayOreGiornate();
                        // Verifica che tutte le ore rispettino i vincoli
                        const oreNonValide = arrayOre.find(ore => ore < 3 || ore > 7);
                        if (oreNonValide) {
                            setProgramma([]);
                            return;
                        }
                        generaLezioniVuote(arrayOre.length);
                    } else {
                        // Distribuzione non valida, non generare lezioni
                        setProgramma([]);
                    }
                }
            }, [templateSelezionato, parametri.oreTotali, parametri.oreGiorno, distribuzioneOre]);

            const generaLezioniVuote = (numLezioni) => {
                // Non rigenerare se il numero √® lo stesso
                if (programma.length === numLezioni) return;

                const arrayOreGiornate = getArrayOreGiornate();
                const nuoveProgramma = [];
                for (let i = 0; i < numLezioni; i++) {
                    const oreGiorno = arrayOreGiornate[i] || parametri.oreGiorno;

                    let orarioInizio = parametri.orarioInizio;
                    let orarioFine;
                    let pausaInizio = '';
                    let pausaFine = '';

                    // Per lezioni da 7 ore, preimposta 09:00-17:00 con pausa 13:00-14:00
                    if (oreGiorno === 7) {
                        orarioInizio = '09:00';
                        orarioFine = '17:00';
                        pausaInizio = '13:00';
                        pausaFine = '14:00';
                    } else {
                        // Calcola orario fine per altre durate
                        const [oreInizio, minInizio] = parametri.orarioInizio.split(':').map(Number);
                        const minutiInizio = oreInizio * 60 + minInizio;
                        const minutiFine = minutiInizio + (oreGiorno * 60);
                        const oreFine = Math.floor(minutiFine / 60);
                        const minFine = minutiFine % 60;
                        orarioFine = `${String(oreFine).padStart(2, '0')}:${String(minFine).padStart(2, '0')}`;
                    }

                    nuoveProgramma.push({
                        giorno: i + 1,
                        modulo: '',
                        argomenti: '',
                        tipoLezione: parametri.tipoDefault || 'presenza',
                        oreGiornata: oreGiorno,
                        fasciaOraria: 'default',
                        orarioInizio: orarioInizio,
                        orarioFine: orarioFine,
                        pausaInizio: pausaInizio,
                        pausaFine: pausaFine
                    });
                }
                setProgramma(nuoveProgramma);
            };

            const aggiungiLezione = () => {
                setProgramma([...programma, {
                    giorno: programma.length + 1,
                    modulo: '',
                    argomenti: '',
                    tipoLezione: parametri.tipoDefault || 'presenza',
                    oreGiornata: null,
                    fasciaOraria: 'default',
                    orarioInizio: '',
                    orarioFine: '',
                    pausaInizio: '',
                    pausaFine: ''
                }]);
            };

            const rimuoviLezione = (index) => {
                const nuovoProgramma = programma.filter((_, i) => i !== index);
                nuovoProgramma.forEach((item, i) => item.giorno = i + 1);
                setProgramma(nuovoProgramma);
            };

            // Funzione per calcolare ore da orari e pausa
            const calcolaOreGiornata = (orarioInizio, orarioFine, pausaInizio, pausaFine) => {
                if (!orarioInizio || !orarioFine) return null;

                const [oreI, minI] = orarioInizio.split(':').map(Number);
                const [oreF, minF] = orarioFine.split(':').map(Number);
                let minutiTotali = (oreF * 60 + minF) - (oreI * 60 + minI);

                // Sottrai pausa se presente
                if (pausaInizio && pausaFine) {
                    const [orePI, minPI] = pausaInizio.split(':').map(Number);
                    const [orePF, minPF] = pausaFine.split(':').map(Number);
                    const minutiPausa = (orePF * 60 + minPF) - (orePI * 60 + minPI);
                    minutiTotali -= minutiPausa;
                }

                return (minutiTotali / 60).toFixed(1);
            };

            const aggiornaLezione = (index, campo, valore) => {
                const nuovoProgramma = [...programma];
                nuovoProgramma[index][campo] = valore;

                // Ricalcola ore giornata quando cambiano orari o pausa
                if (['orarioInizio', 'orarioFine', 'pausaInizio', 'pausaFine'].includes(campo)) {
                    const lezione = nuovoProgramma[index];
                    const ore = calcolaOreGiornata(
                        lezione.orarioInizio,
                        lezione.orarioFine,
                        lezione.pausaInizio,
                        lezione.pausaFine
                    );
                    if (ore !== null) {
                        nuovoProgramma[index].oreGiornata = parseFloat(ore);
                    }
                }

                setProgramma(nuovoProgramma);
            };

            // Funzione per calcolare il totale ore del programma
            const calcolaTotaleOreProgramma = () => {
                return programma.reduce((totale, lezione) => {
                    return totale + (lezione.oreGiornata || 0);
                }, 0);
            };

            const aggiungiEsclusione = () => {
                if (tipoEsclusione === 'singola') {
                    if (!dataEsclusione) {
                        alert('Inserisci una data');
                        return;
                    }
                    setEsclusioni([...esclusioni, {
                        tipo: 'singola',
                        data: dataEsclusione,
                        motivo: motivoEsclusione || 'Chiusura',
                        id: Date.now()
                    }]);
                    setDataEsclusione('');
                } else {
                    if (!dataInizioPeriodo || !dataFinePeriodo) {
                        alert('Inserisci entrambe le date del periodo');
                        return;
                    }
                    if (new Date(dataInizioPeriodo) > new Date(dataFinePeriodo)) {
                        alert('La data di inizio deve essere precedente alla data di fine');
                        return;
                    }
                    setEsclusioni([...esclusioni, {
                        tipo: 'periodo',
                        dataInizio: dataInizioPeriodo,
                        dataFine: dataFinePeriodo,
                        motivo: motivoEsclusione || 'Chiusura',
                        id: Date.now()
                    }]);
                    setDataInizioPeriodo('');
                    setDataFinePeriodo('');
                }
                setMotivoEsclusione('');
            };

            const rimuoviEsclusione = (id) => {
                setEsclusioni(esclusioni.filter(e => e.id !== id));
            };

            const isDataEsclusa = (data) => {
                const dataStr = data.toISOString().split('T')[0];
                
                // Controlla festivit√†
                if (festivitaItaliane2026.some(f => f.data === dataStr)) {
                    return true;
                }
                
                // Controlla esclusioni personalizzate
                for (const escl of esclusioni) {
                    if (escl.tipo === 'singola' && escl.data === dataStr) {
                        return true;
                    }
                    if (escl.tipo === 'periodo') {
                        const dataCheck = new Date(dataStr);
                        const inizio = new Date(escl.dataInizio);
                        const fine = new Date(escl.dataFine);
                        if (dataCheck >= inizio && dataCheck <= fine) {
                            return true;
                        }
                    }
                }
                
                return false;
            };

            const calcolaGiorniLavorativi = (dataInizio, dataFine, giorni) => {
                let count = 0;
                let current = new Date(dataInizio);
                const fine = new Date(dataFine);
                
                while (current <= fine) {
                    const dayOfWeek = current.getDay();
                    const dayNum = dayOfWeek === 0 ? 7 : dayOfWeek;
                    
                    if (giorni.includes(dayNum) && !isDataEsclusa(current)) {
                        count++;
                    }
                    current.setDate(current.getDate() + 1);
                }
                return count;
            };

            const getFestivitaNelPeriodo = () => {
                if (!parametri.dataInizio || !parametri.dataFine) return [];
                
                const inizio = new Date(parametri.dataInizio);
                const fine = new Date(parametri.dataFine);
                
                return festivitaItaliane2026.filter(f => {
                    const dataFest = new Date(f.data);
                    return dataFest >= inizio && dataFest <= fine;
                });
            };

            const calcolaCorsi = () => {
                if (!parametri.dataInizio || !parametri.dataFine) {
                    alert('Inserisci le date di inizio e fine periodo');
                    return;
                }

                if (programma.length === 0) {
                    alert('Aggiungi almeno una lezione al programma');
                    return;
                }

                // Validazione ore giorno
                if (parametri.oreGiorno < 3 || parametri.oreGiorno > 7) {
                    alert('‚ö†Ô∏è VINCOLO: Le lezioni devono essere tra 3h e 7h. Correggi "Ore al Giorno".');
                    return;
                }

                // Validazione distribuzione ore personalizzata
                const opzioni = calcolaOpzioniDistribuzione();
                if (opzioni.length > 0 && distribuzioneOre.modalita === 'personalizzata') {
                    const totalePersonalizzato = getOrePersonalizzateTotali();
                    if (totalePersonalizzato !== parametri.oreTotali) {
                        alert(`Attenzione: la distribuzione personalizzata ha ${totalePersonalizzato} ore, ma il corso richiede ${parametri.oreTotali} ore. Correggi la distribuzione.`);
                        return;
                    }
                    
                    // Verifica che non ci siano giorni con ore fuori vincoli (gi√† garantito da interfaccia)
                    if (!isDistribuzionePersonalizzataValida()) {
                        alert('‚ö†Ô∏è VINCOLO: Tutte le lezioni devono essere tra 3h e 7h.');
                        return;
                    }
                }

                // Validazione che l'array ore rispetti i vincoli
                const arrayOre = getArrayOreGiornate();
                const oreNonValide = arrayOre.find(ore => ore < 3 || ore > 7);
                if (oreNonValide) {
                    alert(`‚ö†Ô∏è VINCOLO: Trovata lezione da ${oreNonValide}h. Tutte le lezioni devono essere tra 3h e 7h. Controlla la distribuzione.`);
                    return;
                }

                const giorniNecessari = arrayOre.length;
                const giorniDisponibili = calcolaGiorniLavorativi(parametri.dataInizio, parametri.dataFine, parametri.giorni);
                const corsiPerDocente = Math.floor(giorniDisponibili / giorniNecessari);
                const corsiTotali = corsiPerDocente * parametri.numeroDocenti;

                setRisultati({
                    giorniNecessari,
                    giorniDisponibili,
                    corsiPerDocente,
                    corsiTotali,
                    festivita: getFestivitaNelPeriodo().length,
                    esclusioni: esclusioni.length
                });

                generaCalendari(corsiTotali, giorniNecessari);
            };

            // Funzione per calcolare orari e ore in base ai parametri del modulo
            const calcolaOrariLezione = (prog, arrayOreGiornate, giorniContati) => {
                // Usa ore giornata dal programma (gi√† calcolate automaticamente)
                const oreGiornata = prog.oreGiornata || arrayOreGiornate[giorniContati] || parametri.oreGiorno;

                // Determina orari
                let orario;

                // Se il programma ha orari impostati, usali
                if (prog.orarioInizio && prog.orarioFine) {
                    // Se c'√® una pausa, genera orario con pausa
                    if (prog.pausaInizio && prog.pausaFine) {
                        orario = `${prog.orarioInizio}-${prog.pausaInizio} / ${prog.pausaFine}-${prog.orarioFine}`;
                    } else {
                        // Orario continuo
                        orario = `${prog.orarioInizio} - ${prog.orarioFine}`;
                    }
                } else {
                    // Default: calcola da parametri globali
                    if (oreGiornata === 7) {
                        orario = "09:00-13:00 / 14:00-17:00";
                    } else {
                        const [oreInizio, minutiInizio] = parametri.orarioInizio.split(':').map(Number);
                        const minutiTotaliInizio = oreInizio * 60 + minutiInizio;
                        const minutiTotaliFine = minutiTotaliInizio + (oreGiornata * 60);
                        const oreFine = Math.floor(minutiTotaliFine / 60);
                        const minutiFine = minutiTotaliFine % 60;
                        const orarioFine = `${String(oreFine).padStart(2, '0')}:${String(minutiFine).padStart(2, '0')}`;
                        orario = `${parametri.orarioInizio} - ${orarioFine}`;
                    }
                }

                return { orario, ore: oreGiornata };
            };

            const generaCalendari = (numCorsi, giorniNecessari) => {
                const calendariGenerati = [];
                const arrayOreGiornate = getArrayOreGiornate();
                
                for (let docente = 1; docente <= parametri.numeroDocenti; docente++) {
                    let dataDocenteInizio = new Date(parametri.dataInizio);
                    
                    for (let corso = 1; corso <= Math.floor(numCorsi / parametri.numeroDocenti); corso++) {
                        const lezioni = [];
                        let dataLezione = new Date(dataDocenteInizio);
                        let giorniContati = 0;

                        while (giorniContati < giorniNecessari && giorniContati < programma.length) {
                            const dayOfWeek = dataLezione.getDay();
                            const dayNum = dayOfWeek === 0 ? 7 : dayOfWeek;
                            
                            if (parametri.giorni.includes(dayNum) && !isDataEsclusa(dataLezione)) {
                                const prog = programma[giorniContati];

                                // Usa la nuova funzione per calcolare orari e ore in base ai parametri del modulo
                                const { orario, ore } = calcolaOrariLezione(prog, arrayOreGiornate, giorniContati);

                                lezioni.push({
                                    data: new Date(dataLezione),
                                    giorno: ['Domenica', 'Luned√¨', 'Marted√¨', 'Mercoled√¨', 'Gioved√¨', 'Venerd√¨', 'Sabato'][dataLezione.getDay()],
                                    orario: orario,
                                    ore: ore,
                                    modulo: prog.modulo,
                                    argomenti: prog.argomenti,
                                    tipoLezione: prog.tipoLezione || 'default'
                                });
                                giorniContati++;
                            }
                            dataLezione.setDate(dataLezione.getDate() + 1);
                        }

                        if (lezioni.length === giorniNecessari) {
                            calendariGenerati.push({
                                nome: `CORSO ${corso}${String.fromCharCode(64 + docente)} - ${getNomeDocente(docente)}`,
                                dataInizio: new Date(lezioni[0].data),
                                dataFine: new Date(lezioni[lezioni.length - 1].data),
                                lezioni,
                            });
                        }

                        dataDocenteInizio = new Date(dataLezione);
                    }
                }

                setCalendari(calendariGenerati);
            };

            const esportaExcel = async () => {
                const workbook = new ExcelJS.Workbook();
                
                calendari.forEach((calendario, idx) => {
                    const worksheet = workbook.addWorksheet(calendario.nome.substring(0, 31));
                    
                    // Titolo (riga 1)
                    worksheet.mergeCells('A1:G1');
                    const titleCell = worksheet.getCell('A1');
                    titleCell.value = calendario.nome;
                    titleCell.font = { bold: true, size: 14, color: { argb: 'FFFFFFFF' } };
                    titleCell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFFC7E15' }
                    };
                    titleCell.alignment = { vertical: 'middle', horizontal: 'left' };
                    worksheet.getRow(1).height = 25;

                    // Sottotitolo (riga 2)
                    worksheet.mergeCells('A2:G2');
                    const subtitleCell = worksheet.getCell('A2');
                    subtitleCell.value = `Periodo: ${calendario.dataInizio.toLocaleDateString('it-IT')} - ${parametri.nomeCorso} (${parametri.oreTotali} Ore)`;
                    subtitleCell.font = { size: 11, color: { argb: 'FF374151' } };
                    subtitleCell.alignment = { vertical: 'middle', horizontal: 'left' };
                    worksheet.getRow(2).height = 20;
                    
                    // Riga vuota (riga 3)
                    worksheet.getRow(3).height = 10;
                    
                    // Header (riga 4)
                    const headerRow = worksheet.getRow(4);
                    const headers = ['Data', 'Giorno', 'Orario', 'Ore', 'Tipo', 'Modulo', 'Argomenti'];
                    headers.forEach((header, colIdx) => {
                        const cell = headerRow.getCell(colIdx + 1);
                        cell.value = header;
                        cell.font = { bold: true, size: 11, color: { argb: 'FFFFFFFF' } };
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFFC7E15' }
                        };
                        cell.alignment = { vertical: 'middle', horizontal: 'center' };
                        cell.border = {
                            top: { style: 'thin', color: { argb: 'FF000000' } },
                            bottom: { style: 'thin', color: { argb: 'FF000000' } },
                            left: { style: 'thin', color: { argb: 'FF000000' } },
                            right: { style: 'thin', color: { argb: 'FF000000' } }
                        };
                    });
                    headerRow.height = 25;
                    
                    // Righe dati (a partire da riga 5)
                    calendario.lezioni.forEach((lezione, lezioneIdx) => {
                        const rowNum = lezioneIdx + 5;
                        const row = worksheet.getRow(rowNum);
                        const isEven = lezioneIdx % 2 === 0;
                        const bgColor = isEven ? 'FFFFFFFF' : 'FFF9FAFB';

                        // Ottieni orari modificati o originali
                        const orari = getOrarioLezione(idx, lezioneIdx, lezione);
                        // Usa l'orario originale che include la pausa formattata correttamente
                        const orarioCompleto = lezione.orario;

                        const rowData = [
                            lezione.data.toLocaleDateString('it-IT'),
                            lezione.giorno,
                            orarioCompleto,
                            orari.ore,
                            lezione.tipoLezione === 'online' ? 'Online' : 'Presenza',
                            lezione.modulo,
                            lezione.argomenti
                        ];
                        
                        rowData.forEach((value, colIdx) => {
                            const cell = row.getCell(colIdx + 1);
                            cell.value = value;
                            cell.fill = {
                                type: 'pattern',
                                pattern: 'solid',
                                fgColor: { argb: bgColor }
                            };
                            cell.alignment = {
                                vertical: 'top',
                                horizontal: (colIdx === 3 || colIdx === 4) ? 'center' : 'left',
                                wrapText: colIdx === 6
                            };
                            cell.border = {
                                top: { style: 'thin', color: { argb: 'FFE5E7EB' } },
                                bottom: { style: 'thin', color: { argb: 'FFE5E7EB' } },
                                left: { style: 'thin', color: { argb: 'FFE5E7EB' } },
                                right: { style: 'thin', color: { argb: 'FFE5E7EB' } }
                            };
                        });
                        
                        row.height = 30;
                    });
                    
                    // Riga TOTALE (ultima riga)
                    const totaleRowNum = calendario.lezioni.length + 5;
                    const totaleRow = worksheet.getRow(totaleRowNum);
                    const totaleOreCalendario = calcolaTotaleOreCalendario(idx);

                    ['', '', 'TOTALE ORE:', totaleOreCalendario, '', ''].forEach((value, colIdx) => {
                        const cell = totaleRow.getCell(colIdx + 1);
                        cell.value = value;
                        cell.font = { bold: true, size: 11 };
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFF3F4F6' }
                        };
                        cell.alignment = { vertical: 'middle', horizontal: colIdx === 2 ? 'right' : (colIdx === 3 ? 'center' : 'left') };
                        cell.border = {
                            top: { style: 'thin', color: { argb: 'FF000000' } },
                            bottom: { style: 'thin', color: { argb: 'FF000000' } },
                            left: { style: 'thin', color: { argb: 'FF000000' } },
                            right: { style: 'thin', color: { argb: 'FF000000' } }
                        };
                    });
                    totaleRow.height = 25;
                    
                    // Dimensioni colonne
                    worksheet.getColumn(1).width = 12;
                    worksheet.getColumn(2).width = 12;
                    worksheet.getColumn(3).width = 15;
                    worksheet.getColumn(4).width = 8;
                    worksheet.getColumn(5).width = 12;
                    worksheet.getColumn(6).width = 20;
                    worksheet.getColumn(7).width = 60;
                });
                
                const buffer = await workbook.xlsx.writeBuffer();
                const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                const filename = `Calendari_${parametri.nomeCorso.replace(/\s+/g, '_')}_2026.xlsx`;
                saveAs(blob, filename);
            };

            const toggleEspansioneCalendario = (indice) => {
                if (calendariEspansi.includes(indice)) {
                    setCalendariEspansi(calendariEspansi.filter(i => i !== indice));
                } else {
                    setCalendariEspansi([...calendariEspansi, indice]);
                }
            };

            // Funzione per calcolare ore dalla differenza tra orari
            const calcolaOreDaOrari = (orarioInizio, orarioFine) => {
                if (!orarioInizio || !orarioFine) return 0;
                const [oreI, minI] = orarioInizio.split(':').map(Number);
                const [oreF, minF] = orarioFine.split(':').map(Number);
                const minutiInizio = oreI * 60 + minI;
                const minutiFine = oreF * 60 + minF;
                return ((minutiFine - minutiInizio) / 60).toFixed(1);
            };

            // Funzione per modificare l'orario di una lezione
            const modificaOrarioLezione = (calendarioIdx, lezioneIdx, campo, valore) => {
                const chiave = `${calendarioIdx}-${lezioneIdx}`;
                const modificaCorrente = modificheOrari[chiave] || {};

                const nuovaModifica = {
                    ...modificaCorrente,
                    [campo]: valore
                };

                // Calcola le ore se abbiamo entrambi gli orari
                if (nuovaModifica.orarioInizio && nuovaModifica.orarioFine) {
                    nuovaModifica.ore = calcolaOreDaOrari(nuovaModifica.orarioInizio, nuovaModifica.orarioFine);
                }

                setModificheOrari({
                    ...modificheOrari,
                    [chiave]: nuovaModifica
                });
            };

            // Funzione per ottenere l'orario di una lezione (modificato o originale)
            const getOrarioLezione = (calendarioIdx, lezioneIdx, lezione) => {
                const chiave = `${calendarioIdx}-${lezioneIdx}`;
                const modifica = modificheOrari[chiave];

                if (modifica && modifica.orarioInizio && modifica.orarioFine) {
                    return {
                        orarioInizio: modifica.orarioInizio,
                        orarioFine: modifica.orarioFine,
                        ore: parseFloat(modifica.ore)
                    };
                }

                // Parsing orario originale
                let orarioInizio, orarioFine;
                if (lezione.orario.includes('/')) {
                    // Formato con pausa: "09:00-13:00 / 14:00-17:00"
                    const parti = lezione.orario.split(' / ');
                    orarioInizio = parti[0].split('-')[0].trim();
                    orarioFine = parti[1].split('-')[1].trim();
                } else {
                    // Formato continuo: "09:00 - 14:00"
                    const parti = lezione.orario.split(' - ');
                    orarioInizio = parti[0].trim();
                    orarioFine = parti[1].trim();
                }

                return {
                    orarioInizio,
                    orarioFine,
                    ore: lezione.ore
                };
            };

            // Funzione per calcolare il totale ore di un calendario
            const calcolaTotaleOreCalendario = (calendarioIdx) => {
                const calendario = calendari[calendarioIdx];
                if (!calendario) return 0;

                return calendario.lezioni.reduce((totale, lezione, lezioneIdx) => {
                    const orari = getOrarioLezione(calendarioIdx, lezioneIdx, lezione);
                    return totale + orari.ore;
                }, 0);
            };

            const aggiornaNumeroDocenti = (numero) => {
                setParametri({ ...parametri, numeroDocenti: numero });
                const nuoviNomi = [...nomiDocenti];
                while (nuoviNomi.length < numero) {
                    nuoviNomi.push('');
                }
                setNomiDocenti(nuoviNomi.slice(0, numero));
            };

            const aggiornaNomeDocente = (index, nome) => {
                const nuoviNomi = [...nomiDocenti];
                nuoviNomi[index] = nome;
                setNomiDocenti(nuoviNomi);
            };

            const getNomeDocente = (index) => {
                return nomiDocenti[index - 1] || `Docente ${index}`;
            };

            // Calcola opzioni automatiche per distribuzione ore
            // VINCOLI: MIN 3h, MAX 7h per ogni lezione
            const calcolaOpzioniDistribuzione = () => {
                const totale = parametri.oreTotali;
                const giornata = parametri.oreGiorno;
                
                if (totale === 0 || giornata === 0) return [];
                
                // Verifica che ore giorno rispetti i vincoli
                if (giornata < 3 || giornata > 7) {
                    return []; // Ore giorno non valide
                }
                
                const giorniCompleti = Math.floor(totale / giornata);
                const resto = totale % giornata;
                
                if (resto === 0) {
                    return []; // Distribuzione perfetta, nessuna opzione da mostrare
                }
                
                // ‚ö†Ô∏è VINCOLO: resto < 3h NON √® valido, devo redistribuire
                const opzioni = [];
                
                // Strategia 1: Se resto < 3h, riduco i giorni completi e redistribuisco
                if (resto < 3) {
                    // Es: 50h √∑ 7h = 7 giorni + 1h ‚Üí riduco a 6 giorni da 7h + (1h+7h=8h) da redistribuire
                    const oreRimanenti = resto + giornata;
                    const giorniCompletiFix = giorniCompleti - 1;
                    
                    // Opzione A: 2 giorni da 4h (se possibile)
                    if (oreRimanenti === 8) {
                        opzioni.push({
                            descrizione: `${giorniCompletiFix} giorni da ${giornata}h + 2 giorni da 4h`,
                            dettaglio: `${giorniCompletiFix}√ó${giornata}h + 2√ó4h = ${totale}h`,
                            distribuzione: {
                                [giornata]: giorniCompletiFix,
                                4: 2
                            }
                        });
                    }
                    
                    // Opzione B: Combinazioni con 3h, 4h, 5h, 6h
                    for (let ore1 = 7; ore1 >= 3; ore1--) {
                        for (let ore2 = 7; ore2 >= 3; ore2--) {
                            if (ore1 + ore2 === oreRimanenti && ore1 >= ore2) {
                                const desc = ore1 === ore2 
                                    ? `${giorniCompletiFix} giorni da ${giornata}h + 2 giorni da ${ore1}h`
                                    : `${giorniCompletiFix} giorni da ${giornata}h + 1 giorno da ${ore1}h + 1 giorno da ${ore2}h`;
                                const det = ore1 === ore2
                                    ? `${giorniCompletiFix}√ó${giornata}h + 2√ó${ore1}h = ${totale}h`
                                    : `${giorniCompletiFix}√ó${giornata}h + 1√ó${ore1}h + 1√ó${ore2}h = ${totale}h`;
                                
                                const distribuzione = { [giornata]: giorniCompletiFix };
                                if (ore1 === ore2) {
                                    distribuzione[ore1] = 2;
                                } else {
                                    distribuzione[ore1] = 1;
                                    distribuzione[ore2] = 1;
                                }
                                
                                // Evita duplicati
                                if (!opzioni.some(o => o.descrizione === desc)) {
                                    opzioni.push({ descrizione: desc, dettaglio: det, distribuzione });
                                }
                                
                                if (opzioni.length >= 3) break;
                            }
                        }
                        if (opzioni.length >= 3) break;
                    }
                    
                    // Opzione C: Distribuire su pi√π giorni da 3h
                    const giorniDa3 = Math.ceil(oreRimanenti / 3);
                    if (giorniDa3 >= 2 && giorniDa3 * 3 <= oreRimanenti + 2) {
                        const oreUltimo = oreRimanenti - ((giorniDa3 - 1) * 3);
                        if (oreUltimo >= 3 && oreUltimo <= 7) {
                            opzioni.push({
                                descrizione: `${giorniCompletiFix} giorni da ${giornata}h + ${giorniDa3} giorni da 3h`,
                                dettaglio: `${giorniCompletiFix}√ó${giornata}h + ${giorniDa3}√ó3h = ${totale}h`,
                                distribuzione: {
                                    [giornata]: giorniCompletiFix,
                                    3: giorniDa3
                                }
                            });
                        }
                    }
                    
                } else {
                    // Resto >= 3h, possiamo lavorare con questo
                    
                    // Opzione 1: Distribuire resto su giornate da 4h (se resto >= 4)
                    if (resto >= 4) {
                        const giorniResto4 = Math.floor(resto / 4);
                        const restoFinale = resto % 4;
                        
                        if (restoFinale === 0) {
                            // Perfetto, solo giorni da 4h
                            opzioni.push({
                                descrizione: `${giorniCompleti} giorni da ${giornata}h + ${giorniResto4} giorni da 4h`,
                                dettaglio: `${giorniCompleti}√ó${giornata}h + ${giorniResto4}√ó4h = ${totale}h`,
                                distribuzione: {
                                    [giornata]: giorniCompleti,
                                    4: giorniResto4
                                }
                            });
                        } else if (restoFinale >= 3) {
                            // giorniResto4 giorni da 4h + 1 giorno da restoFinale
                            opzioni.push({
                                descrizione: `${giorniCompleti} giorni da ${giornata}h + ${giorniResto4} giorni da 4h + 1 giorno da ${restoFinale}h`,
                                dettaglio: `${giorniCompleti}√ó${giornata}h + ${giorniResto4}√ó4h + 1√ó${restoFinale}h = ${totale}h`,
                                distribuzione: {
                                    [giornata]: giorniCompleti,
                                    4: giorniResto4,
                                    [restoFinale]: 1
                                }
                            });
                        }
                    }
                    
                    // Opzione 2: Distribuire resto su giornate da 3h
                    const giorniResto3 = Math.ceil(resto / 3);
                    opzioni.push({
                        descrizione: `${giorniCompleti} giorni da ${giornata}h + ${giorniResto3} giorni da 3h`,
                        dettaglio: `${giorniCompleti}√ó${giornata}h + ${giorniResto3}√ó3h = ${totale}h`,
                        distribuzione: {
                            [giornata]: giorniCompleti,
                            3: giorniResto3
                        }
                    });
                    
                    // Opzione 3: Redistribuire riducendo ore giornata
                    if (giornata >= 5) {
                        const giorniMeno = Math.floor(resto / 2);
                        const nuoviCompleti = giorniCompleti - giorniMeno;
                        const nuoveOre = giornata - 2;
                        if (nuoviCompleti > 0 && nuoveOre >= 3) {
                            const giorniNuoveOre = giorniMeno * 2;
                            if (nuoviCompleti * giornata + giorniNuoveOre * nuoveOre === totale) {
                                opzioni.push({
                                    descrizione: `${nuoviCompleti} giorni da ${giornata}h + ${giorniNuoveOre} giorni da ${nuoveOre}h`,
                                    dettaglio: `${nuoviCompleti}√ó${giornata}h + ${giorniNuoveOre}√ó${nuoveOre}h = ${totale}h`,
                                    distribuzione: {
                                        [giornata]: nuoviCompleti,
                                        [nuoveOre]: giorniNuoveOre
                                    }
                                });
                            }
                        }
                    }
                }
                
                return opzioni.slice(0, 3); // Max 3 opzioni
            };

            const getOrePersonalizzateTotali = () => {
                const p = distribuzioneOre.personalizzata;
                return (p.ore7 * 7) + (p.ore6 * 6) + (p.ore5 * 5) + (p.ore4 * 4) + (p.ore3 * 3);
            };

            const aggiornaDistribuzionePersonalizzata = (ore, valore) => {
                setDistribuzioneOre({
                    ...distribuzioneOre,
                    personalizzata: {
                        ...distribuzioneOre.personalizzata,
                        [ore]: parseInt(valore) || 0
                    }
                });
            };

            // Valida che la distribuzione personalizzata rispetti i vincoli 3-7h
            const isDistribuzionePersonalizzataValida = () => {
                const p = distribuzioneOre.personalizzata;
                const totalePersonalizzato = getOrePersonalizzateTotali();
                
                // Deve essere uguale al totale corso
                if (totalePersonalizzato !== parametri.oreTotali) {
                    return false;
                }
                
                // Tutti i valori devono essere >= 0
                if (p.ore7 < 0 || p.ore6 < 0 || p.ore5 < 0 || p.ore4 < 0 || p.ore3 < 0) {
                    return false;
                }
                
                return true;
            };

            // Ottiene array di ore per ogni giornata basato sulla distribuzione scelta
            const getArrayOreGiornate = () => {
                const opzioni = calcolaOpzioniDistribuzione();
                
                // Se distribuzione perfetta, usa ore standard
                if (opzioni.length === 0) {
                    const numGiorni = Math.floor(parametri.oreTotali / parametri.oreGiorno);
                    return Array(numGiorni).fill(parametri.oreGiorno);
                }
                
                let distribuzione = {};
                
                if (distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta !== null) {
                    // Usa opzione automatica scelta
                    distribuzione = opzioni[distribuzioneOre.opzioneScelta].distribuzione;
                } else if (distribuzioneOre.modalita === 'personalizzata') {
                    // Usa distribuzione personalizzata
                    const p = distribuzioneOre.personalizzata;
                    if (p.ore7 > 0) distribuzione[7] = p.ore7;
                    if (p.ore6 > 0) distribuzione[6] = p.ore6;
                    if (p.ore5 > 0) distribuzione[5] = p.ore5;
                    if (p.ore4 > 0) distribuzione[4] = p.ore4;
                    if (p.ore3 > 0) distribuzione[3] = p.ore3;
                } else {
                    // Nessuna opzione selezionata, usa prima opzione automatica
                    distribuzione = opzioni[0].distribuzione;
                }
                
                // Crea array con ordine: prima 7h, poi 6h, 5h, 4h, 3h
                const arrayOre = [];
                [7, 6, 5, 4, 3].forEach(ore => {
                    if (distribuzione[ore]) {
                        for (let i = 0; i < distribuzione[ore]; i++) {
                            arrayOre.push(ore);
                        }
                    }
                });
                
                return arrayOre;
            };

            return (
                <div>
                    <div className="header">
                        <div className="container">
                            <div className="header-content">
                                <h1>
                                    <svg className="icon-lg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    Generatore Calendari Corsi 2026
                                </h1>
                                <p>SONODIGITALE - Tool per Arianna @ Atoma srl</p>
                            </div>
                            <div style={{display: 'flex', alignItems: 'center', gap: '1rem'}}>
                                <button
                                    onClick={() => setMostraGuida(true)}
                                    className="btn-guida"
                                    title="Apri guida utente"
                                >
                                    <svg style={{width: '20px', height: '20px', marginRight: '0.5rem'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                                    </svg>
                                    Guida
                                </button>
                                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNTAwIiB6b29tQW5kUGFuPSJtYWduaWZ5IiB2aWV3Qm94PSIwIDAgMzc1IDM3NC45OTk5OTEiIGhlaWdodD0iNTAwIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0IiB2ZXJzaW9uPSIxLjAiPjxkZWZzPjxnLz48Y2xpcFBhdGggaWQ9IjI2NjFmYjI5OGUiPjxwYXRoIGQ9Ik0gMTA3IDE0NSBMIDE4MSAxNDUgTCAxODEgMjE4IEwgMTA3IDIxOCBaIE0gMTA3IDE0NSAiIGNsaXAtcnVsZT0ibm9uemVybyIvPjwvY2xpcFBhdGg+PGNsaXBQYXRoIGlkPSI5YmEyMDdiNzU2Ij48cGF0aCBkPSJNIDEwNi4zNTkzNzUgMTQ3LjUzOTA2MiBMIDE3OS40OTIxODggMTQ0LjQ0NTMxMiBMIDE4Mi41MjM0MzggMjE2LjE3NTc4MSBMIDEwOS4zOTA2MjUgMjE5LjI2NTYyNSBaIE0gMTA2LjM1OTM3NSAxNDcuNTM5MDYyICIgY2xpcC1ydWxlPSJub256ZXJvIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9IjdhODU0MmVhOGYiPjxwYXRoIGQ9Ik0gMTQyLjg2NzE4OCAxNDUuOTk2MDk0IEMgMTIyLjcwNzAzMSAxNDYuODQ3NjU2IDEwNy4wMzkwNjIgMTYzLjU5Mzc1IDEwNy44NzUgMTgzLjQwMjM0NCBDIDEwOC43MTQ4NDQgMjAzLjIxMDkzOCAxMjUuNzM4MjgxIDIxOC41NzQyMTkgMTQ1Ljg5ODQzOCAyMTcuNzIyNjU2IEMgMTY2LjA2MjUgMjE2Ljg3MTA5NCAxODEuNzMwNDY5IDIwMC4xMjUgMTgwLjg5MDYyNSAxODAuMzE2NDA2IEMgMTgwLjA1NDY4OCAxNjAuNTA3ODEyIDE2My4wMzEyNSAxNDUuMTQ0NTMxIDE0Mi44NjcxODggMTQ1Ljk5NjA5NCBaIE0gMTQyLjg2NzE4OCAxNDUuOTk2MDk0ICIgY2xpcC1ydWxlPSJub256ZXJvIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9ImE0NTEzMzYyMTkiPjxwYXRoIGQ9Ik0gMCAwIEwgNzQgMCBMIDc0IDczIEwgMCA3MyBaIE0gMCAwICIgY2xpcC1ydWxlPSJub256ZXJvIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9IjcwNGY0MjAzMjQiPjxwYXRoIGQ9Ik0gLTAuNjQwNjI1IDIuNTM5MDYyIEwgNzIuNDkyMTg4IC0wLjU1NDY4OCBMIDc1LjUyMzQzOCA3MS4xNzU3ODEgTCAyLjM5MDYyNSA3NC4yNjU2MjUgWiBNIC0wLjY0MDYyNSAyLjUzOTA2MiAiIGNsaXAtcnVsZT0ibm9uemVybyIvPjwvY2xpcFBhdGg+PGNsaXBQYXRoIGlkPSIxODVhZjg5Mzc1Ij48cGF0aCBkPSJNIDM1Ljg2NzE4OCAwLjk5NjA5NCBDIDE1LjcwNzAzMSAxLjg0NzY1NiAwLjAzOTA2MjUgMTguNTkzNzUgMC44NzUgMzguNDAyMzQ0IEMgMS43MTQ4NDQgNTguMjEwOTM4IDE4LjczODI4MSA3My41NzQyMTkgMzguODk4NDM4IDcyLjcyMjY1NiBDIDU5LjA2MjUgNzEuODcxMDk0IDc0LjczMDQ2OSA1NS4xMjUgNzMuODkwNjI1IDM1LjMxNjQwNiBDIDczLjA1NDY4OCAxNS41MDc4MTIgNTYuMDMxMjUgMC4xNDQ1MzEgMzUuODY3MTg4IDAuOTk2MDk0IFogTSAzNS44NjcxODggMC45OTYwOTQgIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjxjbGlwUGF0aCBpZD0iZTFhYTU3MzlmMCI+PHJlY3QgeD0iMCIgd2lkdGg9Ijc0IiB5PSIwIiBoZWlnaHQ9IjczIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9IjJiYWQyMzc4YmYiPjxwYXRoIGQ9Ik0gMTEyIDE1NiBMIDE1NiAxNTYgTCAxNTYgMjAzIEwgMTEyIDIwMyBaIE0gMTEyIDE1NiAiIGNsaXAtcnVsZT0ibm9uemVybyIvPjwvY2xpcFBhdGg+PGNsaXBQYXRoIGlkPSJiZGFhZjY0YzlhIj48cGF0aCBkPSJNIDExMS43Njk1MzEgMTU3LjQ2NDg0NCBMIDE2Ni40NzI2NTYgMTU1LjE1NjI1IEwgMTY4LjY1NjI1IDIwNi44NTkzNzUgTCAxMTMuOTU3MDMxIDIwOS4xNzE4NzUgWiBNIDExMS43Njk1MzEgMTU3LjQ2NDg0NCAiIGNsaXAtcnVsZT0ibm9uemVybyIvPjwvY2xpcFBhdGg+PGNsaXBQYXRoIGlkPSIxZTU1MDUyY2ZmIj48cGF0aCBkPSJNIDExMS43Njk1MzEgMTU3LjQ2NDg0NCBMIDE2Ni40NzI2NTYgMTU1LjE1NjI1IEwgMTY4LjY1NjI1IDIwNi44NTkzNzUgTCAxMTMuOTU3MDMxIDIwOS4xNzE4NzUgWiBNIDExMS43Njk1MzEgMTU3LjQ2NDg0NCAiIGNsaXAtcnVsZT0ibm9uemVybyIvPjwvY2xpcFBhdGg+PGNsaXBQYXRoIGlkPSI1Y2Y3YzE2ZTQ3Ij48cGF0aCBkPSJNIDExMS43Njk1MzEgMTU3LjQ2NDg0NCBMIDE2Ni40NzI2NTYgMTU1LjE1NjI1IEwgMTY4LjY1NjI1IDIwNi44NTkzNzUgTCAxMTMuOTU3MDMxIDIwOS4xNzE4NzUgWiBNIDExMS43Njk1MzEgMTU3LjQ2NDg0NCAiIGNsaXAtcnVsZT0ibm9uemVybyIvPjwvY2xpcFBhdGg+PGNsaXBQYXRoIGlkPSIxMjE5ZDViOGZmIj48cGF0aCBkPSJNIDE0OCAxODUgTCAxNjkgMTg1IEwgMTY5IDIwOCBMIDE0OCAyMDggWiBNIDE0OCAxODUgIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjxjbGlwUGF0aCBpZD0iOWQxNTk2NDQzMSI+PHBhdGggZD0iTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgTCAxNjYuNDcyNjU2IDE1NS4xNTYyNSBMIDE2OC42NTYyNSAyMDYuODU5Mzc1IEwgMTEzLjk1NzAzMSAyMDkuMTcxODc1IFogTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjxjbGlwUGF0aCBpZD0iYTUwNjU3ZDc2MSI+PHBhdGggZD0iTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgTCAxNjYuNDcyNjU2IDE1NS4xNTYyNSBMIDE2OC42NTYyNSAyMDYuODU5Mzc1IEwgMTEzLjk1NzAzMSAyMDkuMTcxODc1IFogTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjxjbGlwUGF0aCBpZD0iYzU1MzA1ZGNmZCI+PHBhdGggZD0iTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgTCAxNjYuNDcyNjU2IDE1NS4xNTYyNSBMIDE2OC42NTYyNSAyMDYuODU5Mzc1IEwgMTEzLjk1NzAzMSAyMDkuMTcxODc1IFogTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjxjbGlwUGF0aCBpZD0iM2FlZTNhMmRiZSI+PHBhdGggZD0iTSAxNDcuOTA2MjUgMTg2LjE4NzUgTCAxNjcuNzMwNDY5IDE4NS4zNTE1NjIgTCAxNjguNjQwNjI1IDIwNi44NTkzNzUgTCAxNDguODE2NDA2IDIwNy42OTUzMTIgWiBNIDE0Ny45MDYyNSAxODYuMTg3NSAiIGNsaXAtcnVsZT0ibm9uemVybyIvPjwvY2xpcFBhdGg+PGNsaXBQYXRoIGlkPSIzYzMyYmVlMjEyIj48cGF0aCBkPSJNIDE0NSAxNTUgTCAxNjAgMTU1IEwgMTYwIDE3MSBMIDE0NSAxNzEgWiBNIDE0NSAxNTUgIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjxjbGlwUGF0aCBpZD0iMDYzZmVjYTVhMSI+PHBhdGggZD0iTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgTCAxNjYuNDcyNjU2IDE1NS4xNTYyNSBMIDE2OC42NTYyNSAyMDYuODU5Mzc1IEwgMTEzLjk1NzAzMSAyMDkuMTcxODc1IFogTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjxjbGlwUGF0aCBpZD0iMDE1NWQ0MTg4NyI+PHBhdGggZD0iTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgTCAxNjYuNDcyNjU2IDE1NS4xNTYyNSBMIDE2OC42NTYyNSAyMDYuODU5Mzc1IEwgMTEzLjk1NzAzMSAyMDkuMTcxODc1IFogTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjxjbGlwUGF0aCBpZD0iMGQwZGQ4NzJiMiI+PHBhdGggZD0iTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgTCAxNjYuNDcyNjU2IDE1NS4xNTYyNSBMIDE2OC42NTYyNSAyMDYuODU5Mzc1IEwgMTEzLjk1NzAzMSAyMDkuMTcxODc1IFogTSAxMTEuNzY5NTMxIDE1Ny40NjQ4NDQgIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjxjbGlwUGF0aCBpZD0iNWNlN2ZmYzAzMiI+PHBhdGggZD0iTSAxMDYgMTQ0IEwgMTgyIDE0NCBMIDE4MiAyMjAgTCAxMDYgMjIwIFogTSAxMDYgMTQ0ICIgY2xpcC1ydWxlPSJub256ZXJvIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9IjQ2NWUxMjNmNTUiPjxwYXRoIGQ9Ik0gMTA0LjgxMjUgMTQ2LjI4NTE1NiBMIDE3OS43NDIxODggMTQzLjExNzE4OCBMIDE4Mi45MTAxNTYgMjE4LjA1MDc4MSBMIDEwNy45NzY1NjIgMjIxLjIxODc1IFogTSAxMDQuODEyNSAxNDYuMjg1MTU2ICIgY2xpcC1ydWxlPSJub256ZXJvIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9ImNiYjViMDc2MmIiPjxwYXRoIGQ9Ik0gMTA0LjgxMjUgMTQ2LjI4NTE1NiBMIDE3OS43NDIxODggMTQzLjExNzE4OCBMIDE4Mi45MTAxNTYgMjE4LjA1MDc4MSBMIDEwNy45NzY1NjIgMjIxLjIxODc1IFogTSAxMDQuODEyNSAxNDYuMjg1MTU2ICIgY2xpcC1ydWxlPSJub256ZXJvIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9IjAzZWJmOTI0ZDQiPjxwYXRoIGQ9Ik0gMTA0LjgxMjUgMTQ2LjI4NTE1NiBMIDE3OS43NDIxODggMTQzLjExNzE4OCBMIDE4Mi45MTAxNTYgMjE4LjA1MDc4MSBMIDEwNy45NzY1NjIgMjIxLjIxODc1IFogTSAxMDQuODEyNSAxNDYuMjg1MTU2ICIgY2xpcC1ydWxlPSJub256ZXJvIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9ImY4NDc1MTU1OGUiPjxwYXRoIGQ9Ik0gMC4xOTkyMTkgOTEgTCAxIDkxIEwgMSA5MiBMIDAuMTk5MjE5IDkyIFogTSAwLjE5OTIxOSA5MSAiIGNsaXAtcnVsZT0ibm9uemVybyIvPjwvY2xpcFBhdGg+PGNsaXBQYXRoIGlkPSIyOWJmNzJlNDNlIj48cmVjdCB4PSIwIiB3aWR0aD0iMzYwIiB5PSIwIiBoZWlnaHQ9IjExOCIvPjwvY2xpcFBhdGg+PC9kZWZzPjxnIGNsaXAtcGF0aD0idXJsKCMyNjYxZmIyOThlKSI+PGcgY2xpcC1wYXRoPSJ1cmwoIzliYTIwN2I3NTYpIj48ZyBjbGlwLXBhdGg9InVybCgjN2E4NTQyZWE4ZikiPjxnIHRyYW5zZm9ybT0ibWF0cml4KDEsIDAsIDAsIDEsIDEwNywgMTQ1KSI+PGcgY2xpcC1wYXRoPSJ1cmwoI2UxYWE1NzM5ZjApIj48ZyBjbGlwLXBhdGg9InVybCgjYTQ1MTMzNjIxOSkiPjxnIGNsaXAtcGF0aD0idXJsKCM3MDRmNDIwMzI0KSI+PGcgY2xpcC1wYXRoPSJ1cmwoIzE4NWFmODkzNzUpIj48cGF0aCBmaWxsPSIjZmM3ZTE1IiBkPSJNIC0wLjY0MDYyNSAyLjUzOTA2MiBMIDcyLjQ5MjE4OCAtMC41NTQ2ODggTCA3NS41MjM0MzggNzEuMTc1NzgxIEwgMi4zOTA2MjUgNzQuMjY1NjI1IFogTSAtMC42NDA2MjUgMi41MzkwNjIgIiBmaWxsLW9wYWNpdHk9IjEiIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PGcgY2xpcC1wYXRoPSJ1cmwoIzJiYWQyMzc4YmYpIj48ZyBjbGlwLXBhdGg9InVybCgjYmRhYWY2NGM5YSkiPjxnIGNsaXAtcGF0aD0idXJsKCMxZTU1MDUyY2ZmKSI+PGcgY2xpcC1wYXRoPSJ1cmwoIzVjZjdjMTZlNDcpIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNIDEzNS4wMDc4MTIgMjAyLjQ5NjA5NCBDIDEzMi4zNjcxODggMTkwLjMxMjUgMTI1LjQ0MTQwNiAxODIuNzEwOTM4IDExMi43NjE3MTkgMTgwLjUxMTcxOSBDIDEyNS4wNzQyMTkgMTc3LjEwNTQ2OSAxMzEuNTU0Njg4IDE2OS4xNjAxNTYgMTMyLjk0NTMxMiAxNTYuNTcwMzEyIEMgMTM1LjY3MTg3NSAxNjguNjU2MjUgMTQyLjQxNzk2OSAxNzYuNDQxNDA2IDE1NS4wMzkwNjIgMTc4LjcyMjY1NiBDIDE0Mi44NzEwOTQgMTgyLjE0MDYyNSAxMzYuNDg0Mzc1IDE5MC4wNTA3ODEgMTM1LjAwNzgxMiAyMDIuNDk2MDk0ICIgZmlsbC1vcGFjaXR5PSIxIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48L2c+PC9nPjwvZz48L2c+PGcgY2xpcC1wYXRoPSJ1cmwoIzEyMTlkNWI4ZmYpIj48ZyBjbGlwLXBhdGg9InVybCgjOWQxNTk2NDQzMSkiPjxnIGNsaXAtcGF0aD0idXJsKCNhNTA2NTdkNzYxKSI+PGcgY2xpcC1wYXRoPSJ1cmwoI2M1NTMwNWRjZmQpIj48ZyBjbGlwLXBhdGg9InVybCgjM2FlZTNhMmRiZSkiPjxwYXRoIGZpbGw9IiMwMDAwMDAiIGQ9Ik0gMTU4LjgxMjUgMjA3LjI3MzQzOCBDIDE1Ny41NzgxMjUgMjAxLjU3MDMxMiAxNTQuMzM1OTM4IDE5OC4wMTU2MjUgMTQ4LjQwNjI1IDE5Ni45ODgyODEgQyAxNTQuMTY3OTY5IDE5NS4zOTQ1MzEgMTU3LjE5OTIxOSAxOTEuNjc1NzgxIDE1Ny44NTE1NjIgMTg1Ljc4NTE1NiBDIDE1OS4xMjUgMTkxLjQ0MTQwNiAxNjIuMjgxMjUgMTk1LjA4MjAzMSAxNjguMTg3NSAxOTYuMTUyMzQ0IEMgMTYyLjQ5MjE4OCAxOTcuNzUgMTU5LjUwMzkwNiAyMDEuNDQ5MjE5IDE1OC44MTI1IDIwNy4yNzM0MzggIiBmaWxsLW9wYWNpdHk9IjEiIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvZz48L2c+PC9nPjwvZz48L2c+PGcgY2xpcC1wYXRoPSJ1cmwoIzNjMzJiZWUyMTIpIj48ZyBjbGlwLXBhdGg9InVybCgjMDYzZmVjYTVhMSkiPjxnIGNsaXAtcGF0aD0idXJsKCMwMTU1ZDQxODg3KSI+PGcgY2xpcC1wYXRoPSJ1cmwoIzBkMGRkODcyYjIpIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNIDE1Mi44NjcxODggMTcwLjQ1MzEyNSBDIDE1Mi4wMjM0MzggMTY2LjU1NDY4OCAxNDkuODA0Njg4IDE2NC4xMjEwOTQgMTQ1Ljc1IDE2My40MTc5NjkgQyAxNDkuNjg3NSAxNjIuMzI4MTI1IDE1MS43NjE3MTkgMTU5Ljc4NTE1NiAxNTIuMjA3MDMxIDE1NS43NTc4MTIgQyAxNTMuMDgyMDMxIDE1OS42MjUgMTU1LjIzODI4MSAxNjIuMTE3MTg4IDE1OS4yNzczNDQgMTYyLjg0NzY1NiBDIDE1NS4zODI4MTIgMTYzLjk0MTQwNiAxNTMuMzM5ODQ0IDE2Ni40NzI2NTYgMTUyLjg2NzE4OCAxNzAuNDUzMTI1ICIgZmlsbC1vcGFjaXR5PSIxIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48L2c+PC9nPjwvZz48L2c+PGcgY2xpcC1wYXRoPSJ1cmwoIzVjZTdmZmMwMzIpIj48ZyBjbGlwLXBhdGg9InVybCgjNDY1ZTEyM2Y1NSkiPjxnIGNsaXAtcGF0aD0idXJsKCNjYmI1YjA3NjJiKSI+PGcgY2xpcC1wYXRoPSJ1cmwoIzAzZWJmOTI0ZDQpIj48cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNIDE0NS40NDUzMTIgMjE5LjYzMjgxMiBDIDEyNC43NDYwOTQgMjIwLjUwNzgxMiAxMDcuMjY1NjI1IDIwNC4zMzU5MzggMTA2LjM5NDUzMSAxODMuNzUgQyAxMDUuNTIzNDM4IDE2My4xNjc5NjkgMTIxLjU3ODEyNSAxNDUuNTc0MjE5IDE0Mi4yNzczNDQgMTQ0LjcwMzEyNSBDIDE2Mi45NzY1NjIgMTQzLjgyODEyNSAxODAuNDUzMTI1IDE1OS44ODY3MTkgMTgxLjMyODEyNSAxODAuNTg1OTM4IEMgMTgyLjIwMzEyNSAyMDEuMjg1MTU2IDE2Ni4wMjczNDQgMjE4Ljc2NTYyNSAxNDUuNDQ1MzEyIDIxOS42MzI4MTIgWiBNIDE0Mi4zNzUgMTQ3LjAxNTYyNSBDIDEyMi45NDkyMTkgMTQ3LjgzNTkzOCAxMDcuODg2NzE5IDE2NC4yMjY1NjIgMTA4LjcwNzAzMSAxODMuNjUyMzQ0IEMgMTA5LjUyNzM0NCAyMDMuMDgyMDMxIDEyNS45MTc5NjkgMjE4LjE0MDYyNSAxNDUuMzQ3NjU2IDIxNy4zMjAzMTIgQyAxNjQuNzczNDM4IDIxNi41IDE3OS44MzU5MzggMjAwLjEwOTM3NSAxNzkuMDE1NjI1IDE4MC42ODM1OTQgQyAxNzguMTk1MzEyIDE2MS4yNTM5MDYgMTYxLjY4NzUgMTQ2LjE5OTIxOSAxNDIuMzc1IDE0Ny4wMTU2MjUgWiBNIDE0Mi4zNzUgMTQ3LjAxNTYyNSAiIGZpbGwtb3BhY2l0eT0iMSIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvZz48L2c+PC9nPjxnIHRyYW5zZm9ybT0ibWF0cml4KDEsIDAsIDAsIDEsIDcsIDEyOCkiPjxnIGNsaXAtcGF0aD0idXJsKCMyOWJmNzJlNDNlKSI+PGcgY2xpcC1wYXRoPSJ1cmwoI2Y4NDc1MTU1OGUpIj48ZyBmaWxsPSIjMTMxMzEzIiBmaWxsLW9wYWNpdHk9IjEiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuNTg3ODcsIDkxLjQ4MTE3MikiPjxnLz48L2c+PC9nPjwvZz48ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjEiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkuNTQ3NTA4LCA5MS40ODExNzIpIj48Zz48cGF0aCBkPSJNIDIxLjI5Njg3NSAtNTIuMzI4MTI1IEwgMzEuNjA5Mzc1IC01My4yOTY4NzUgQyAzMS42MDkzNzUgLTU1LjMwNDY4OCAzMS40MjU3ODEgLTU3LjQyNTc4MSAzMS4wNjI1IC01OS42NTYyNSBDIDMwLjcwNzAzMSAtNjEuODk0NTMxIDMwLjAxNTYyNSAtNjMuOTg4MjgxIDI4Ljk4NDM3NSAtNjUuOTM3NSBDIDI3Ljk0MTQwNiAtNjcuODEyNSAyNi40NjA5MzggLTY5LjM0NzY1NiAyNC41NDY4NzUgLTcwLjU0Njg3NSBDIDIyLjY0MDYyNSAtNzEuNzUzOTA2IDIwLjA5NzY1NiAtNzIuMzIwMzEyIDE2LjkyMTg3NSAtNzIuMjUgQyAxNC40NTMxMjUgLTcyLjE4NzUgMTIuMzQzNzUgLTcxLjY0ODQzOCAxMC41OTM3NSAtNzAuNjQwNjI1IEMgOC44NDM3NSAtNjkuNjQwNjI1IDcuNDIxODc1IC02OC4zNjMyODEgNi4zMjgxMjUgLTY2LjgxMjUgQyA1LjIyMjY1NiAtNjUuMTg3NSA0LjQyNTc4MSAtNjMuMzgyODEyIDMuOTM3NSAtNjEuNDA2MjUgQyAzLjQ0NTMxMiAtNTkuNDM3NSAzLjIwMzEyNSAtNTcuNDc2NTYyIDMuMjAzMTI1IC01NS41MzEyNSBDIDMuMjAzMTI1IC01My41ODIwMzEgMy40OTIxODggLTUxLjY3MTg3NSA0LjA3ODEyNSAtNDkuNzk2ODc1IEMgNS4xMTcxODggLTQ2LjA5NzY1NiA2LjgzNTkzOCAtNDIuMzk4NDM4IDkuMjM0Mzc1IC0zOC43MDMxMjUgQyAxMC4zOTg0MzggLTM2Ljg5MDYyNSAxMS41MzUxNTYgLTM1LjE3MTg3NSAxMi42NDA2MjUgLTMzLjU0Njg3NSBDIDEzLjc0MjE4OCAtMzEuOTI5Njg4IDE0LjgxNjQwNiAtMzAuMzc4OTA2IDE1Ljg1OTM3NSAtMjguODkwNjI1IEMgMTYuMzY3MTg4IC0yOC4xNzE4NzUgMTYuODMyMDMxIC0yNy40NTMxMjUgMTcuMjUgLTI2LjczNDM3NSBDIDE3LjY3NTc4MSAtMjYuMDIzNDM4IDE4LjExNzE4OCAtMjUuMzE2NDA2IDE4LjU3ODEyNSAtMjQuNjA5Mzc1IEMgMTkuMzQ3NjU2IC0yMy4xNzk2ODggMTkuOTkyMTg4IC0yMS44MDA3ODEgMjAuNTE1NjI1IC0yMC40Njg3NSBDIDIxLjAzNTE1NiAtMTkuMTQ0NTMxIDIxLjI5Njg3NSAtMTcuODk4NDM4IDIxLjI5Njg3NSAtMTYuNzM0Mzc1IEMgMjEuMjk2ODc1IC0xNC40NjA5MzggMjAuOTcyNjU2IC0xMi41NzgxMjUgMjAuMzI4MTI1IC0xMS4wNzgxMjUgQyAxOS42Nzk2ODggLTkuNTg1OTM4IDE4LjU3ODEyNSAtOC44NDM3NSAxNy4wMTU2MjUgLTguODQzNzUgQyAxNS45MTAxNTYgLTguODQzNzUgMTUuMDM1MTU2IC05LjE5NTMxMiAxNC4zOTA2MjUgLTkuOTA2MjUgQyAxMy43NDIxODggLTEwLjYyNSAxMy4yNTc4MTIgLTExLjU2NjQwNiAxMi45Mzc1IC0xMi43MzQzNzUgQyAxMi41MzkwNjIgLTEzLjgzNTkzOCAxMi4yOTY4NzUgLTE1LjExNzE4OCAxMi4yMDMxMjUgLTE2LjU3ODEyNSBDIDEyLjEwOTM3NSAtMTguMDM1MTU2IDEyLjA2MjUgLTE5LjUwNzgxMiAxMi4wNjI1IC0yMSBMIDEuNzUgLTIwLjAzMTI1IEMgMS43NSAtMTcuMzc1IDEuOTI1NzgxIC0xNC43OTY4NzUgMi4yODEyNSAtMTIuMjk2ODc1IEMgMi42MzI4MTIgLTkuODA0Njg4IDMuMzMyMDMxIC03LjU4NTkzOCA0LjM3NSAtNS42NDA2MjUgQyA1LjQ3NjU2MiAtMy42OTE0MDYgNy4wMTk1MzEgLTIuMTMyODEyIDkgLTAuOTY4NzUgQyAxMC45NzY1NjIgMC4xOTUzMTIgMTMuNjQ4NDM4IDAuNzgxMjUgMTcuMDE1NjI1IDAuNzgxMjUgQyAxOS44NjcxODggMC43ODEyNSAyMi4yMzQzNzUgMC4yODEyNSAyNC4xMDkzNzUgLTAuNzE4NzUgQyAyNS45OTIxODggLTEuNzI2NTYyIDI3LjQ4ODI4MSAtMy4wNDY4NzUgMjguNTkzNzUgLTQuNjcxODc1IEMgMjkuNjk1MzEyIC02LjM1OTM3NSAzMC40NzI2NTYgLTguMjY5NTMxIDMwLjkyMTg3NSAtMTAuNDA2MjUgQyAzMS4zNzg5MDYgLTEyLjUzOTA2MiAzMS42MDkzNzUgLTE0LjgxMjUgMzEuNjA5Mzc1IC0xNy4yMTg3NSBDIDMxLjYwOTM3NSAtMTkuMTU2MjUgMzEuMzE2NDA2IC0yMS4wNDY4NzUgMzAuNzM0Mzc1IC0yMi44OTA2MjUgQyAzMC4xNDg0MzggLTI0Ljc0MjE4OCAyOS40MDYyNSAtMjYuNTc4MTI1IDI4LjUgLTI4LjM5MDYyNSBDIDI3LjU4MjAzMSAtMzAuMjEwOTM4IDI2LjUzOTA2MiAtMzIuMDMxMjUgMjUuMzc1IC0zMy44NDM3NSBDIDI0LjIwNzAzMSAtMzUuNjU2MjUgMjMuMDA3ODEyIC0zNy40Njg3NSAyMS43ODEyNSAtMzkuMjgxMjUgQyAyMC43NSAtNDAuNzgxMjUgMTkuNzQyMTg4IC00Mi4yNDIxODggMTguNzY1NjI1IC00My42NzE4NzUgQyAxNy43OTY4NzUgLTQ1LjA5NzY1NiAxNi45MjE4NzUgLTQ2LjQ4ODI4MSAxNi4xNDA2MjUgLTQ3Ljg0Mzc1IEMgMTUuMzU5Mzc1IC00OS4yMDcwMzEgMTQuNzIyNjU2IC01MC41MTk1MzEgMTQuMjM0Mzc1IC01MS43ODEyNSBDIDEzLjc1MzkwNiAtNTMuMDUwNzgxIDEzLjUxNTYyNSAtNTQuMzAwNzgxIDEzLjUxNTYyNSAtNTUuNTMxMjUgQyAxMy41MTU2MjUgLTU3LjYwMTU2MiAxMy43NzM0MzggLTU5LjI4NTE1NiAxNC4yOTY4NzUgLTYwLjU3ODEyNSBDIDE0LjgxNjQwNiAtNjEuODc4OTA2IDE1Ljc1MzkwNiAtNjIuNTYyNSAxNy4xMDkzNzUgLTYyLjYyNSBDIDE3Ljk1MzEyNSAtNjIuNjI1IDE4LjY0ODQzOCAtNjIuMzE2NDA2IDE5LjIwMzEyNSAtNjEuNzAzMTI1IEMgMTkuNzUzOTA2IC02MS4wODU5MzggMjAuMTkxNDA2IC02MC4yOTY4NzUgMjAuNTE1NjI1IC01OS4zMjgxMjUgQyAyMC44MzU5MzggLTU4LjI4NTE1NiAyMS4wNDY4NzUgLTU3LjE0ODQzOCAyMS4xNDA2MjUgLTU1LjkyMTg3NSBDIDIxLjI0MjE4OCAtNTQuNjkxNDA2IDIxLjI5Njg3NSAtNTMuNDkyMTg4IDIxLjI5Njg3NSAtNTIuMzI4MTI1IFogTSAyMS4yOTY4NzUgLTUyLjMyODEyNSAiLz48L2c+PC9nPjwvZz48ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjEiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2Ljg3MTU1OSwgOTEuNDgxMTcyKSI+PGc+PHBhdGggZD0iTSAzMS4yMTg3NSAtMTQuNjg3NSBMIDMxLjIxODc1IC01Ni43OTY4NzUgQyAzMS4wODIwMzEgLTU5LjcxMDkzOCAzMC41IC02Mi4yNzM0MzggMjkuNDY4NzUgLTY0LjQ4NDM3NSBDIDI5LjAwNzgxMiAtNjUuNDUzMTI1IDI4LjQ0MTQwNiAtNjYuNDA2MjUgMjcuNzY1NjI1IC02Ny4zNDM3NSBDIDI3LjA4NTkzOCAtNjguMjgxMjUgMjYuMjU3ODEyIC02OS4xMDkzNzUgMjUuMjgxMjUgLTY5LjgyODEyNSBDIDI0LjMxMjUgLTcwLjUzNTE1NiAyMy4xNjAxNTYgLTcxLjExMzI4MSAyMS44MjgxMjUgLTcxLjU2MjUgQyAyMC41MDM5MDYgLTcyLjAxOTUzMSAxOC45Njg3NSAtNzIuMjUgMTcuMjE4NzUgLTcyLjI1IEMgMTUuNDY4NzUgLTcyLjI1IDEzLjkxMDE1NiAtNzIuMDE5NTMxIDEyLjU0Njg3NSAtNzEuNTYyNSBDIDExLjE3OTY4OCAtNzEuMTEzMjgxIDEwLjAxNTYyNSAtNzAuNTM1MTU2IDkuMDQ2ODc1IC02OS44MjgxMjUgQyA4LjA2NjQwNiAtNjkuMTA5Mzc1IDcuMjUzOTA2IC02OC4yODEyNSA2LjYwOTM3NSAtNjcuMzQzNzUgQyA1Ljk2MDkzOCAtNjYuNDA2MjUgNS40MTAxNTYgLTY1LjQ1MzEyNSA0Ljk1MzEyNSAtNjQuNDg0Mzc1IEMgMy45MjE4NzUgLTYyLjI3MzQzOCAzLjMzNTkzOCAtNTkuNzEwOTM4IDMuMjAzMTI1IC01Ni43OTY4NzUgTCAzLjIwMzEyNSAtMTQuNjg3NSBDIDMuMzM1OTM4IC0xMS43MDcwMzEgMy45MjE4NzUgLTkuMTEzMjgxIDQuOTUzMTI1IC02LjkwNjI1IEMgNS40MTAxNTYgLTUuOTM3NSA1Ljk2MDkzOCAtNC45OTIxODggNi42MDkzNzUgLTQuMDc4MTI1IEMgNy4yNTM5MDYgLTMuMTcxODc1IDguMDY2NDA2IC0yLjM2MzI4MSA5LjA0Njg3NSAtMS42NTYyNSBDIDExLjA1NDY4OCAtMC4wMzEyNSAxMy43ODEyNSAwLjc4MTI1IDE3LjIxODc1IDAuNzgxMjUgQyAyMC41ODIwMzEgMC43ODEyNSAyMy4yNjk1MzEgLTAuMDMxMjUgMjUuMjgxMjUgLTEuNjU2MjUgQyAyNi4yNTc4MTIgLTIuMzYzMjgxIDI3LjA4NTkzOCAtMy4xNzE4NzUgMjcuNzY1NjI1IC00LjA3ODEyNSBDIDI4LjQ0MTQwNiAtNC45OTIxODggMjkuMDA3ODEyIC01LjkzNzUgMjkuNDY4NzUgLTYuOTA2MjUgQyAzMC41IC05LjExMzI4MSAzMS4wODIwMzEgLTExLjcwNzAzMSAzMS4yMTg3NSAtMTQuNjg3NSBaIE0gMjAuNzE4NzUgLTU2Ljc5Njg3NSBMIDIwLjcxODc1IC0xNC42ODc1IEMgMjAuNzE4NzUgLTEzLjUxOTUzMSAyMC41ODU5MzggLTEyLjY0NDUzMSAyMC4zMjgxMjUgLTEyLjA2MjUgQyAyMC4xMjg5MDYgLTExLjM0Mzc1IDE5Ljc4NTE1NiAtMTAuNzIyNjU2IDE5LjI5Njg3NSAtMTAuMjAzMTI1IEMgMTguODE2NDA2IC05LjY5MTQwNiAxOC4xMjUgLTkuNDM3NSAxNy4yMTg3NSAtOS40Mzc1IEMgMTYuMzc1IC05LjQzNzUgMTUuNjkxNDA2IC05LjY5NTMxMiAxNS4xNzE4NzUgLTEwLjIxODc1IEMgMTQuMjAzMTI1IC0xMS4zMTI1IDEzLjcxODc1IC0xMi44MDA3ODEgMTMuNzE4NzUgLTE0LjY4NzUgTCAxMy43MTg3NSAtNTYuNzk2ODc1IEMgMTMuNzE4NzUgLTU3LjgyODEyNSAxMy44NDM3NSAtNTguNzAzMTI1IDE0LjA5Mzc1IC01OS40MjE4NzUgQyAxNC4yODkwNjIgLTYwLjA2NjQwNiAxNC42MzI4MTIgLTYwLjY2NDA2MiAxNS4xMjUgLTYxLjIxODc1IEMgMTUuNjEzMjgxIC02MS43Njk1MzEgMTYuMzEyNSAtNjIuMDQ2ODc1IDE3LjIxODc1IC02Mi4wNDY4NzUgQyAxOC4xMjUgLTYyLjA0Njg3NSAxOC44MzU5MzggLTYxLjc4NTE1NiAxOS4zNTkzNzUgLTYxLjI2NTYyNSBDIDIwLjI2NTYyNSAtNjAuMTYwMTU2IDIwLjcxODc1IC01OC42NzE4NzUgMjAuNzE4NzUgLTU2Ljc5Njg3NSBaIE0gMjAuNzE4NzUgLTU2Ljc5Njg3NSAiLz48L2c+PC9nPjwvZz48ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjEiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDY1LjI2NTI1NywgOTEuNDgxMTcyKSI+PGc+PHBhdGggZD0iTSAxNC45Njg3NSAtMzcuMjUgTCAyNS4xODc1IDAgTCAzNC41MzEyNSAwIEwgMzQuNTMxMjUgLTcxLjQ4NDM3NSBMIDI0Ljg5MDYyNSAtNzEuNDg0Mzc1IEwgMjQuODkwNjI1IC0zMC45MjE4NzUgTCAyNC4zMTI1IC0zMC45MjE4NzUgTCAyMy40Mzc1IC0zNC4yMzQzNzUgTCAxMy4yMTg3NSAtNzEuNDg0Mzc1IEwgMy44OTA2MjUgLTcxLjQ4NDM3NSBMIDMuODkwNjI1IDAgTCAxMy41MTU2MjUgMCBMIDEzLjUxNTYyNSAtNDAuNTQ2ODc1IEwgMTQuMDkzNzUgLTQwLjU0Njg3NSBaIE0gMTQuOTY4NzUgLTM3LjI1ICIvPjwvZz48L2c+PC9nPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTcuNjUzNTQ0LCA5MS40ODExNzIpIj48Zy8+PC9nPjwvZz48ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjEiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwNi41OTkwMjEsIDkxLjQ4MTE3MikiPjxnLz48L2c+PC9nPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTE1LjU0NDQ5OSwgOTEuNDgxMTcyKSI+PGcvPjwvZz48L2c+PGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIxIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjQuNDg5OTc3LCA5MS40ODExNzIpIj48Zy8+PC9nPjwvZz48ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjEiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMy40MzU0NTQsIDkxLjQ4MTE3MikiPjxnLz48L2c+PC9nPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQyLjM4MDkzMiwgOTEuNDgxMTcyKSI+PGcvPjwvZz48L2c+PGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIxIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTEuMzI2NDEsIDkxLjQ4MTE3MikiPjxnLz48L2c+PC9nPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYwLjI3MTg4NywgOTEuNDgxMTcyKSI+PGcvPjwvZz48L2c+PGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIxIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjkuMjI1NDQ3LCA5MS40ODExNzIpIj48Zz48cGF0aCBkPSJNIDMuODkwNjI1IDAgTCAxMi4xNTYyNSAwIEMgMTcuMDE5NTMxIDAgMjAuODQzNzUgLTAuNTUwNzgxIDIzLjYyNSAtMS42NTYyNSBDIDI2LjQxNDA2MiAtMi43NTc4MTIgMjguNTIzNDM4IC00LjY3MTg3NSAyOS45NTMxMjUgLTcuMzkwNjI1IEMgMzEuMzE2NDA2IC0xMC4xMDkzNzUgMzIuMTc1NzgxIC0xMy43NTM5MDYgMzIuNTMxMjUgLTE4LjMyODEyNSBDIDMyLjg4MjgxMiAtMjIuODk4NDM4IDMzLjA2MjUgLTI4LjY4NzUgMzMuMDYyNSAtMzUuNjg3NSBDIDMzLjA2MjUgLTQyLjY4NzUgMzIuODgyODEyIC00OC40ODgyODEgMzIuNTMxMjUgLTUzLjA5Mzc1IEMgMzIuMTc1NzgxIC01Ny42OTUzMTIgMzEuMzE2NDA2IC02MS4zNjMyODEgMjkuOTUzMTI1IC02NC4wOTM3NSBDIDI4LjUyMzQzOCAtNjYuODEyNSAyNi40MTQwNjIgLTY4LjcyMjY1NiAyMy42MjUgLTY5LjgyODEyNSBDIDIwLjg0Mzc1IC03MC45Mjk2ODggMTcuMDE5NTMxIC03MS40ODQzNzUgMTIuMTU2MjUgLTcxLjQ4NDM3NSBMIDMuODkwNjI1IC03MS40ODQzNzUgWiBNIDE0LjM5MDYyNSAtMTAuNSBMIDE0LjM5MDYyNSAtNjAuOTY4NzUgQyAxNi4yMDMxMjUgLTYwLjk2ODc1IDE3LjY0NDUzMSAtNjAuNzU3ODEyIDE4LjcxODc1IC02MC4zNDM3NSBDIDE5Ljc4OTA2MiAtNTkuOTI1NzgxIDIwLjU4NTkzOCAtNTguODc1IDIxLjEwOTM3NSAtNTcuMTg3NSBDIDIxLjM2NzE4OCAtNTYuMzQzNzUgMjEuNTc4MTI1IC01NS4yODUxNTYgMjEuNzM0Mzc1IC01NC4wMTU2MjUgQyAyMS44OTg0MzggLTUyLjc1MzkwNiAyMi4wMTU2MjUgLTUxLjI4MTI1IDIyLjA3ODEyNSAtNDkuNTkzNzUgQyAyMi4xNDA2MjUgLTQ3LjkwNjI1IDIyLjE3MTg3NSAtNDUuOTEwMTU2IDIyLjE3MTg3NSAtNDMuNjA5Mzc1IEMgMjIuMTcxODc1IC00MS4zMTY0MDYgMjIuMTcxODc1IC0zOC43MDcwMzEgMjIuMTcxODc1IC0zNS43ODEyNSBDIDIyLjE3MTg3NSAtMzIuODYzMjgxIDIyLjE3MTg3NSAtMzAuMjUzOTA2IDIyLjE3MTg3NSAtMjcuOTUzMTI1IEMgMjIuMTcxODc1IC0yNS42NDg0MzggMjIuMTQwNjI1IC0yMy42NjAxNTYgMjIuMDc4MTI1IC0yMS45ODQzNzUgQyAyMi4wMTU2MjUgLTIwLjI5Njg3NSAyMS44OTg0MzggLTE4LjgxNjQwNiAyMS43MzQzNzUgLTE3LjU0Njg3NSBDIDIxLjU3ODEyNSAtMTYuMjg1MTU2IDIxLjM2NzE4OCAtMTUuMjM0Mzc1IDIxLjEwOTM3NSAtMTQuMzkwNjI1IEMgMjAuNTg1OTM4IC0xMi42NDA2MjUgMTkuNzg5MDYyIC0xMS41NTA3ODEgMTguNzE4NzUgLTExLjEyNSBDIDE3LjY0NDUzMSAtMTAuNzA3MDMxIDE2LjIwMzEyNSAtMTAuNSAxNC4zOTA2MjUgLTEwLjUgWiBNIDE0LjM5MDYyNSAtMTAuNSAiLz48L2c+PC9nPjwvZz48ZyBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjEiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE5OS4zNjk0ODYsIDkxLjQ4MTE3MikiPjxnPjxwYXRoIGQ9Ik0gMy44OTA2MjUgLTcxLjQ4NDM3NSBMIDMuODkwNjI1IDAgTCAxNC4zOTA2MjUgMCBMIDE0LjM5MDYyNSAtNzEuNDg0Mzc1IFogTSAzLjg5MDYyNSAtNzEuNDg0Mzc1ICIvPjwvZz48L2c+PC9nPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjExLjYyMTE2NiwgOTEuNDgxMTcyKSI+PGc+PHBhdGggZD0iTSAyMC43MTg3NSAtNDUuODEyNSBMIDMxLjIxODc1IC00NS44MTI1IEwgMzEuMjE4NzUgLTU2Ljc5Njg3NSBDIDMxLjA4MjAzMSAtNTkuNzEwOTM4IDMwLjUgLTYyLjI3MzQzOCAyOS40Njg3NSAtNjQuNDg0Mzc1IEMgMjkuMDA3ODEyIC02NS40NTMxMjUgMjguNDQxNDA2IC02Ni40MDYyNSAyNy43NjU2MjUgLTY3LjM0Mzc1IEMgMjcuMDg1OTM4IC02OC4yODEyNSAyNi4yNTc4MTIgLTY5LjEwOTM3NSAyNS4yODEyNSAtNjkuODI4MTI1IEMgMjQuMzEyNSAtNzAuNTM1MTU2IDIzLjE2MDE1NiAtNzEuMTEzMjgxIDIxLjgyODEyNSAtNzEuNTYyNSBDIDIwLjUwMzkwNiAtNzIuMDE5NTMxIDE4Ljk2ODc1IC03Mi4yNSAxNy4yMTg3NSAtNzIuMjUgQyAxNS40Njg3NSAtNzIuMjUgMTMuOTEwMTU2IC03Mi4wMTk1MzEgMTIuNTQ2ODc1IC03MS41NjI1IEMgMTEuMTc5Njg4IC03MS4xMTMyODEgMTAuMDE1NjI1IC03MC41MzUxNTYgOS4wNDY4NzUgLTY5LjgyODEyNSBDIDguMDY2NDA2IC02OS4xMDkzNzUgNy4yNTM5MDYgLTY4LjI4MTI1IDYuNjA5Mzc1IC02Ny4zNDM3NSBDIDUuOTYwOTM4IC02Ni40MDYyNSA1LjQxMDE1NiAtNjUuNDUzMTI1IDQuOTUzMTI1IC02NC40ODQzNzUgQyAzLjkyMTg3NSAtNjIuMjczNDM4IDMuMzM1OTM4IC01OS43MTA5MzggMy4yMDMxMjUgLTU2Ljc5Njg3NSBMIDMuMjAzMTI1IC0xNC42ODc1IEMgMy4wNzgxMjUgLTExLjc2OTUzMSAzLjQ2ODc1IC05LjE3NTc4MSA0LjM3NSAtNi45MDYyNSBDIDQuNzU3ODEyIC01LjkzNzUgNS4yNTc4MTIgLTQuOTkyMTg4IDUuODc1IC00LjA3ODEyNSBDIDYuNSAtMy4xNzE4NzUgNy4yMzQzNzUgLTIuMzYzMjgxIDguMDc4MTI1IC0xLjY1NjI1IEMgOC45ODQzNzUgLTAuODc1IDEwLjAzNTE1NiAtMC4yNzM0MzggMTEuMjM0Mzc1IDAuMTQwNjI1IEMgMTIuNDI5Njg4IDAuNTY2NDA2IDEzLjg3NSAwLjc4MTI1IDE1LjU2MjUgMC43ODEyNSBDIDE3LjI1IDAuNzgxMjUgMTguNzg1MTU2IDAuMzkwNjI1IDIwLjE3MTg3NSAtMC4zOTA2MjUgQyAyMS41NjY0MDYgLTEuMTcxODc1IDIyLjc1MzkwNiAtMi4xNzU3ODEgMjMuNzM0Mzc1IC0zLjQwNjI1IEwgMjUgMCBMIDMxLjIxODc1IDAgTCAzMS4yMTg3NSAtMzUuNTkzNzUgTCAxNi41MzEyNSAtMzUuNTkzNzUgTCAxNi41MzEyNSAtMjYuNzUgTCAyMC43MTg3NSAtMjYuNzUgTCAyMC43MTg3NSAtMTMuODEyNSBDIDIwLjcxODc1IC0xMi42NDQ1MzEgMjAuNTg1OTM4IC0xMS43Njk1MzEgMjAuMzI4MTI1IC0xMS4xODc1IEMgMjAuMTI4OTA2IC0xMC40Njg3NSAxOS43ODUxNTYgLTkuODQ3NjU2IDE5LjI5Njg3NSAtOS4zMjgxMjUgQyAxOC44MTY0MDYgLTguODE2NDA2IDE4LjEyNSAtOC41NjI1IDE3LjIxODc1IC04LjU2MjUgQyAxNi4zNzUgLTguNTYyNSAxNS42OTE0MDYgLTguODIwMzEyIDE1LjE3MTg3NSAtOS4zNDM3NSBDIDE0LjIwMzEyNSAtMTAuNDM3NSAxMy43MTg3NSAtMTEuOTI1NzgxIDEzLjcxODc1IC0xMy44MTI1IEwgMTMuNzE4NzUgLTU2Ljc5Njg3NSBDIDEzLjcxODc1IC01Ny44MjgxMjUgMTMuODQzNzUgLTU4LjcwMzEyNSAxNC4wOTM3NSAtNTkuNDIxODc1IEMgMTQuMjg5MDYyIC02MC4wNjY0MDYgMTQuNjMyODEyIC02MC42NjQwNjIgMTUuMTI1IC02MS4yMTg3NSBDIDE1LjYxMzI4MSAtNjEuNzY5NTMxIDE2LjMxMjUgLTYyLjA0Njg3NSAxNy4yMTg3NSAtNjIuMDQ2ODc1IEMgMTguMTI1IC02Mi4wNDY4NzUgMTguODM1OTM4IC02MS43ODUxNTYgMTkuMzU5Mzc1IC02MS4yNjU2MjUgQyAyMC4yNjU2MjUgLTYwLjE2MDE1NiAyMC43MTg3NSAtNTguNjcxODc1IDIwLjcxODc1IC01Ni43OTY4NzUgWiBNIDIwLjcxODc1IC00NS44MTI1ICIvPjwvZz48L2c+PC9nPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjQwLjU5ODI5OSwgOTEuNDgxMTcyKSI+PGc+PHBhdGggZD0iTSAzLjg5MDYyNSAtNzEuNDg0Mzc1IEwgMy44OTA2MjUgMCBMIDE0LjM5MDYyNSAwIEwgMTQuMzkwNjI1IC03MS40ODQzNzUgWiBNIDMuODkwNjI1IC03MS40ODQzNzUgIi8+PC9nPjwvZz48L2c+PGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIxIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTIuODQ5OTc5LCA5MS40ODExNzIpIj48Zz48cGF0aCBkPSJNIDAuMTg3NSAtNjAuNjg3NSBMIDEwLjEwOTM3NSAtNjAuNjg3NSBMIDEwLjEwOTM3NSAwIEwgMjAuNjA5Mzc1IDAgTCAyMC42MDkzNzUgLTYwLjY4NzUgTCAzMC41MzEyNSAtNjAuNjg3NSBMIDMwLjUzMTI1IC03MS40ODQzNzUgTCAwLjE4NzUgLTcxLjQ4NDM3NSBaIE0gMC4xODc1IC02MC42ODc1ICIvPjwvZz48L2c+PC9nPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjc3LjU0ODUxOSwgOTEuNDgxMTcyKSI+PGc+PHBhdGggZD0iTSAwLjk2ODc1IDAgTCAxMS4xODc1IDAgTCAxMy4xMjUgLTE0LjU5Mzc1IEwgMjMuMjUgLTE0LjU5Mzc1IEwgMjUuMTg3NSAwIEwgMzUuNDA2MjUgMCBMIDI0LjYwOTM3NSAtNzEuNDg0Mzc1IEwgMTEuNzY1NjI1IC03MS40ODQzNzUgWiBNIDE4Ljc2NTYyNSAtNDguMjM0Mzc1IEwgMjEuNzgxMjUgLTI1LjY3MTg3NSBMIDE0LjU5Mzc1IC0yNS42NzE4NzUgTCAxNy42MDkzNzUgLTQ4LjIzNDM3NSBMIDE3Ljg5MDYyNSAtNTAuMDc4MTI1IEwgMTguNDg0Mzc1IC01MC4wNzgxMjUgWiBNIDE4Ljc2NTYyNSAtNDguMjM0Mzc1ICIvPjwvZz48L2c+PC9nPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMSI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzA3Ljg4NzAzNiwgOTEuNDgxMTcyKSI+PGc+PHBhdGggZD0iTSAzLjg5MDYyNSAtNzEuNDg0Mzc1IEwgMy44OTA2MjUgMCBMIDI4LjI5Njg3NSAwIEwgMjguMjk2ODc1IC05LjcxODc1IEwgMTQuMzkwNjI1IC05LjcxODc1IEwgMTQuMzkwNjI1IC03MS40ODQzNzUgWiBNIDMuODkwNjI1IC03MS40ODQzNzUgIi8+PC9nPjwvZz48L2c+PGcgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIxIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMzAuNTQzNTAxLCA5MS40ODExNzIpIj48Zz48cGF0aCBkPSJNIDMuODkwNjI1IC03MS40ODQzNzUgTCAzLjg5MDYyNSAwIEwgMjcuOTA2MjUgMCBMIDI3LjkwNjI1IC0xMC43OTY4NzUgTCAxNC4zOTA2MjUgLTEwLjc5Njg3NSBMIDE0LjM5MDYyNSAtMzAuNDM3NSBMIDI0LjEyNSAtMzAuNDM3NSBMIDI0LjEyNSAtNDEuOTIxODc1IEwgMTQuMzkwNjI1IC00MS45MjE4NzUgTCAxNC4zOTA2MjUgLTYwLjY4NzUgTCAyNy45MDYyNSAtNjAuNjg3NSBMIDI3LjkwNjI1IC03MS40ODQzNzUgWiBNIDMuODkwNjI1IC03MS40ODQzNzUgIi8+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" alt="SONODIGITALE Logo" className="header-logo" />
                            </div>
                        </div>
                    </div>

                    <div className="container">
                        {/* Template */}
                        <div className="section">
                            <div className="section-title">
                                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                                1. Scegli Template Corso
                            </div>
                            <div className="grid grid-cols-3">
                                <button
                                    onClick={() => caricaTemplate('ai100')}
                                    className={`template-card ${templateSelezionato === 'ai100' ? 'active' : ''}`}
                                >
                                    <div className="title">AI Start - 100 ore</div>
                                    <div className="subtitle">4 settimane, 5h/giorno, 20 lezioni</div>
                                </button>
                                <button
                                    onClick={() => caricaTemplate('social50')}
                                    className={`template-card ${templateSelezionato === 'social50' ? 'active' : ''}`}
                                >
                                    <div className="title">Social Media Manager - 50 ore</div>
                                    <div className="subtitle">3 settimane, 4h/giorno, 13 lezioni</div>
                                </button>
                                <button
                                    onClick={() => {
                                        setTemplateSelezionato('custom');
                                        setProgramma([]); // üéØ NON creare lezioni subito
                                        setParametri({
                                            ...parametri,
                                            nomeCorso: '',
                                            oreTotali: 0,
                                            oreGiorno: 0
                                        });
                                        // Reset distribuzione
                                        setDistribuzioneOre({
                                            modalita: 'automatica',
                                            opzioneScelta: null,
                                            personalizzata: {
                                                ore7: 0,
                                                ore6: 0,
                                                ore5: 0,
                                                ore4: 0,
                                                ore3: 0
                                            }
                                        });
                                    }}
                                    className={`template-card ${templateSelezionato === 'custom' ? 'active' : ''}`}
                                >
                                    <div className="title">Corso Personalizzato</div>
                                    <div className="subtitle">Crea da zero</div>
                                </button>
                            </div>
                        </div>

                        {/* Parametri */}
                        <div className="section">
                            <div className="section-title">
                                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                2. Parametri Corso
                            </div>
                            <div className="grid grid-cols-4">
                                <div className="form-group">
                                    <label className="form-label">Nome Corso</label>
                                    <input
                                        type="text"
                                        value={parametri.nomeCorso}
                                        onChange={(e) => setParametri({ ...parametri, nomeCorso: e.target.value })}
                                        className="form-input"
                                        placeholder="Es: AI Start"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Ore Totali</label>
                                    <input
                                        type="number"
                                        value={parametri.oreTotali}
                                        onChange={(e) => setParametri({ ...parametri, oreTotali: parseInt(e.target.value) || 0 })}
                                        className="form-input"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Ore al Giorno</label>
                                    <input
                                        type="number"
                                        value={parametri.oreGiorno}
                                        onChange={(e) => setParametri({ ...parametri, oreGiorno: parseInt(e.target.value) || 0 })}
                                        className="form-input"
                                        min="3"
                                        max="7"
                                    />
                                    {(parametri.oreGiorno < 3 || parametri.oreGiorno > 7) && parametri.oreGiorno !== 0 && (
                                        <div style={{fontSize: '0.75rem', color: '#dc2626', marginTop: '0.25rem'}}>
                                            ‚ö†Ô∏è Le lezioni devono essere tra 3h e 7h
                                        </div>
                                    )}
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Numero Docenti</label>
                                    <input
                                        type="number"
                                        value={parametri.numeroDocenti}
                                        onChange={(e) => aggiornaNumeroDocenti(parseInt(e.target.value) || 1)}
                                        className="form-input"
                                        min="1"
                                        max="10"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Tipo Lezione Default</label>
                                    <select
                                        value={parametri.tipoDefault}
                                        onChange={(e) => setParametri({ ...parametri, tipoDefault: e.target.value })}
                                        className="form-select"
                                        style={{width: '100%', padding: '0.5rem', borderRadius: '0.375rem', border: '1px solid #d1d5db', fontSize: '0.875rem'}}
                                    >
                                        <option value="presenza">üè´ In Presenza</option>
                                        <option value="online">üåê Online</option>
                                    </select>
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Orario Inizio</label>
                                    <input
                                        type="time"
                                        value={parametri.orarioInizio}
                                        onChange={(e) => setParametri({ ...parametri, orarioInizio: e.target.value })}
                                        className="form-input"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Orario Fine</label>
                                    <input
                                        type="time"
                                        value={parametri.orarioFine}
                                        onChange={(e) => setParametri({ ...parametri, orarioFine: e.target.value })}
                                        className="form-input"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Data Inizio Periodo</label>
                                    <input
                                        type="date"
                                        value={parametri.dataInizio}
                                        onChange={(e) => setParametri({ ...parametri, dataInizio: e.target.value })}
                                        className="form-input"
                                        min="2026-01-01"
                                        max="2026-12-31"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Data Fine Periodo</label>
                                    <input
                                        type="date"
                                        value={parametri.dataFine}
                                        onChange={(e) => setParametri({ ...parametri, dataFine: e.target.value })}
                                        className="form-input"
                                        min="2026-01-01"
                                        max="2026-12-31"
                                    />
                                </div>
                            </div>

                            {/* Box Festivit√† nel Periodo */}
                            {parametri.dataInizio && parametri.dataFine && (() => {
                                const festivitaNelPeriodo = getFestivitaNelPeriodo();
                                if (festivitaNelPeriodo.length > 0) {
                                    return (
                                        <div style={{marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '1px solid #e5e7eb'}}>
                                            <div style={{
                                                backgroundColor: '#dbeafe',
                                                border: '2px solid #3b82f6',
                                                borderRadius: '0.5rem',
                                                padding: '1rem'
                                            }}>
                                                <div style={{
                                                    fontWeight: 'bold',
                                                    color: '#1e40af',
                                                    marginBottom: '0.5rem',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    gap: '0.5rem'
                                                }}>
                                                    üéâ Festivit√† nel periodo selezionato ({festivitaNelPeriodo.length}):
                                                </div>
                                                <div style={{
                                                    display: 'flex',
                                                    flexWrap: 'wrap',
                                                    gap: '0.5rem',
                                                    marginTop: '0.5rem'
                                                }}>
                                                    {festivitaNelPeriodo.map((festa, idx) => (
                                                        <div key={idx} style={{
                                                            backgroundColor: '#fef3c7',
                                                            color: '#92400e',
                                                            padding: '0.25rem 0.75rem',
                                                            borderRadius: '0.25rem',
                                                            fontSize: '0.875rem',
                                                            fontWeight: '500'
                                                        }}>
                                                            {new Date(festa.data).toLocaleDateString('it-IT')} - {festa.nome}
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    );
                                }
                                return null;
                            })()}

                            {/* Nomi Docenti */}
                            {parametri.numeroDocenti > 0 && (
                                <div style={{marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '1px solid #e5e7eb'}}>
                                    <label className="form-label" style={{marginBottom: '0.75rem', display: 'block', fontSize: '1rem', fontWeight: '600'}}>
                                        üìù Nomi Docenti (opzionale)
                                    </label>
                                    <div style={{fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.75rem'}}>
                                        Lascia vuoto per usare "Docente 1", "Docente 2", ecc. Puoi inserire solo alcuni nomi.
                                    </div>
                                    <div className="grid grid-cols-4">
                                        {Array.from({ length: parametri.numeroDocenti }, (_, i) => (
                                            <div key={i} className="form-group">
                                                <label className="form-label">Docente {i + 1}</label>
                                                <input
                                                    type="text"
                                                    value={nomiDocenti[i] || ''}
                                                    onChange={(e) => aggiornaNomeDocente(i, e.target.value)}
                                                    className="form-input"
                                                    placeholder={`Docente ${i + 1}`}
                                                />
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* Giorni della settimana */}
                            <div style={{marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '1px solid #e5e7eb'}}>
                                <label className="form-label" style={{marginBottom: '0.75rem', display: 'block', fontSize: '1rem', fontWeight: '600'}}>
                                    üìÖ Giorni Lavorativi
                                </label>
                                <div style={{display: 'flex', gap: '0.75rem', flexWrap: 'wrap'}}>
                                    {[
                                        { num: 1, nome: 'Luned√¨' },
                                        { num: 2, nome: 'Marted√¨' },
                                        { num: 3, nome: 'Mercoled√¨' },
                                        { num: 4, nome: 'Gioved√¨' },
                                        { num: 5, nome: 'Venerd√¨' },
                                        { num: 6, nome: 'Sabato' },
                                        { num: 7, nome: 'Domenica' },
                                    ].map(giorno => (
                                        <label key={giorno.num} className="radio-label" style={{
                                            padding: '0.5rem 1rem',
                                            borderRadius: '0.375rem',
                                            border: '2px solid',
                                            borderColor: parametri.giorni.includes(giorno.num) ? '#FC7E15' : '#e5e7eb',
                                            backgroundColor: parametri.giorni.includes(giorno.num) ? '#fff7ed' : 'white',
                                            cursor: 'pointer',
                                            transition: 'all 0.2s'
                                        }}>
                                            <input
                                                type="checkbox"
                                                checked={parametri.giorni.includes(giorno.num)}
                                                onChange={(e) => {
                                                    if (e.target.checked) {
                                                        setParametri({ ...parametri, giorni: [...parametri.giorni, giorno.num].sort() });
                                                    } else {
                                                        setParametri({ ...parametri, giorni: parametri.giorni.filter(d => d !== giorno.num) });
                                                    }
                                                }}
                                            />
                                            {giorno.nome}
                                        </label>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* Distribuzione Ore (solo se necessario) */}
                        {(() => {
                            const opzioni = calcolaOpzioniDistribuzione();
                            const totalePersonalizzato = getOrePersonalizzateTotali();
                            const isValido = totalePersonalizzato === parametri.oreTotali;
                            
                            if (opzioni.length > 0 && templateSelezionato === 'custom') {
                                return (
                                    <div className="section">
                                        <div className="section-title">
                                            <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                            3. Distribuzione Ore
                                        </div>

                                        <div className="alert alert-warning">
                                            <strong>‚ö†Ô∏è Attenzione:</strong> {parametri.oreTotali}h √∑ {parametri.oreGiorno}h al giorno = {Math.floor(parametri.oreTotali / parametri.oreGiorno)} giorni completi + {parametri.oreTotali % parametri.oreGiorno}h di resto.<br />
                                            <strong>Scegli come distribuire il resto:</strong><br />
                                            <small>‚ö†Ô∏è <strong>VINCOLI:</strong> Ogni lezione deve essere minimo 3h e massimo 7h. Lezioni da 7h = 9:00-13:00 / 14:00-17:00 (con pausa pranzo).</small>
                                        </div>

                                        <div className="distribuzione-section">
                                            <div className="distribuzione-title">üìä Opzioni Distribuzione</div>
                                            
                                            {/* Opzioni Automatiche */}
                                            {opzioni.map((opzione, idx) => (
                                                <div
                                                    key={idx}
                                                    className={`opzione-card ${distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta === idx ? 'selected' : ''}`}
                                                    onClick={() => setDistribuzioneOre({ modalita: 'automatica', opzioneScelta: idx, personalizzata: distribuzioneOre.personalizzata })}
                                                >
                                                    <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                        <input
                                                            type="radio"
                                                            checked={distribuzioneOre.modalita === 'automatica' && distribuzioneOre.opzioneScelta === idx}
                                                            onChange={() => {}}
                                                        />
                                                        <div style={{flex: 1}}>
                                                            <div className="opzione-descrizione">Opzione {String.fromCharCode(65 + idx)}: {opzione.descrizione}</div>
                                                            <div className="opzione-dettaglio">{opzione.dettaglio}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}

                                            {/* Opzione Personalizzata */}
                                            <div
                                                className={`opzione-card ${distribuzioneOre.modalita === 'personalizzata' ? 'selected' : ''}`}
                                                onClick={() => setDistribuzioneOre({ ...distribuzioneOre, modalita: 'personalizzata' })}
                                            >
                                                <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.5rem'}}>
                                                    <input
                                                        type="radio"
                                                        checked={distribuzioneOre.modalita === 'personalizzata'}
                                                        onChange={() => {}}
                                                    />
                                                    <div className="opzione-descrizione">Personalizzata (tu decidi)</div>
                                                </div>

                                                {distribuzioneOre.modalita === 'personalizzata' && (
                                                    <div style={{marginTop: '0.75rem', paddingLeft: '1.5rem'}}>
                                                        <div style={{fontSize: '0.875rem', color: '#6b7280', marginBottom: '0.5rem'}}>
                                                            ‚ÑπÔ∏è Inserisci il numero di giorni per ogni fascia oraria (solo 3h-7h permessi).
                                                        </div>
                                                        <div className="personalizzata-grid">
                                                            {[7, 6, 5, 4, 3].map(ore => (
                                                                <div key={ore} className="ore-input-group">
                                                                    <label className="ore-input-label">Giorni da {ore}h</label>
                                                                    <input
                                                                        type="number"
                                                                        min="0"
                                                                        value={distribuzioneOre.personalizzata[`ore${ore}`]}
                                                                        onChange={(e) => aggiornaDistribuzionePersonalizzata(`ore${ore}`, e.target.value)}
                                                                        className="form-input ore-input"
                                                                        onClick={(e) => e.stopPropagation()}
                                                                    />
                                                                    <div className="ore-calcolo">
                                                                        = {distribuzioneOre.personalizzata[`ore${ore}`] * ore}h
                                                                    </div>
                                                                </div>
                                                            ))}
                                                        </div>

                                                        <div className={`totale-ore ${isValido ? 'valido' : 'non-valido'}`}>
                                                            Totale: {totalePersonalizzato}h / {parametri.oreTotali}h {isValido ? '‚úÖ Perfetto!' : `‚ùå ${totalePersonalizzato > parametri.oreTotali ? 'Troppe' : 'Mancano'} ${Math.abs(totalePersonalizzato - parametri.oreTotali)} ore`}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                );
                            }
                            return null;
                        })()}

                        {/* Esclusioni Personalizzate */}
                        <div className="section">
                            <div className="section-title">
                                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                                </svg>
                                {calcolaOpzioniDistribuzione().length > 0 && templateSelezionato === 'custom' ? '4' : '3'}. Esclusioni Personalizzate (Chiusure Atoma)
                            </div>

                            <div className="alert alert-warning">
                                <strong>‚ÑπÔ∏è Le festivit√† nazionali italiane sono gi√† escluse automaticamente.</strong><br />
                                Usa questa sezione per aggiungere chiusure aziendali extra (es: settimana di Pasqua estesa, chiusura estiva, ecc.)
                            </div>

                            <div className="radio-group">
                                <label className="radio-label">
                                    <input
                                        type="radio"
                                        checked={tipoEsclusione === 'singola'}
                                        onChange={() => setTipoEsclusione('singola')}
                                    />
                                    Giorno Singolo
                                </label>
                                <label className="radio-label">
                                    <input
                                        type="radio"
                                        checked={tipoEsclusione === 'periodo'}
                                        onChange={() => setTipoEsclusione('periodo')}
                                    />
                                    Periodo (Range)
                                </label>
                            </div>

                            <div className="exclusion-form">
                                {tipoEsclusione === 'singola' ? (
                                    <div className="form-group">
                                        <label className="form-label">Data</label>
                                        <input
                                            type="date"
                                            value={dataEsclusione}
                                            onChange={(e) => setDataEsclusione(e.target.value)}
                                            className="form-input"
                                            min="2026-01-01"
                                            max="2026-12-31"
                                        />
                                    </div>
                                ) : (
                                    <>
                                        <div className="form-group">
                                            <label className="form-label">Da</label>
                                            <input
                                                type="date"
                                                value={dataInizioPeriodo}
                                                onChange={(e) => setDataInizioPeriodo(e.target.value)}
                                                className="form-input"
                                                min="2026-01-01"
                                                max="2026-12-31"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">A</label>
                                            <input
                                                type="date"
                                                value={dataFinePeriodo}
                                                onChange={(e) => setDataFinePeriodo(e.target.value)}
                                                className="form-input"
                                                min="2026-01-01"
                                                max="2026-12-31"
                                            />
                                        </div>
                                    </>
                                )}
                                
                                <div className="form-group">
                                    <label className="form-label">Motivo (opzionale)</label>
                                    <input
                                        type="text"
                                        value={motivoEsclusione}
                                        onChange={(e) => setMotivoEsclusione(e.target.value)}
                                        className="form-input"
                                        placeholder="Es: Chiusura Pasqua"
                                    />
                                </div>

                                <div className="form-group">
                                    <label className="form-label">&nbsp;</label>
                                    <button onClick={aggiungiEsclusione} className="btn btn-add">
                                        <svg style={{width: '16px', height: '16px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                                        </svg>
                                        Aggiungi
                                    </button>
                                </div>
                            </div>

                            {esclusioni.length > 0 && (
                                <div style={{marginTop: '1rem'}}>
                                    <strong>Esclusioni aggiunte ({esclusioni.length}):</strong>
                                    <div style={{marginTop: '0.5rem'}}>
                                        {esclusioni.map(escl => (
                                            <div key={escl.id} className="esclusione-item">
                                                <div>
                                                    {escl.tipo === 'singola' ? (
                                                        <div className="esclusione-text">
                                                            <span className="esclusione-date">{new Date(escl.data).toLocaleDateString('it-IT')}</span>
                                                            {escl.motivo && ` - ${escl.motivo}`}
                                                        </div>
                                                    ) : (
                                                        <div className="esclusione-text">
                                                            <span className="esclusione-date">
                                                                {new Date(escl.dataInizio).toLocaleDateString('it-IT')} ‚Üí {new Date(escl.dataFine).toLocaleDateString('it-IT')}
                                                            </span>
                                                            {escl.motivo && ` - ${escl.motivo}`}
                                                        </div>
                                                    )}
                                                </div>
                                                <button onClick={() => rimuoviEsclusione(escl.id)} className="btn btn-remove">
                                                    <svg style={{width: '16px', height: '16px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                                    </svg>
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Programma - üéØ MOSTRATO SOLO SE CI SONO LEZIONI */}
                        {programma.length > 0 && (
                            <div className="section">
                                <div className="section-header">
                                    <div className="section-title">
                                        <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                        </svg>
                                        {calcolaOpzioniDistribuzione().length > 0 && templateSelezionato === 'custom' ? '5' : '4'}. Programma Didattico ({programma.length} lezioni)
                                    </div>
                                    <button onClick={aggiungiLezione} className="btn btn-add">
                                        <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                                        </svg>
                                        Aggiungi Lezione
                                    </button>
                                </div>

                                {templateSelezionato === 'custom' && (
                                    <div className="alert alert-success" style={{marginBottom: '1rem'}}>
                                        <strong>‚úÖ Lezioni generate automaticamente!</strong><br />
                                        Il programma √® stato creato con {programma.length} lezioni in base alla distribuzione ore scelta. Compila i moduli e gli argomenti per ogni lezione.
                                    </div>
                                )}

                                <div className="programma-container">
                                    {programma.map((lezione, index) => (
                                        <div key={index} style={{marginBottom: '1.5rem', padding: '1rem', backgroundColor: '#f9fafb', borderRadius: '0.5rem', border: '2px solid #e5e7eb'}}>
                                            <div style={{display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '0.75rem'}}>
                                                <div style={{fontWeight: 'bold', fontSize: '1rem', minWidth: '80px', color: '#196C28'}}>Giorno {lezione.giorno}</div>
                                                <input
                                                    type="text"
                                                    value={lezione.modulo}
                                                    onChange={(e) => aggiornaLezione(index, 'modulo', e.target.value)}
                                                    className="form-input"
                                                    placeholder="Nome Modulo"
                                                    style={{flex: 1}}
                                                />
                                                <div style={{fontSize: '0.875rem', fontWeight: 'bold', color: lezione.oreGiornata ? '#196C28' : '#999', minWidth: '60px', textAlign: 'right'}}>
                                                    {lezione.oreGiornata ? `${lezione.oreGiornata}h` : '‚Äî'}
                                                </div>
                                                <button onClick={() => rimuoviLezione(index)} className="btn btn-remove">
                                                    <svg style={{width: '16px', height: '16px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                                    </svg>
                                                </button>
                                            </div>
                                            <input
                                                type="text"
                                                value={lezione.argomenti}
                                                onChange={(e) => aggiornaLezione(index, 'argomenti', e.target.value)}
                                                className="form-input"
                                                placeholder="Argomenti della lezione"
                                                style={{marginBottom: '0.75rem'}}
                                            />

                                            <div style={{marginBottom: '0.75rem'}}>
                                                <label style={{display: 'block', fontSize: '0.75rem', fontWeight: '600', color: '#666', marginBottom: '0.25rem'}}>Tipo Lezione</label>
                                                <select
                                                    value={lezione.tipoLezione || 'presenza'}
                                                    onChange={(e) => aggiornaLezione(index, 'tipoLezione', e.target.value)}
                                                    className="form-select"
                                                    style={{width: '100%', padding: '0.5rem', borderRadius: '0.375rem', border: '1px solid #d1d5db'}}
                                                >
                                                    <option value="presenza">üè´ In Presenza</option>
                                                    <option value="online">üåê Online</option>
                                                </select>
                                            </div>

                                            <div style={{backgroundColor: 'white', padding: '0.75rem', borderRadius: '0.375rem', marginBottom: '0.75rem'}}>
                                                <div style={{fontSize: '0.75rem', fontWeight: '600', color: '#666', marginBottom: '0.5rem'}}>‚è∞ ORARI</div>
                                                <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr 1fr 1fr', gap: '0.5rem'}}>
                                                    <div>
                                                        <label style={{display: 'block', fontSize: '0.75rem', color: '#666', marginBottom: '0.25rem'}}>Inizio</label>
                                                        <input
                                                            type="time"
                                                            value={lezione.orarioInizio || ''}
                                                            onChange={(e) => aggiornaLezione(index, 'orarioInizio', e.target.value)}
                                                            className="form-input"
                                                            style={{width: '100%', padding: '0.375rem', fontSize: '0.875rem'}}
                                                        />
                                                    </div>
                                                    <div>
                                                        <label style={{display: 'block', fontSize: '0.75rem', color: '#666', marginBottom: '0.25rem'}}>Fine</label>
                                                        <input
                                                            type="time"
                                                            value={lezione.orarioFine || ''}
                                                            onChange={(e) => aggiornaLezione(index, 'orarioFine', e.target.value)}
                                                            className="form-input"
                                                            style={{width: '100%', padding: '0.375rem', fontSize: '0.875rem'}}
                                                        />
                                                    </div>
                                                    <div>
                                                        <label style={{display: 'block', fontSize: '0.75rem', color: '#666', marginBottom: '0.25rem'}}>Pausa Da</label>
                                                        <input
                                                            type="time"
                                                            value={lezione.pausaInizio || ''}
                                                            onChange={(e) => aggiornaLezione(index, 'pausaInizio', e.target.value)}
                                                            className="form-input"
                                                            placeholder="Opzionale"
                                                            style={{width: '100%', padding: '0.375rem', fontSize: '0.875rem'}}
                                                        />
                                                    </div>
                                                    <div>
                                                        <label style={{display: 'block', fontSize: '0.75rem', color: '#666', marginBottom: '0.25rem'}}>Pausa A</label>
                                                        <input
                                                            type="time"
                                                            value={lezione.pausaFine || ''}
                                                            onChange={(e) => aggiornaLezione(index, 'pausaFine', e.target.value)}
                                                            className="form-input"
                                                            placeholder="Opzionale"
                                                            style={{width: '100%', padding: '0.375rem', fontSize: '0.875rem'}}
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>

                                {/* Totale Ore */}
                                <div style={{
                                    marginTop: '1.5rem',
                                    padding: '1rem',
                                    backgroundColor: calcolaTotaleOreProgramma() === parametri.oreTotali ? '#d1fae5' : '#fee2e2',
                                    borderRadius: '0.5rem',
                                    border: `2px solid ${calcolaTotaleOreProgramma() === parametri.oreTotali ? '#196C28' : '#dc2626'}`,
                                    textAlign: 'center',
                                    fontWeight: 'bold'
                                }}>
                                    {calcolaTotaleOreProgramma() === parametri.oreTotali ? '‚úÖ' : '‚ö†Ô∏è'} Totale Ore Programma: {calcolaTotaleOreProgramma()}h / {parametri.oreTotali}h
                                    {calcolaTotaleOreProgramma() !== parametri.oreTotali && (
                                        <div style={{fontSize: '0.875rem', marginTop: '0.5rem', color: '#dc2626'}}>
                                            Differenza: {(calcolaTotaleOreProgramma() - parametri.oreTotali).toFixed(1)}h
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}

                        {/* Calcola */}
                        <div className="section">
                            <button onClick={calcolaCorsi} className="btn btn-primary">
                                <svg style={{width: '24px', height: '24px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                                Calcola Corsi e Genera Calendari
                            </button>
                        </div>

                        {/* Risultati */}
                        {risultati && (
                            <div className="section">
                                <div className="result-title">üìä Risultati Calcolo</div>
                                
                                <div className="alert alert-info" style={{marginBottom: '1rem'}}>
                                    <strong>üìÖ Giorni esclusi dal calcolo:</strong><br />
                                    ‚Ä¢ Festivit√† nazionali: {risultati.festivita}<br />
                                    ‚Ä¢ Esclusioni personalizzate: {risultati.esclusioni}<br />
                                    ‚Ä¢ Weekend e giorni non lavorativi
                                </div>

                                <div className="stats-grid">
                                    <div className="stat-card gray">
                                        <div className="stat-label">Giorni Necessari</div>
                                        <div className="stat-value">{risultati.giorniNecessari}</div>
                                    </div>
                                    <div className="stat-card gray">
                                        <div className="stat-label">Giorni Disponibili</div>
                                        <div className="stat-value">{risultati.giorniDisponibili}</div>
                                    </div>
                                    <div className="stat-card gray">
                                        <div className="stat-label">Corsi per Docente</div>
                                        <div className="stat-value">{risultati.corsiPerDocente}</div>
                                    </div>
                                    <div className="stat-card orange">
                                        <div className="stat-label">Corsi Totali</div>
                                        <div className="stat-value">{risultati.corsiTotali}</div>
                                    </div>
                                </div>

                                {calendari.length > 0 && (
                                    <>
                                        <button onClick={esportaExcel} className="btn btn-success">
                                            <svg style={{width: '20px', height: '20px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                            </svg>
                                            Scarica Tutti i Calendari Excel
                                        </button>

                                        <div className="info-text">
                                            Generati {calendari.length} calendari completi
                                        </div>

                                        <div>
                                            {calendari.map((calendario, idx) => {
                                                const isEspanso = calendariEspansi.includes(idx);
                                                const lezioniDaMostrare = isEspanso ? calendario.lezioni : calendario.lezioni.slice(0, 5);
                                                
                                                return (
                                                    <div key={idx} className="calendario-card">
                                                        <div className="calendario-title">{calendario.nome}</div>
                                                        <div className="calendario-date">
                                                            üìÖ {calendario.dataInizio.toLocaleDateString('it-IT')} ‚Üí {calendario.dataFine.toLocaleDateString('it-IT')} ({calendario.lezioni.length} lezioni)
                                                        </div>
                                                        <div className="table-container">
                                                            <table>
                                                                <thead>
                                                                    <tr>
                                                                        <th>Data</th>
                                                                        <th>Giorno</th>
                                                                        <th>Orario</th>
                                                                        <th>Ore</th>
                                                                        <th>Tipo</th>
                                                                        <th>Modulo</th>
                                                                        <th>Argomenti</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    {lezioniDaMostrare.map((lezione, lidx) => (
                                                                        <tr key={lidx}>
                                                                            <td>{lezione.data.toLocaleDateString('it-IT')}</td>
                                                                            <td>{lezione.giorno}</td>
                                                                            <td>{lezione.orario}</td>
                                                                            <td style={{textAlign: 'center'}}>{lezione.ore}h</td>
                                                                            <td style={{textAlign: 'center'}}>
                                                                                {lezione.tipoLezione === 'online' ? 'üåê' : 'üè´'}
                                                                            </td>
                                                                            <td>{lezione.modulo}</td>
                                                                            <td style={{fontSize: '0.75rem'}}>
                                                                                {isEspanso ? lezione.argomenti : (
                                                                                    <>
                                                                                        {lezione.argomenti.substring(0, 80)}{lezione.argomenti.length > 80 ? '...' : ''}
                                                                                    </>
                                                                                )}
                                                                            </td>
                                                                        </tr>
                                                                    ))}
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        {calendario.lezioni.length > 5 && (
                                                            <button 
                                                                onClick={() => toggleEspansioneCalendario(idx)} 
                                                                className="btn btn-expand"
                                                            >
                                                                {isEspanso ? (
                                                                    <>
                                                                        <svg style={{width: '16px', height: '16px', display: 'inline-block', marginRight: '0.5rem'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 15l7-7 7 7" />
                                                                        </svg>
                                                                        Mostra meno
                                                                    </>
                                                                ) : (
                                                                    <>
                                                                        <svg style={{width: '16px', height: '16px', display: 'inline-block', marginRight: '0.5rem'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                                                                        </svg>
                                                                        Mostra tutte le {calendario.lezioni.length} lezioni
                                                                    </>
                                                                )}
                                                            </button>
                                                        )}
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </>
                                )}
                            </div>
                        )}
                    </div>

                    {/* Modale Guida */}
                    {mostraGuida && (
                        <div className="modal-overlay" onClick={() => setMostraGuida(false)}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h2>üìñ Guida Utente - Generatore Calendari Corsi</h2>
                                    <button className="modal-close" onClick={() => setMostraGuida(false)}>
                                        <svg style={{width: '24px', height: '24px'}} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                </div>
                                <div className="modal-body">
                                    <section className="guida-section">
                                        <h3>üéØ Introduzione</h3>
                                        <p>Benvenuta! Questo strumento ti permette di generare automaticamente i calendari dei corsi per l'anno 2026.</p>
                                    </section>

                                    <section className="guida-section">
                                        <h3>üìã 1. Scegli Template o Corso Personalizzato</h3>
                                        <ul>
                                            <li><strong>Template preconfigurati:</strong> Clicca su "AI Start" o "Social Media Manager" per caricare corsi gi√† impostati</li>
                                            <li><strong>Corso personalizzato:</strong> Clicca su "Personalizzato" per creare un corso da zero</li>
                                        </ul>
                                    </section>

                                    <section className="guida-section">
                                        <h3>‚öôÔ∏è 2. Configura i Parametri Corso</h3>
                                        <ul>
                                            <li><strong>Nome Corso:</strong> Inserisci il nome del corso</li>
                                            <li><strong>Ore Totali:</strong> Durata totale del corso in ore</li>
                                            <li><strong>Ore al Giorno:</strong> Ore di lezione per ogni giorno (da 3 a 7 ore)</li>
                                            <li><strong>Tipo Lezione Default:</strong> Scegli se le lezioni sono "In Presenza" o "Online" (puoi modificare singolarmente dopo)</li>
                                            <li><strong>Numero Docenti:</strong> Quanti docenti terranno il corso</li>
                                            <li><strong>Orari:</strong> Orario di inizio e fine predefiniti</li>
                                            <li><strong>Date Periodo:</strong> Seleziona il periodo in cui pu√≤ svolgersi il corso</li>
                                        </ul>
                                    </section>

                                    <section className="guida-section">
                                        <h3>üìä 3. Distribuzione Ore</h3>
                                        <p>Se le ore totali non sono divisibili perfettamente per le ore giornaliere, vedrai diverse opzioni di distribuzione. Scegli quella che preferisci.</p>
                                    </section>

                                    <section className="guida-section">
                                        <h3>üìù 4. Programma Didattico</h3>
                                        <p>Qui puoi personalizzare ogni singola lezione:</p>
                                        <ul>
                                            <li><strong>Modulo e Argomenti:</strong> Descrivi il contenuto di ogni lezione</li>
                                            <li><strong>Tipo Lezione:</strong> Cambia da Presenza a Online se necessario per lezioni specifiche</li>
                                            <li><strong>Orari:</strong> Personalizza gli orari per ogni lezione</li>
                                            <li><strong>Pause:</strong> Aggiungi le pause pranzo o altre interruzioni</li>
                                            <li><strong>Controllo Totale:</strong> Verifica che il totale ore corrisponda (indicatore verde ‚úÖ = corretto)</li>
                                        </ul>
                                        <p><em>üí° Suggerimento: Le lezioni da 7 ore vengono pre-impostate automaticamente con orario 09:00-17:00 e pausa 13:00-14:00</em></p>
                                    </section>

                                    <section className="guida-section">
                                        <h3>üö´ 5. Date da Escludere</h3>
                                        <ul>
                                            <li>Le festivit√† italiane 2026 sono gi√† precaricate</li>
                                            <li>Puoi aggiungere altre date da escludere (singole o periodi)</li>
                                            <li>Utile per ferie, chiusure aziendali, ecc.</li>
                                        </ul>
                                    </section>

                                    <section className="guida-section">
                                        <h3>üé® 6. Genera Calendari</h3>
                                        <p>Clicca su "Calcola Corsi e Genera Calendari" per vedere l'anteprima dei calendari per ogni docente.</p>
                                        <p>Nelle anteprime vedrai:</p>
                                        <ul>
                                            <li>Data e giorno della settimana</li>
                                            <li>Orari di ogni lezione</li>
                                            <li>Ore totali</li>
                                            <li>Tipo (üè´ Presenza / üåê Online)</li>
                                            <li>Modulo e argomenti</li>
                                        </ul>
                                    </section>

                                    <section className="guida-section">
                                        <h3>üì• 7. Scarica Excel</h3>
                                        <p>Clicca su "Scarica Tutti i Calendari (Excel)" per scaricare un file Excel con un foglio per ogni calendario generato.</p>
                                        <p>Il file Excel contiene tutte le informazioni in formato professionale, pronto per essere condiviso.</p>
                                    </section>

                                    <section className="guida-section">
                                        <h3>üí° Suggerimenti</h3>
                                        <ul>
                                            <li>Inizia sempre da un template se disponibile - risparmia tempo!</li>
                                            <li>Controlla sempre il totale ore nel Programma Didattico prima di generare</li>
                                            <li>Usa le pause per lezioni lunghe (7 ore) per rispettare le normative</li>
                                            <li>Verifica le anteprime prima di scaricare l'Excel</li>
                                        </ul>
                                    </section>

                                    <div style={{textAlign: 'center', marginTop: '2rem', padding: '1rem', backgroundColor: '#f0fdf4', borderRadius: '0.5rem'}}>
                                        <p style={{margin: 0, color: '#196C28', fontWeight: 'bold'}}>
                                            Per qualsiasi dubbio o problema, contatta il supporto tecnico! üöÄ
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<CalendarioCorsiApp />, document.getElementById('root'));
    </script>
</body>
</html>
